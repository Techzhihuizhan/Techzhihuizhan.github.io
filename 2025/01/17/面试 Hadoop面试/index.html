<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>面试 Hadoop面试 | Tech智汇站</title><meta name="keywords" content="面试"><meta name="author" content="智汇君"><meta name="copyright" content="智汇君"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="面试 Hadoop面试"><meta name="application-name" content="面试 Hadoop面试"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="面试 Hadoop面试"><meta property="og:url" content="http://example.com/2025/01/17/面试 Hadoop面试/index.html"><meta property="og:site_name" content="Tech智汇站"><meta property="og:description" content="Hadoop面试Hadoop HDFS机架感知与副本冗余存储策略  MAPREDUCE 1MapReduce 要求&amp;lt;key,value&amp;gt;的 key 和 value 都要实现 Writable接口,从而支持 Hadoop 的序列化和反序列化。上面的Hadoop的内置类型都实现了Writab"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta property="article:author" content="智汇君"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta name="description" content="Hadoop面试Hadoop HDFS机架感知与副本冗余存储策略  MAPREDUCE 1MapReduce 要求&amp;lt;key,value&amp;gt;的 key 和 value 都要实现 Writable接口,从而支持 Hadoop 的序列化和反序列化。上面的Hadoop的内置类型都实现了Writab"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20Hadoop%E9%9D%A2%E8%AF%95/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css#fontawesome_animation 如果有就会加载，示例值：https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":270},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 智汇君","link":"链接: ","source":"来源: Tech智汇站","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Tech智汇站',
  title: '面试 Hadoop面试',
  postAI: '',
  pageFillDescription: 'Hadoop面试, Hadoop, HDFS, 机架感知与副本冗余存储策略, MAPREDUCE, 案例一 WordCount 程序, 案例二 统计各个部门员工薪水总和, 案例三 序列化, 案例四 分区, 案例, 案例五 合并 预聚合, 简述MapTask并行度决定机制?, 简述FileInputFormat(默认应该是其子类textinputformat)切片机制?, MapReduce程序如何大量小文件?, combinetextinputformat, ReduceTask并行度与分区的关系?, MapReduce排序?, 自定义排序WritableComparable, MapReduce的Combiner组件(预聚合)?, 自定义Combiner, MapReduce分组求TopN? GroupingComparator, student, map, groupingcomparator, 分组第一名, 分组topn, 组装job, MapReduce Join?, reduce join, reducejoin缺点, mapjoin, 使用场景, MultipleInputs, mapreduce压缩, 案例六 去重, 案例七 多表查询, map, reduce, job, 案例八 求出各年销售笔数、各年销售总额, YARN, 概述, yarn基本架构, yarn常用命令操作, 查看任务, 常看日志 查看容器, 查看节点状态, 查看队列, 更新配置, yarn工作原理, 数仓建设保姆级教程, 数仓基本概念, 数据仓库架构, 数据仓库概念, 基本特征, 面向主题, 集成的, 非易失性, 时变性, 为什么要有数据仓库, 数据仓库与数据库的区别, 数据仓库分层架构, 主要数据仓库架构, 数据集市架构, Inmon 企业工厂架构, Kimball 数据仓库架构, 混合型数据仓库架构, 数据仓库元数据的管理, 数仓常见术语解析, 数据集市, 数仓名词之间关系, 离线数仓建设核心, 数仓分层, 数据源层： ODS（ Operational Data Store）, 数据仓库层： DW（ Data Warehouse）, 数据明细层： DWD（ Data Warehouse Detail）, 数据中间层： DWM（ Data WareHouse Middle）, 数据服务层： DWS（ Data WareHouse Servce）, 数据应用层： APP（Application）, 维表层： DIM（Dimension）, 数仓建模方法, 范式建模法（Third Normal Form 3NF）, 第一范式, 第二范式, 第三范式, BC范式、第四范式第五范式, 维度建模法（Dimensional Modeling）, 实体建模法（Entity Modeling）, 维度建模详解, 维度建模中表的类型, 维度建模三种模式, 维度建模过程, 离线数仓建设实战, 业务介绍, 早期规划, 数据中台, 数仓建设, 模型, 模型分层, 数据流向, 规范, 表命名规范, 字段命名规范, 脚本命名规范, 脚本内容规范, 数据层具体实现, 数据源层 ODS, 数据明细层 DW, 数据轻度汇总层 DM, 数据应用层 APP, 总结, 实际生产中注意事项, 实时计算, 实时计算应用场景, 实时智能推荐, 实时欺诈检测, 舆情分析, 复杂事件处理, 实时机器学习, 实时计算总览, 数据同步, 数据存储, 数据计算, 实时应用, 实时架构, Lambda 架构, Kappa 架构, 实时数仓建设核心面试机架感知与副本冗余存储策略要求的和都要实现接口从而支持的序列化和反序列化上面的的内置类型都实现了接口用户也必须对自定义的类实现接口案例一程序案例二统计各个部门员工薪水总和案例三序列化案例四分区案例解里面编写判断低薪中薪高薪作为里面编写判断分为三个区案例五合并预聚合简述并行度决定机制源码分析简述默认应该是其子类切片机制源码分析程序如何大量小文件并行度与分区的关系排序过程一次快排两次归并排序自定义排序的组件预聚合自定义默认直接用编写的就可以了没必要重新编写分组求分组第一名分组组装缺点使用场景题目描述在程序中同时处理两个不同输入目录中的数据文件最终统计所有文件中单词出现的次数简称多路输入第一个输入目录为此目录下有多个文件文件内容如下文件中的单词之间分隔符是逗号第二个输入目录为此目录下有多个文件文件内容如下文件中的单词之间分隔符是空格效果最终想要获取类似这样的结果任务要求针对每一个输入目录设置使用不同的自定义里面写不同的处理逻辑因为两份数据中的数据格式是不一样的任务提示思路分析使用实现加载不同路径中的文件查阅的相关使用资料针对不同的输入目录设置不同的自定义最终需要定义两个自定义压缩题目描述在程序中使用数据压缩方式对程序计算性能进行优化效果提高程序计算效率任务要求对阶段输出数据进行压缩指定压缩方式对阶段输出数据进行压缩指定压缩方式任务提示思路分析在执行任务的时候通过命令行动态指定端输出数据的压缩格式和端输出数据的压缩格式具体如何指定数据压缩格式需要大家自行查阅资料案例六去重获取员工表所有的信息要求仅列出不同的值类似下面语句的功能如果是那么的输人就是去掉重复后的而的类型用即可直接输出即可案例七多表查询采用实现类似下面语句的功能端读取所有的文件并为输出的内容加上标识代表文件数据来源于员工表或部门表在端按照标识对数据进行处理案例八求出各年销售笔数各年销售总额解提取的年份作为可以用类来包装销售额和数量或者用字符串拼接概述是一个资源调度平台负责为计算程序提供服务器运行资源相当于一个分布式的操作系统平台而等运算程序则相当于运行于操作系统之上的应用程序基本架构主要由和等组件构成是整个集群的老大启动在某台机器上处理客户端请求启动监控监控资源分配与调度是某台机器的老大单个节点上的资源管理处理来自的命令处理来自的命令是某个任务的老大数据切分为应用程序申请资源并分配给内部任务任务监控与容错对任务运行环境的抽象用于运行任务封装了内存等多维资源以及环境变量启动命令等任务运行相关的信息常用命令操作状态的查询除了可以在页面查看外还可以通过命令操作常用的命令有查看任务列表查看运行日志查看尝试运行的任务查看运行容器查看节点状态查看队列更新队列配置等查看任务常看日志查看容器查看节点状态查看队列更新配置工作原理数仓建设保姆级教程数仓基本概念数据仓库架构这里参考此定义把数据仓库架构理解成构成数据仓库的组件及其之间的关系画出下面的数仓架构图在数据仓库技术演化过程中产生了几种主要的架构方法包括数据集市架构企业信息工厂架构数据仓库架构混合型数据仓库架构这几种架构我们后面再讲接下来看下数仓的基本概念数据仓库概念基本特征数据仓库是面向主题的集成的非易失的和时变的数据集合用以支持管理决策面向主题传统数据库中最大的特点是面向应用进行数据的组织各个业务系统可能是相互分离的而数据仓库则是面向主题的主题是一个抽象的概念是较高层次上企业信息系统中的数据综合归类并进行分析利用的抽象在逻辑意义上它是对应企业中某一宏观分析领域所涉及的分析对象集成的通过对分散独立异构的数据库数据进行抽取清理转换和汇总便得到了数据仓库的数据这样保证了数据仓库内的数据关于整个企业的一致性数据仓库中的综合数据不能从原有的数据库系统直接得到因此在数据进入数据仓库之前必然要经过统一与综合这一步是数据仓库建设中最关键最复杂的一步所要完成的工作有要统一源数据中所有矛盾之处如字段的同名异义异名同义单位不统一字长不一致等等进行数据综合和计算数据仓库中的数据综合工作可以在从原有数据库抽取数据时生成但许多是在数据仓库内部生成的即进入数据仓库以后进行综合生成的非易失性数据非易失性主要是针对应用而言数据仓库的用户对数据的操作大多是数据查询或比较复杂的挖掘一旦数据进入数据仓库以后一般情况下被较长时间保留数据仓库中一般有大量的查询操作但修改和删除操作很少因此数据经加工和集成进入数据仓库后是极少更新的通常只需要定期的加载和更新时变性数据仓库包含各种粒度的历史数据数据仓库中的数据可能与某个特定日期星期月份季度或者年份有关数据仓库的目的是通过分析企业过去一段时间业务的经营状况挖掘其中隐藏的模式虽然数据仓库的用户不能修改数据但并不是说数据仓库的数据是永远不变的分析的结果只能反映过去的情况当业务变化后挖掘出的模式会失去时效性因此数据仓库的数据需要更新以适应决策的需要从这个角度讲数据仓库建设是一个项目更是一个过程数据仓库的数据随时间的变化表现在以下几个方面数据仓库的数据时限一般要远远长于操作型数据的数据时限操作型系统存储的是当前数据而数据仓库中的数据是历史数据数据仓库中的数据是按照时间顺序追加的它们都带有时间属性为什么要有数据仓库先来看下数据仓库的数据从哪里来最终要到哪里去通常数据仓库的数据来自各个业务应用系统业务系统中的数据形式多种多样可能是等关系数据库里的结构化数据可能是文本等平面文件或文档中的数据还可能是等自描述的半结构化数据这些业务数据经过一系列的数据抽取转换清洗最终以一种统一的格式装载进数据仓库这时我们就想了为什么不能把业务系统的数据直接拿来供即席查询分析系统报表系统等使用呢为什么要经过数据仓库这一步实际上在数仓出现之前确实是这么做的但是有很多数据分析的先驱者当时已经发现简单的直接访问方式很难良好工作这样做的失败案例数不胜数下面列举一些直接访问业务系统无法工作的原因某些业务数据由于安全或其他因素不能直接访问业务系统的版本变更很频繁每次变更都需要重写分析系统并重新测试很难建立和维护汇总数据来源于多个业务系统版本的报表业务系统的列名通常是硬编码有时仅仅是无意义的字符串这让编写分析系统更加困难业务系统的数据格式如日期数字的格式不统一业务系统的表结构为事务处理性能而优化有时并不适合查询与分析没有适当的方式将有价值的数据合并进特定应用的数据库没有适当的位置存储元数据用户需要看到的显示数据字段有时在数据库中并不存在通常事务处理的优先级比分析系统高所以如果分析系统和事务处理运行在同一硬件之上分析系统往往性能很差有误用业务数据的风险极有可能影响业务系统的性能尽管需要增加软硬件的投入但建立独立数据仓库与直接访问业务数据相比无论是成本还是带来的好处这样做都是值得的随着处理器和存储成本的逐年降低数据仓库方案的优势更加明显在经济上也更具可行性数据仓库与数据库的区别数据库与数据仓库的区别实际讲的是与的区别操作型处理联机事务处理也可以称面向交易的处理系统它是针对具体业务在数据库联机的日常操作通常对少数记录进行查询修改用户较为关心操作的响应时间数据的安全性完整性和并发支持的用户数等问题传统的数据库系统作为数据管理的主要手段主要用于操作型处理像等关系型数据库一般属于分析型处理叫联机分析处理一般针对某些主题的历史数据进行分析支持管理决策首先要明白数据仓库的出现并不是要取代数据库数据库是面向事务的设计数据仓库是面向主题设计的数据库一般存储业务数据数据仓库存储的一般是历史数据数据库设计是尽量避免冗余一般针对某一业务应用进行设计比如一张简单的表记录用户名密码等简单数据即可符合业务应用但是不符合分析数据仓库在设计是有意引入冗余依照分析需求分析维度分析指标进行设计数据库是为捕获数据而设计数据仓库是为分析数据而设计以银行业务为例数据库是事务系统的数据平台客户在银行做的每笔交易都会写入数据库被记录下来这里可以简单地理解为用数据库记账数据仓库是分析系统的数据平台它从事务系统获取数据并做汇总加工为决策者提供决策的依据比如某银行某分行一个月发生多少交易该分行当前存款余额是多少如果存款又多消费交易又多那么该地区就有必要设立了显然银行的交易量是巨大的通常以百万甚至千万次来计算事务系统是实时的这就要求时效性客户存一笔钱需要几十秒是无法忍受的这就要求数据库只能存储很短一段时间的数据而分析系统是事后的它要提供关注时间段内所有的有效数据这些数据是海量的汇总计算起来也要慢一些但是只要能够提供有效的分析数据就达到目的了数据仓库是在数据库已经大量存在的情况下为了进一步挖掘数据资源为了决策需要而产生的它决不是所谓的大型数据库数据仓库分层架构按照数据流入流出的过程数据仓库架构可分为源数据数据仓库数据应用数据仓库的数据来源于不同的源数据并提供多样的数据应用数据自下而上流入数据仓库后向上层开放应用而数据仓库只是中间集成化数据管理的一个平台源数据此层数据无任何更改直接沿用外围系统数据结构和数据不对外开放为临时存储层是接口数据的临时存储区域为后一步的数据处理做准备数据仓库也称为细节层层的数据应该是一致的准确的干净的数据即对源系统数据进行了清洗去除了杂质后的数据数据应用前端应用直接读取的数据源根据报表专题分析需求而计算生成的数据数据仓库从各数据源获取数据及在数据仓库内的数据转换和流动都可以认为是抽取转化装载的过程是数据仓库的流水线也可以认为是数据仓库的血液它维系着数据仓库中数据的新陈代谢而数据仓库日常的管理和维护工作的大部分精力就是保持的正常和稳定那么为什么要数据仓库进行分层呢用空间换时间通过大量的预处理来提升应用系统的用户体验效率因此数据仓库会存在大量冗余的数据不分层的话如果源业务系统的业务规则发生变化将会影响整个数据清洗过程工作量巨大通过数据分层管理可以简化数据清洗的过程因为把原来一步的工作分到了多个步骤去完成相当于把一个复杂的工作拆成了多个简单的工作把一个大的黑盒变成了一个白盒每一层的处理逻辑都相对简单和容易理解这样我们比较容易保证每一个步骤的正确性当数据发生错误的时候往往我们只需要局部调整某个步骤即可主要数据仓库架构通过上面的内容我们大概了解数仓的概念接下来就看下数仓的几种演进架构数据集市架构数据集市是按主题域组织的数据集合用于支持部门级的决策有两种类型的数据集市独立数据集市和从属数据集市独立数据集市独立数据集市集中于部门所关心的单一主题域数据以部门为基础部署无须考虑企业级别的信息共享与集成例如制造部门人力资源部门和其他部门都各自有他们自己的数据集市优点因为一个部门的业务相对于整个企业要简单数据量也小得多所以部门的独立数据集市具有周期短见效快的特点缺点从业务角度看当部门的分析需求扩展或者需要分析跨部门或跨主题域的数据时独立数据市场会显得力不从心当数据存在歧义比如同一个产品在部门和部门的定义不同时将无法在部门间进行信息比较每个部门使用不同的技术建立不同的的过程处理不同的事务系统而在多个独立的数据集市之间还会存在数据的交叉与重叠甚至会有数据不一致的情况从属数据集市从属数据集市的数据来源于数据仓库数据仓库里的数据经过整合重构汇总后传递给从属数据集市建立从属数据集市的好处主要有性能当数据仓库的查询性能出现问题可以考虑建立几个从属数据集市将查询从数据仓库移出到数据集市安全每个部门可以完全控制他们自己的数据数据一致因为每个数据集市的数据来源都是同一个数据仓库有效消除了数据不一致的情况企业工厂架构上图的前两步不过多介绍直接从第三步开始企业级数据仓库是该架构中的核心组件正如数据仓库所定义的企业级数据仓库是一个细节数据的集成资源库其中的数据以最低粒度级别被捕获存储在满足三范式设计的关系数据库中部门级数据集市是面向主题数据的部门级视图数据从企业级数据仓库获取数据在进入部门数据集市时可能进行聚合数据集市使用多维模型设计用于数据分析重要的一点是所有的报表工具工具或其他数据分析应用都从数据集市查询数据而不是直接查询企业级数据仓库数据仓库架构对比上一张图可以看到与两种架构的主要区别在于核心数据仓库的设计和建立的数据仓库包含高粒度的企业数据使用多维模型设计这也意味着数据仓库由星型模式的维度表和事实表构成分析系统或报表工具可以直接访问多维数据仓库里的数据在此架构中的数据集市也与中的不同这里的数据集市是一个逻辑概念只是多维数据仓库中的主题域划分并没有自己的物理存储也可以说是虚拟的数据集市混合型数据仓库架构所谓的混合型结构指的是在一个数据仓库环境中联合使用和两种架构从架构图可以看到这种架构将方法中的数据集市部分替换成了一个多维数据仓库而数据集市则是多维数据仓库上的逻辑视图使用这种架构的好处是既可以利用规范化设计消除数据冗余保证数据的粒度足够细又可以利用多维结构更灵活地在企业级实现报表和分析数据仓库元数据的管理元数据主要记录数据仓库中模型的定义各层级间的映射关系监控数据仓库的数据状态及的任务运行状态一般会通过元数据资料库来统一地存储和管理元数据其主要目的是使数据仓库的设计部署操作和管理能达成协同和一致元数据是数据仓库管理系统的重要组成部分元数据管理贯穿数据仓库构建的整个过程直接影响着数据仓库的构建使用和维护构建数据仓库的主要步骤之一是这时元数据将发挥重要的作用它定义了源数据系统到数据仓库的映射数据转换的规则数据仓库的逻辑结构数据更新的规则数据导入历史记录以及装载周期等相关内容数据抽取和转换的专家以及数据仓库管理员正是通过元数据高效地构建数据仓库用户在使用数据仓库时通过元数据访问数据明确数据项的含义以及定制报表数据仓库的规模及其复杂性离不开正确的元数据管理包括增加或移除外部数据源改变数据清洗方法控制出错的查询以及安排备份等元数据可分为技术元数据和业务元数据技术元数据为开发和管理数据仓库的人员使用它描述了与数据仓库开发管理和维护相关的数据包括数据源信息数据转换描述数据仓库模型数据清洗与更新规则数据映射和访问权限等而业务元数据为管理层和业务分析人员服务从业务角度描述数据包括商务术语数据仓库中有什么数据数据的位置和数据的可用性等帮助业务人员更好地理解数据仓库中哪些数据是可用的以及如何使用由上可见元数据不仅定义了数据仓库中数据的模式来源抽取和转换规则等而且是整个数据仓库系统运行的基础元数据把数据仓库系统中各个松散的组件联系起来组成了一个有机的整体数仓常见术语解析数仓名词解释实体实体是指依附的主体就是我们分析的一个对象比如我们分析商品的销售情况如华为手机近半年的销售量是多少那华为手机就是一个实体我们分析用户的活跃度用户就是一个实体当然实体也可以现实中不存在的比如虚拟的业务对象活动会员等都可看做一个实体维度维度就是看待问题的角度分析业务数据从什么角度分析就建立什么样的维度比如你要分析产品销售情况你可以选择按商品类别来进行分析这就构成一个维度把所有商品类别集合在一起就构成了维度表度量度量是业务流程节点上的一个数值比如销量价格成本等等事实表中的度量可分为三类完全可加半可加不可加完全可加的度量是最灵活最有用的比如说销量销售额等可进行任意维度汇总半可加的度量可以对某些维度汇总但不能对所有维度汇总差额是常见的半可加度量它除了时间维度外可以跨所有维度进行加法操作还有一种是完全不可加的例如比率对于这类非可加度量一种好的方法是尽可能存储非可加度量的完全可加分量并在计算出最终的非可加事实前将这些分量汇总到最终的结果集中粒度口径口径就是取数逻辑如何取数的比如要取的数是岁以下儿童中男孩的平均身高这就是统计的口径指标标签标签是人为设定的根据业务场景需求对目标对象运用一定的算法得到的高度精炼的特征标识可见标签是经过人为再加工后的结果如网红白富美萝莉对于有歧义的标签我们内部可进行标签区分比如苹果我们可以定义苹果指的是水果苹果手机才指的是手机自然键由现实中已经存在的属性组成的键它在业务概念中是唯一的并具有一定的业务含义比如商品员工以数仓角度看来自于业务系统的标识符就是自然键比如业务库中员工的编号持久键保持永久性不会发生变化有时也被叫做超自然持久键比如身份证号属于持久键自然键和持久键区别举个例子就明白了比如说公司员工离职之后又重新入职他的自然键也就是员工编号发生了变化但是他的持久键身份证号是不变的代理键退化维度退化维度就是那些看起来像是事实表的一个维度关键字但实际上并没有对应的维度表就是维度属性存储到事实表中这种存储到事实表中的维度列被称为退化维度与其他存储在维表中的维度一样退化维度也可以用来进行事实表的过滤查询实现聚合操作等那么究竟怎么定义退化维度呢比如说订单这种量级很大的维度没必要用一张维度表来进行存储而我们进行数据查询或者数据过滤的时候又非常需要所以这种就冗余在事实表里面这种就叫退化维度这种我们也会冗余在事实表里面但是它有对应的维度表所以它不是退化维度下钻这是在数据分析中常见的概念下钻可以理解成增加维的层次从而可以由粗粒度到细粒度来观察数据比如对产品销售情况分析时可以沿着时间维从年到月到日更细粒度的观察数据从年的维度可以下钻到月的维度日的维度等上卷知道了下钻上卷就容易理解了它俩是相逆的操作所以上卷可以理解为删掉维的某些层由细粒度到粗粒度观察数据的操作或沿着维的层次向上聚合汇总数据数据集市数据集市也叫数据市场数据集市就是满足特定的部门或者用户的需求按照多维的方式进行存储包括定义维度需要计算的指标维度的层次等生成面向决策分析需求的数据立方体其实就是从数据仓库中抽取出来的一个小合集数仓名词之间关系实体表事实表维度表之间的关系数据集市和数据仓库的关系数据集市是企业级数据仓库的一个子集他主要面向部门级业务并且只面向某个特定的主题为了解决灵活性和性能之间的矛盾数据集市就是数据仓库体系结构中增加的一种小型的部门或工作组级别的数据仓库数据集市存储为特定用户预先计算好的数据从而满足用户对性能的需求数据集市可以在一定程度上缓解访问数据仓库的瓶颈数据集市和数据仓库的主要区别数据仓库是企业级的能为整个企业各个部门的运行提供决策支持手段而数据集市则是一种微型的数据仓库它通常有更少的数据更少的主题区域以及更少的历史数据因此是部门级的一般只能为某个局部范围内的管理人员服务因此也称之为部门级数据仓库离线数仓建设核心数据仓库的核心是展现层和提供优质的服务及其规范分层等所做的一切都是为了一个更清晰易用的展现层数仓分层数仓分层的原则为便于数据分析要屏蔽底层复杂业务简单完整集成的将数据暴露给分析层底层业务变动与上层需求变动对模型冲击最小化业务系统变化影响削弱在基础数据层结合自上而下的建设方法削弱需求变动对模型的影响高内聚松耦合即主题之内或各个完整意义的系统内数据的高内聚主题之间或各个完整意义的系统间数据的松耦合构建仓库基础数据层使底层业务数据整合工作与上层应用开发工作相隔离为仓库大规模开发奠定基础仓库层次更加清晰对外暴露数据更加统一一般采用如下分层结构数据源层层是最接近数据源中数据的一层为了考虑后续可能需要追溯数据问题因此对于这一层就不建议做过多的数据清洗工作原封不动地接入原始数据即可至于数据的去噪去重异常值处理等过程可以放在后面的层来做数据仓库层数据仓库层是我们在做数据仓库时要核心设计的一层在这里从层中获得的数据按照主题建立各种数据模型层又细分为层层和层数据明细层该层一般保持和层一样的数据粒度并且提供一定的数据质量保证层要做的就是将数据清理整合规范化脏数据垃圾数据规范不一致的状态定义不一致的命名不规范的数据都会被处理同时为了提高数据明细层的易用性该层会采用一些维度退化手法将维度退化至事实表中减少事实表和维表的关联另外在该层也会做一部分的数据聚合将相同主题的数据汇集到一张表中提高数据的可用性数据中间层该层会在层的数据基础上数据做轻度的聚合操作生成一系列的中间表提升公共指标的复用性减少重复加工直观来讲就是对通用的核心维度进行聚合操作算出相应的统计指标在实际计算中如果直接从或者计算出宽表的统计指标会存在计算量太大并且维度太少的问题因此一般的做法是在层先计算出多个小的中间表然后再拼接成一张的宽表由于宽和窄的界限不易界定也可以去掉这一层只留层将所有的数据再放在亦可数据服务层层为公共汇总层会进行轻度汇总粒度比明细数据稍粗基于层上的基础数据整合汇总成分析某一个主题域的服务数据一般是宽表层应覆盖的应用场景又称数据集市或宽表按照业务划分如主题域流量订单用户等生成字段比较多的宽表用于提供后续的业务查询分析数据分发等一般来讲该层的数据表会相对比较少一张表会涵盖比较多的业务内容由于其字段较多因此一般也会称该层的表为宽表数据应用层在这里主要是提供给数据产品和数据分析使用的数据一般会存放在等系统中供线上系统使用也可能会存在或者中供数据分析和数据挖掘使用比如我们经常说的报表数据一般就放在这里维表层如果维表过多也可针对维表设计单独一层维表层主要包含两部分数据高基数维度数据一般是用户资料表商品资料表类似的资料表数据量可能是千万级或者上亿级别低基数维度数据一般是配置表比如枚举值对应的中文含义或者日期维表数据量可能是个位数或者几千几万数仓建模方法那数仓建模怎么建呢其实数据仓库的建模方法有很多种每一种建模方法代表了哲学上的一个观点代表了一种归纳概括世界的一种方法常见的有范式建模法维度建模法实体建模法等每种方法从本质上将是从不同的角度看待业务中的问题范式建模法主要解决关系型数据库的数据存储利用的一种技术层面上的方法目前我们在关系型数据库中的建模方法大部分采用的是三范式建模法范式是符合某一种级别的关系模式的集合构造数据库必须遵循一定的规则而在关系型数据库中这种规则就是范式这一过程也被称为规范化目前关系数据库有六种范式第一范式第二范式第三范式范式第四范式和第五范式在数据仓库的模型设计中一般采用第三范式一个符合第三范式的关系必须具有以下三个条件每个属性值唯一不具有多义性每个非主属性必须完全依赖于整个主键而非主键的一部分每个非主属性不能依赖于其他关系中的属性因为这样的话这种属性应该归到其他关系中去第一范式第二范式第三范式范式第四范式第五范式维度建模法维度建模以分析决策的需求出发构建模型构建的数据模型为分析需求服务因此它重点解决用户如何更快速完成分析需求同时还有较好的大规模复杂查询的响应性能典型的代表是我们比较熟知的星形模型以及在一些特殊场景下适用的雪花模型维度建模中比较重要的概念就是事实表和维度表其最简单的描述就是按照事实表维度表来构建数据仓库数据集市实体建模法实体建模法并不是数据仓库建模中常见的一个方法它来源于哲学的一个流派从哲学的意义上说客观世界应该是可以细分的客观世界应该可以分成由一个个实体以及实体与实体之间的关系组成那么我们在数据仓库的建模过程中完全可以引入这个抽象的方法将整个业务也可以划分成一个个的实体而每个实体之间的关系以及针对这些关系的说明就是我们数据建模需要做的工作虽然实体法粗看起来好像有一些抽象其实理解起来很容易即我们可以将任何一个业务过程划分成个部分实体事件说明如下图所示上图表述的是一个抽象的含义如果我们描述一个简单的事实小明开车去学校上学以这个业务事实为例我们可以把小明学校看成是一个实体上学描述的是一个业务过程我们在这里可以抽象为一个具体事件而开车去则可以看成是事件上学的一个说明维度建模详解目前在互联网公司最常用的建模方法就是维度建模我们将重点讲解维度建模是专门应用于分析型数据库数据仓库数据集市建模的方法数据集市可以理解为是一种小型数据仓库维度建模中表的类型维度建模分为两种表事实表和维度表事实表必然存在的一些数据像采集的日志文件订单表都可以作为事实表特征是一堆主键的集合每个主键对应维度表中的一条记录客观存在的根据主题确定出需要使用的数据维度表维度就是所分析的数据的一个量维度表就是以合适的角度来创建的表分析问题的一个角度时间地域终端用户等角度事实表发生在现实世界中的操作型事件其所产生的可度量数值存储在事实表中从最低的粒度级别来看事实表行对应一个度量事件反之亦然事实表表示对分析主题的度量比如一次购买行为我们就可以理解为是一个事实图中的订单表就是一个事实表你可以理解他就是在现实中发生的一次操作型事件我们每完成一个订单就会在订单中增加一条记录事实表的特征表里没有存放实际的内容他是一堆主键的集合这些分别能对应到维度表中的一条记录事实表包含了与各维度表相关联的外键可与维度表关联事实表的度量通常是数值类型且记录数会不断增加表数据规模迅速增长明细表宽表事实表的数据中有些属性共同组成了一个字段糅合在一起比如年月日时分秒构成了时间当需要根据某一属性进行分组统计的时候需要截取拼接之类的操作效率极低如为了分析方便可以事实表中的一个字段切割提取多个属性出来构成新的字段因为字段变多了所以称为宽表原来的成为窄表又因为宽表的信息更加清晰明细所以也可以称之为明细表事实表种类事实表分为以下类事务事实表周期快照事实表累积快照事实表无事实的事实表聚集事实表合并事实表事务事实表表中的一行对应空间或时间上某点的度量事件就是一行数据中必须有度量字段什么是度量就是指标比如说销售金额销售数量等这些可加的或者半可加就是度量值另一点就是事务事实表都包含一个与维度表关联的外键并且度量值必须和事务粒度保持一致周期快照事实表顾名思义周期事实表就是每行都带有时间值字段代表周期通常时间值都是标准周期如某一天某周某月等粒度是周期而不是个体的事务也就是说一个周期快照事实表中数据可以是多个事实但是它们都属于某个周期内累计快照事实表周期快照事实表是单个周期内数据而累计快照事实表是由多个周期数据组成每行汇总了过程开始到结束之间的度量每行数据相当于管道或工作流有事件的起点过程终点并且每个关键步骤都包含日期字段如订单数据累计快照事实表的一行就是一个订单当订单产生时插入一行当订单发生变化时这行就被修改无事实的事实表聚集事实表合并事实表维度表每个维度表都包含单一的主键列维度表的主键可以作为与之关联的任何事实表的外键当然维度表行的描述环境应与事实表行完全对应维度表通常比较宽是扁平型非规范表包含大量的低粒度的文本属性维度表示你要对数据进行分析时所用的一个量比如你要分析产品销售情况你可以选择按类别来进行分析或按区域来分析每个类别就构成一个维度上图中的用户表商家表时间表这些都属于维度表这些表都有一个唯一的主键然后在表中存放了详细的数据信息总的说来在数据仓库中不需要严格遵守规范化设计原则因为数据仓库的主导功能就是面向分析以查询为主不涉及数据更新操作事实表的设计是以能够正确记录历史信息为准则维度表的设计是以能够以合适的角度来聚合主题内容为准则维度表结构维度表谨记一条原则包含单一主键列但有时因业务复杂也可能出现联合主键请尽量避免如果无法避免也要确保必须是单一的这很重要如果维表主键不是单一和事实表关联时会出现数据发散导致最后结果可能出现错误维度表通常比较宽包含大量的低粒度的文本属性跨表钻取跨表钻取意思是当每个查询的行头都包含相同的一致性属性时使不同的查询能够针对两个或更多的事实表进行查询钻取可以改变维的层次变换分析的粒度它包括上钻下钻上钻上卷是沿着维的层次向上聚集汇总数据例如对产品销售数据沿着时间维上卷可以求出所有产品在所有地区每月或季度或年或全部的销售额下钻下钻是上钻的逆操作它是沿着维的层次向下查看更详细的数据退化维度退化维度就是将维度退回到事实表中因为有时维度除了主键没有其他内容虽然也是合法维度键但是一般都会退回到事实表中减少关联次数提高查询性能多层次维度多数维度包含不止一个自然层次如日期维度可以从天的层次到周到月到年的层次所以在有些情况下在同一维度中存在不同的层次维度表空值属性当给定维度行没有被全部填充时或者当存在属性没有被应用到所有维度行时将产生空值维度属性上述两种情况推荐采用描述性字符串代替空值如使用或替换空值日历日期维度在日期维度表中主键的设置不要使用顺序生成的来表示可以使用更有意义的数据表示比如将年月日合并起来表示即或者更加详细的精度维度建模三种模式星型模式星形模式是最常用的维度建模方式星型模式是以事实表为中心所有的维度表直接连接在事实表上像星星一样星形模式的维度建模由一个事实表和一组维表成且具有以下特点维表只和事实表关联维表之间没有关联每个维表主键为单列且该主键放置在事实表中作为两边连接的外键以事实表为核心维表围绕核心呈星形分布雪花模式雪花模式是对星形模式的扩展雪花模式的维度表可以拥有其他维度表的虽然这种模型相比星型更规范一些但是由于这种模型不太容易理解维护成本比较高而且性能方面需要关联多层维表性能也比星型模型要低所以一般不是很常用星座模式星座模式是星型模式延伸而来星型模式是基于一张事实表的而星座模式是基于多张事实表的而且共享维度信息前面介绍的两种维度建模方法都是多维表对应单事实表但在很多时候维度空间内的事实表不止一个而一个维表也可能被多个事实表用到在业务发展后期绝大部分维度建模都采用的是星座模式维度建模过程我们知道维度建模的表类型有事实表维度表模式有星形模型雪花模型星座模型这些概念了但是实际业务中给了我们一堆数据我们怎么拿这些数据进行数仓建设呢数仓工具箱作者根据自身多年的实际业务经验给我们总结了如下四步请务必记住数仓工具箱中的维度建模四步走选择业务过程维度建模是紧贴业务的所以必须以业务为根基进行建模那么选择业务过程顾名思义就是在整个业务流程中选取我们需要建模的业务根据运营提供的需求及日后的易扩展性等进行选择业务比如商城整个商城流程分为商家端用户端平台端运营需求是总订单量订单人数及用户的购买情况等我们选择业务过程就选择用户端的数据商家及平台端暂不考虑业务选择非常重要因为后面所有的步骤都是基于此业务数据展开的声明粒度先举个例子对于用户来说一个用户有一个身份证号一个户籍地址多个手机号多张银行卡那么与用户粒度相同的粒度属性有身份证粒度户籍地址粒度比用户粒度更细的粒度有手机号粒度银行卡粒度存在一对一的关系就是相同粒度为什么要提相同粒度呢因为维度建模中要求我们在同一事实表中必须具有相同的粒度同一事实表中不要混用多种不同的粒度不同的粒度数据建立不同的事实表并且从给定的业务过程获取数据时强烈建议从关注原子粒度开始设计也就是从最细粒度开始因为原子粒度能够承受无法预期的用户查询但是上卷汇总粒度对查询性能的提升很重要的所以对于有明确需求的数据我们建立针对需求的上卷汇总粒度对需求不明朗的数据我们建立原子粒度确认维度维度表是作为业务分析的入口和描述性标识所以也被称为数据仓库的灵魂在一堆的数据中怎么确认哪些是维度属性呢如果该列是对具体值的描述是一个文本或常量某一约束和行标识的参与者此时该属性往往是维度属性数仓工具箱中告诉我们牢牢掌握事实表的粒度就能将所有可能存在的维度区分开并且要确保维度表中不能出现重复数据应使维度主键唯一确认事实事实表是用来度量的基本上都以数量值表示事实表中的每行对应一个度量每行中的数据是一个特定级别的细节数据称为粒度维度建模的核心原则之一是同一事实表中的所有度量必须具有相同的粒度这样能确保不会出现重复计算度量的问题有时候往往不能确定该列数据是事实属性还是维度属性记住最实用的事实就是数值类型和可加类事实所以可以通过分析该列是否是一种包含多个值并作为计算的参与者的度量这种情况下该列往往是事实离线数仓建设实战业务介绍需要针对不同需求的用户开发不同的产品所以公司内部有很多条业务线但是对于数据部门来说所有业务线的数据都是数据源对数据的划分不只是根据业务进行而是结合数据的属性早期规划之前开发是不同业务线对应不同的数据团队每个数据团队互不干扰这种模式比较简单只针对自己的业务线进行数仓建设及报表开发即可但是随着业务的发展频繁迭代及跨部门的垂直业务单元越来越多业务之间的出现耦合情况这时再采用这种烟囱式开发就出现了问题例如权限问题公司对数据管理比较严格不同的数据开发组没有权限共享数据需要其他业务线的数据权限需要上报审批比较耽误时间还有重复开发问题不同业务线会出现相同的报表需求如果每个业务方都开发各自的报表太浪费资源所以对于数据开发而言需要对各个业务线的数据进行统一管理所以就有了数据中台的出现数据中台我认为数据中台是根据每个公司具体的业务需求而搭建的不同的业务对中台的理解有所不同公司内部开发的敏捷数据中台主要从数据技术和计算能力的复用到数据资产和数据服务的复用数据中台以更大价值带宽快准精让数据直接赋能业务提供一个统一化的管理打破数据孤岛追溯数据血缘实现自助化及高复用度如下所示以上解释比较抽象我们以实际项目开发来看下数据中台的便利性比如我们之前做报表开发流程首先是要数据采集不同的数据源通过等工具采集到大数据平台然后进行数仓搭建最后产出报表数据放到可视化系统展示最终把整个流程写成脚本放到调度平台进行自动化执行而有了数据中台之后就不需要那么繁琐直接进行数仓搭建产生报表即可无需将精力过多放在数据源可视化展示及调度并且可以直观的查看数据血缘关系计算表之间血缘像下面图中表之间的依赖关系很明确另一点数据中台的异构数据系统可以非常简单的进行关联查询比如的表关联的表可透明屏蔽异构数据系统异构交互方式轻松实现跨异构数据系统透明混算异构数据系统原理是数据中台提供虚拟表到物理表之间的映射终端用户无需关心数据的物理存放位置和底层数据源的特性可直接操作数据体验类似操作一个虚拟数据库数据中台额外集成可视化展示提供一站式数据可视化解决方案支持数据源和文件上传支持基于数据模型拖拽智能生成可视化组件大屏展示自适应不同大小屏幕调度系统是公司内部自写集成到数据中台的在编写完语句之后可以直接进行调度数仓建设到这才真正到数仓建设为什么前面我要占那么大篇幅去介绍公司业务及所使用的数据中台系统因为下面的数仓建设是根据公司的业务发展及现有的数据中台进行数仓的建设离不开公司的业务数仓建设核心思想从设计开发部署和使用层面避免重复建设和指标冗余建设从而保障数据口径的规范和统一最终实现数据资产全链路关联提供标准数据输出以及建立统一的数据公共层有了核心思想那怎么开始数仓建设有句话说数仓建设者即是技术专家也是大半个业务专家所以采用的方式就是需求推动数据建设并且因为数据中台所以各业务知识体系比较集中各业务数据不再分散加快了数仓建设速度数仓建设主要从两个方面进行模型和规范所有业务进行统一化模型所有业务采用统一的模型体系从而降低研发成本增强指标复用并且能保证数据口径的统一模型分层结合公司业务后期新增需求较多所以分层不宜过多并且需要清晰明确各层职责要保证数据层的稳定又要屏蔽对下游影响所以采用如下分层结构数据流向遵循模型开发时分层结构数据从这样正向流动可以防止因数据引用不规范而造成数据链路混乱及时效难保障等问题同时保证血缘关系简洁化能够轻易追踪数据流向在开发时应避免以下情况出现数据引用链路不正确如出现这种情况说明明细层没有完全覆盖数据如说明轻度汇总层主题划分未覆盖全减少跨层引用才能提高中间表的复用度理想的数仓模型设计应当具备数据模型可复完善且规范尽量避免一层的表生成当前层的表如层表生成层表这样会影响效率禁止出现反向依赖如表依赖于表规范表命名规范对于层表名类型主题表含义如对于层表名类型主题维度表含义如事实表维度表字段命名规范构建词根词根是维度和指标管理的基础划分为普通词根与专有词根普通词根描述事物的最小单元体如性别专有词根具备行业专属或公司内部规定的描述体如公司内部对某个产品的称呼脚本命名规范脚本名称脚本类型脚本功用库名脚本名称如脚本类型主要分为以下三类常规自定义脚本自定义脚本脚本内容规范数据层具体实现数据源层数据源层主要将各个业务数据导入到大数据平台作为业务数据的快照存储数据明细层事实表中的每行对应一个度量每行中的数据是一个特定级别的细节数据称为粒度维度建模的核心原则之一是同一事实表中的所有度量必须具有相同的粒度这样能确保不会出现重复计算度量的问题维度表一般都是单一主键少数是联合主键注意维度表不要出现重复数据否则和事实表关联会出现数据发散问题有时候往往不能确定该列数据是事实属性还是维度属性记住最实用的事实就是数值类型和可加类事实所以可以通过分析该列是否是一种包含多个值并作为计算的参与者的度量这种情况下该列往往是事实如果该列是对具体值的描述是一个文本或常量某一约束和行标识的参与者此时该属性往往是维度属性但是还是要结合业务进行最终判断是维度还是事实数据轻度汇总层此层命名为轻汇总层就代表这一层已经开始对数据进行汇总但是不是完全汇总只是对相同粒度的数据进行关联汇总不同粒度但是有关系的数据也可进行汇总此时需要将粒度通过聚合等操作进行统一数据应用层数据应用层的表就是提供给用户使用的数仓建设到此就接近尾声了接下来就根据不同的需求进行不同的取数如直接进行报表展示或提供给数据分析的同事所需的数据或其他的业务支撑总结一张图总结下数据仓库的构建整体流程实际生产中注意事项生产环境中操作不能像我们自己测试时那样随意一不小心都可能造成生产事故所以每步操作都要十分小心需全神贯注管好大脑管住右手仅列出以下但不限于以下的注意事项请勿操作自己管理及授权表之外的其它库表未经授权请勿操作生产环境中其他人的脚本及文件在修改生产环境脚本前请务必自行备份到本地请确认自己的修改操作能迅速回滚生产环境中表名及字段等所有命名请遵循命名规则实时计算实时计算一般都是针对海量数据进行的并且要求为秒级由于大数据兴起之初并没有给出实时计算解决方案随后等实时计算框架应运而生而的兴起使得实时计算领域的技术越来越完善而随着物联网机器学习等技术的推广实时流式计算将在这些领域得到充分的应用实时计算的三个特征无限数据无限数据指的是一种不断增长的基本上无限的数据集这些通常被称为流数据而与之相对的是有限的数据集无界数据处理一种持续的数据处理模式能够通过处理引擎重复的去处理上面的无限数据是能够突破有限数据处理引擎的瓶颈的低延迟延迟是多少并没有明确的定义但我们都知道数据的价值将随着时间的流逝降低时效性将是需要持续解决的问题现在大数据应用比较火爆的领域比如推荐系统在实践之初受技术所限可能要一分钟一小时甚至更久对用户进行推荐这远远不能满足需要我们需要更快的完成对数据的处理而不是进行离线的批处理实时计算应用场景随着实时技术发展趋于成熟实时计算应用越来越广泛以下仅列举常见的几种实时计算的应用场景实时智能推荐智能推荐会根据用户历史的购买或浏览行为通过推荐算法训练模型预测用户未来可能会购买的物品或喜爱的资讯对个人来说推荐系统起着信息过滤的作用对服务端来说推荐系统起着满足用户个性化需求提升用户满意度的作用推荐系统本身也在飞速发展除了算法越来越完善对时延的要求也越来越苛刻和实时化利用流计算帮助用户构建更加实时的智能推荐系统对用户行为指标进行实时计算对模型进行实时更新对用户指标进行实时预测并将预测的信息推送给端帮助用户获取想要的商品信息另一方面也帮助企业提升销售额创造更大的商业价值实时欺诈检测在金融领域的业务中常常出现各种类型的欺诈行为例如信用卡欺诈信贷申请欺诈等而如何保证用户和公司的资金安全是近年来许多金融公司及银行共同面对的挑战随着不法分子欺诈手段的不断升级传统的反欺诈手段已经不足以解决目前所面临的问题以往可能需要几个小时才能通过交易数据计算出用户的行为指标然后通过规则判别出具有欺诈行为嫌疑的用户再进行案件调查处理在这种情况下资金可能早已被不法分子转移从而给企业和用户造成大量的经济损失而运用流式计算技术能够在毫秒内就完成对欺诈行为判断指标的计算然后实时对交易流水进行实时拦截避免因为处理不及时而导致的经济损失舆情分析有的客户需要做舆情分析要求所有数据存放若干年舆情数据每日数据量可能超百万年数据量可达到几十亿的数据而且爬虫爬过来的数据是舆情通过大数据技术进行分词之后得到的可能是大段的网友评论客户往往要求对舆情进行查询做全文本搜索并要求响应时间控制在秒级爬虫将数据爬到大数据平台的里在里面做流处理去重去噪做语音分析写到里大数据的一个特点是多数据源大数据平台能根据不同的场景选择不同的数据源复杂事件处理对于复杂事件处理比较常见的集中于工业领域例如对车载传感器机械设备等实时故障检测这些业务类型通常数据量都非常大且对数据处理的时效性要求非常高通过利用提供的进行时间模式的抽取同时应用的进行事件数据的转换在流式系统中构建实施规则引擎一旦事件触发报警规则便立即将告警结果通知至下游通知系统从而实现对设备故障快速预警检测车辆状态监控等目的实时机器学习实时机器学习是一个更宽泛的概念传统静态的机器学习主要侧重于静态的模型和历史数据进行训练并提供预测很多时候用户的短期行为对模型有修正作用或者说是对业务判断有预测作用对系统来说需要采集用户最近的行为并进行特征工程然后给到实时机器学习系统进行机器学习如果动态地实施新规则或是推出新广告就会有很大的参考价值实时计算总览我们先来看一张大数据平台的实时架构图数据同步在上面这张架构图中数据从平台中产生通过数据同步系统导入到大数据平台由于数据源不同这里的数据同步系统实际上是多个相关系统的组合数据库同步通常日志同步可以选择等不同的数据源产生的数据质量可能差别很大数据库中的格式化数据直接导入大数据系统即可而日志和爬虫产生的数据就需要进行大量的清洗转化处理才能有效使用数据存储该层对原始数据清洗关联后的明细数据进行存储基于统一的实时数据模型分层理念将不同应用场景的数据分别存储在等存储中数据计算计算层主要使用以及自带的计算能力等四种计算引擎计算引擎主要用于实时数据同步流式关键系统秒级实时指标计算场景主要用于复杂多维分析的准实时指标计算需求场景和主要满足多维自助分析对查询响应时间要求不太高的场景实时应用以统一查询服务对各个业务线数据场景进行支持业务主要包括实时大屏实时数据产品实时实时特征等当然一个好的大数据平台不能缺少元数据管理及数据治理元数据及指标管理主要对实时的表表表表等进行统一管理以数仓模型中表的命名方式规范表的命名明确每张表的字段含义使用方指标管理则是尽量通过指标管理系统将所有的实时指标统一管理起来明确计算口径提供给不同的业务方使用数据质量及血缘分析数据质量分为平台监控和数据监控两个部分血缘分析则主要是对实时数据依赖关系实时任务的依赖关系进行分析以上架构只是大数据平台通用的数据模型如果要具体的建设需要考虑以下情况业务需求需要实时还是准实时即可数据时效性是秒级还是分钟级等在调度开销方面准实时数据是批处理过程因此仍然需要调度系统支持调度频率较高而实时数据却没有调度开销在业务灵活性方面因为准实时数据是基于或引擎实现灵活性优于基于流计算的方式在对数据晚到的容忍度方面因为准实时数据可以基于一个周期内的数据进行全量计算因此对于数据晚到的容忍度也是比较高的而实时数据使用的是增量计算对于数据晚到的容忍度更低一些在适用场景方面准实时数据主要用于有实时性要求但不太高涉及多表关联和业务变更频繁的场景如交易类型的实时分析实时数据则更适用于实时性要求高数据量大的场景如实时特征流量类型实时分析等场景实时架构架构架构实时数仓建设核心',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-03 23:34:02',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Tech智汇站</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/ChatGPT/" style="font-size: 1.05rem;">ChatGPT<sup>1</sup></a><a href="/tags/CloudFlare/" style="font-size: 1.05rem;">CloudFlare<sup>2</sup></a><a href="/tags/EScrcpy/" style="font-size: 1.05rem;">EScrcpy<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 1.05rem;">GitHub<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 1.05rem;">NodeJs<sup>1</sup></a><a href="/tags/PowerToys/" style="font-size: 1.05rem;">PowerToys<sup>1</sup></a><a href="/tags/US-KG/" style="font-size: 1.05rem;">US.KG<sup>1</sup></a><a href="/tags/Vip%E8%A7%86%E9%A2%91/" style="font-size: 1.05rem;">Vip视频<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>3</sup></a><a href="/tags/github/" style="font-size: 1.05rem;">github<sup>1</sup></a><a href="/tags/idea/" style="font-size: 1.05rem;">idea<sup>1</sup></a><a href="/tags/seal/" style="font-size: 1.05rem;">seal<sup>1</sup></a><a href="/tags/yt-dlp/" style="font-size: 1.05rem;">yt-dlp<sup>1</sup></a><a href="/tags/%E4%BC%91%E7%9C%A0/" style="font-size: 1.05rem;">休眠<sup>1</sup></a><a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size: 1.05rem;">免费<sup>3</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 1.05rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8A%9F%E8%83%BD%E9%9B%86%E5%90%88%E8%BD%AF%E4%BB%B6/" style="font-size: 1.05rem;">功能集合软件<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 1.05rem;">域名<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E6%89%98%E7%AE%A1/" style="font-size: 1.05rem;">域名托管<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E7%94%B3%E8%AF%B7/" style="font-size: 1.05rem;">域名申请<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 1.05rem;">大数据<sup>26</sup></a><a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">大模型<sup>1</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 1.05rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%AE%9E%E6%97%B6%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 1.05rem;">实时语音转文字<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 1.05rem;">廖雪峰<sup>9</sup></a><a href="/tags/%E6%89%8B%E6%9C%BA%E6%8A%95%E5%B1%8F/" style="font-size: 1.05rem;">手机投屏<sup>1</sup></a><a href="/tags/%E6%B3%A8%E9%94%80/" style="font-size: 1.05rem;">注销<sup>1</sup></a><a href="/tags/%E7%94%B5%E9%87%8F%E6%98%BE%E7%A4%BA/" style="font-size: 1.05rem;">电量显示<sup>1</sup></a><a href="/tags/%E7%9D%A1%E7%9C%A0/" style="font-size: 1.05rem;">睡眠<sup>1</sup></a><a href="/tags/%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87/" style="font-size: 1.05rem;">蓝牙设备<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E8%BA%AB%E4%BB%BD%E7%94%9F%E6%88%90/" style="font-size: 1.05rem;">虚拟身份生成<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90/" style="font-size: 1.05rem;">视频解析<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%BD%AC%E5%AD%97%E5%B9%95/" style="font-size: 1.05rem;">视频转字幕<sup>1</sup></a><a href="/tags/%E9%87%8D%E5%90%AF/" style="font-size: 1.05rem;">重启<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.05rem;">面试<sup>12</sup></a><a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 1.05rem;">音视频转文字<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">124</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/" itemprop="url">求职</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/%E9%9D%A2%E8%AF%95/" itemprop="url">面试</a></span></div></div><h1 class="post-title" itemprop="name headline">面试 Hadoop面试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="post-meta-icon anzhiyufont anzhiyu-icon-calendar-days"></i><span class="post-meta-label">发表于</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="发表于 2025-01-17 17:35:02">2025-01-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20Hadoop%E9%9D%A2%E8%AF%95/"><header><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/" itemprop="url">求职</a><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/%E9%9D%A2%E8%AF%95/" itemprop="url">面试</a><h1 id="CrawlerTitle" itemprop="name headline">面试 Hadoop面试</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">智汇君</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="undefined 2025-01-17 17:35:02">2025-01-17</time></header><h1 id="Hadoop面试"><a href="#Hadoop面试" class="headerlink" title="Hadoop面试"></a>Hadoop面试</h1><h2 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="F:\Typora文件\Hadoop面试.assets\202408201734678.png" alt="image-20240820173415068"></p>
<h2 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h2><h3 id="机架感知与副本冗余存储策略"><a href="#机架感知与副本冗余存储策略" class="headerlink" title="机架感知与副本冗余存储策略"></a>机架感知与副本冗余存储策略</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211320516.png" alt="image-20240821132016998"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211320601.png" alt="image-20240821132049530"></p>
<h2 id="MAPREDUCE"><a href="#MAPREDUCE" class="headerlink" title="MAPREDUCE"></a>MAPREDUCE</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201837524.png" alt="image-20240820183725167"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MapReduce 要求&lt;key,value&gt;的 key 和 value 都要实现 Writable接口,从而支持 Hadoop 的序列化和反序列化。上面的Hadoop的内置类型都实现了Writable接口，用户也必须对自定义的类实现 Writable 接口。</span><br></pre></td></tr></table></figure>

<h3 id="案例一-WordCount-程序"><a href="#案例一-WordCount-程序" class="headerlink" title="案例一 WordCount 程序"></a>案例一 WordCount 程序</h3><h3 id="案例二-统计各个部门员工薪水总和"><a href="#案例二-统计各个部门员工薪水总和" class="headerlink" title="案例二 统计各个部门员工薪水总和"></a>案例二 统计各个部门员工薪水总和</h3><h3 id="案例三-序列化"><a href="#案例三-序列化" class="headerlink" title="案例三 序列化"></a>案例三 序列化</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201852497.png" alt="image-20240820185230976"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201852118.png" alt="image-20240820185248895"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201853012.png" alt="image-20240820185310359"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201853647.png" alt="image-20240820185326642"></p>
<h3 id="案例四-分区"><a href="#案例四-分区" class="headerlink" title="案例四 分区"></a>案例四 分区</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201904164.png" alt="image-20240820190451623"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201905851.png" alt="image-20240820190525087"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201905133.png" alt="image-20240820190553658"></p>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082307138.png" alt="image-20240908230742828"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">解：</span><br><span class="line">map里面编写if判断，低薪，中薪，高薪作为k2</span><br><span class="line">patitioner里面编写if判断，分为三个区</span><br></pre></td></tr></table></figure>



<h3 id="案例五-合并-预聚合"><a href="#案例五-合并-预聚合" class="headerlink" title="案例五 合并 预聚合"></a>案例五 合并 预聚合</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408201908913.png" alt="image-20240820190811113"></p>
<h3 id="简述MapTask并行度决定机制"><a href="#简述MapTask并行度决定机制" class="headerlink" title="简述MapTask并行度决定机制?"></a>简述MapTask并行度决定机制?</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1LM41127wF/?spm_id_from=333.999.0.0&vd_source=379b5659b7b00bb6caa4cadf9cc37ad6">源码分析</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211345293.png" alt="image-20240821134537856"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211346038.png" alt="image-20240821134644599"></p>
<h3 id="简述FileInputFormat-默认应该是其子类textinputformat-切片机制"><a href="#简述FileInputFormat-默认应该是其子类textinputformat-切片机制" class="headerlink" title="简述FileInputFormat(默认应该是其子类textinputformat)切片机制?"></a>简述FileInputFormat(默认应该是其子类textinputformat)切片机制?</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1144y1o7bn/?spm_id_from=333.999.0.0&vd_source=379b5659b7b00bb6caa4cadf9cc37ad6">源码分析</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211351380.png" alt="image-20240821135140508"></p>
<h3 id="MapReduce程序如何大量小文件"><a href="#MapReduce程序如何大量小文件" class="headerlink" title="MapReduce程序如何大量小文件?"></a>MapReduce程序如何大量小文件?</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sequencefile</span><br><span class="line">mapfile</span><br><span class="line">archive</span><br><span class="line">combinetextinputformat</span><br></pre></td></tr></table></figure>

<h4 id="combinetextinputformat"><a href="#combinetextinputformat" class="headerlink" title="combinetextinputformat"></a>combinetextinputformat</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211403064.png" alt="image-20240821140331434"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211404788.png" alt="image-20240821140415258"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211406395.png" alt="image-20240821140656305"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211408117.png" alt="image-20240821140811918"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211409822.png" alt="image-20240821140951043"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408211411191.png" alt="image-20240821141140488"></p>
<h3 id="ReduceTask并行度与分区的关系"><a href="#ReduceTask并行度与分区的关系" class="headerlink" title="ReduceTask并行度与分区的关系?"></a>ReduceTask并行度与分区的关系?</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241603077.png" alt="image-20240824160337356"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241605551.png" alt="image-20240824160501723"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241607529.png" alt="image-20240824160722134"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241610052.png" alt="image-20240824161009683"></p>
<h3 id="MapReduce排序"><a href="#MapReduce排序" class="headerlink" title="MapReduce排序?"></a>MapReduce排序?</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241613060.png" alt="image-20240824161315657"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241618879.png" alt="image-20240824161846627"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241621932.png" alt="image-20240824162126988"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shuffle过程一次快排，两次归并排序 </span><br></pre></td></tr></table></figure>

<h4 id="自定义排序WritableComparable"><a href="#自定义排序WritableComparable" class="headerlink" title="自定义排序WritableComparable"></a>自定义排序WritableComparable</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241626284.png" alt="image-20240824162648951"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241630117.png" alt="image-20240824163024833"></p>
<h3 id="MapReduce的Combiner组件-预聚合"><a href="#MapReduce的Combiner组件-预聚合" class="headerlink" title="MapReduce的Combiner组件(预聚合)?"></a>MapReduce的Combiner组件(预聚合)?</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241648202.png" alt="image-20240824164758476"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241654862.png" alt="image-20240824165452176"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241658376.png" alt="image-20240824165854024"></p>
<h4 id="自定义Combiner"><a href="#自定义Combiner" class="headerlink" title="自定义Combiner"></a>自定义Combiner</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">默认直接用编写的reducer就可以了，没必要重新编写</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241700677.png" alt="image-20240824170000756"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241705157.png" alt="image-20240824170548478"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241708120.png" alt="image-20240824170838676"></p>
<h3 id="MapReduce分组求TopN-GroupingComparator"><a href="#MapReduce分组求TopN-GroupingComparator" class="headerlink" title="MapReduce分组求TopN? GroupingComparator"></a>MapReduce分组求TopN? GroupingComparator</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241717536.png" alt="image-20240824171750947"></p>
<h4 id="student"><a href="#student" class="headerlink" title="student"></a>student</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241745345.png" alt="image-20240824174501852"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241744784.png" alt="image-20240824174438588"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241744352.png" alt="image-20240824174359207"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241743044.png" alt="image-20240824174337553"></p>
<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241746474.png" alt="image-20240824174638087"></p>
<h4 id="groupingcomparator"><a href="#groupingcomparator" class="headerlink" title="groupingcomparator"></a>groupingcomparator</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241750013.png" alt="image-20240824175013787"></p>
<h4 id="分组第一名"><a href="#分组第一名" class="headerlink" title="分组第一名"></a>分组第一名</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241737574.png" alt="image-20240824173714339"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241755835.png" alt="image-20240824175521059"></p>
<h4 id="分组topn"><a href="#分组topn" class="headerlink" title="分组topn"></a>分组topn</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241739465.png" alt="image-20240824173909694"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241739442.png" alt="image-20240824173949049"></p>
<h4 id="组装job"><a href="#组装job" class="headerlink" title="组装job"></a>组装job</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241735952.png" alt="image-20240824173533035"></p>
<h3 id="MapReduce-Join"><a href="#MapReduce-Join" class="headerlink" title="MapReduce Join?"></a>MapReduce Join?</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241838344.png" alt="image-20240824183839975"></p>
<h4 id="reduce-join"><a href="#reduce-join" class="headerlink" title="reduce join"></a>reduce join</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241840751.png" alt="image-20240824184026722"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241843784.png" alt="image-20240824184334196"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241845131.png" alt="image-20240824184523561"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241851318.png" alt="image-20240824185101754"></p>
<h5 id="reducejoin缺点"><a href="#reducejoin缺点" class="headerlink" title="reducejoin缺点"></a>reducejoin缺点</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241853095.png" alt="image-20240824185327125"></p>
<h4 id="mapjoin"><a href="#mapjoin" class="headerlink" title="mapjoin"></a>mapjoin</h4><h5 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241857237.png" alt="image-20240824185658356"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408241900444.png" alt="image-20240824190032984"></p>
<h3 id="MultipleInputs"><a href="#MultipleInputs" class="headerlink" title="MultipleInputs"></a>MultipleInputs</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">在MapReduce程序中同时处理两个不同输入目录中的数据文件，最终统计所有文件中单词出现的次数。【简称：多路输入】</span><br><span class="line"></span><br><span class="line">第一个输入目录为：hdfs://bigdata01:9000/abc</span><br><span class="line"></span><br><span class="line">此目录下有多个文件，文件内容如下：文件中的单词之间分隔符是逗号</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">hello,you,hello</span><br><span class="line">hehe,haha,tom</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line">第二个输入目录为：hdfs://bigdata01:9000/xyz</span><br><span class="line"></span><br><span class="line">此目录下有多个文件，文件内容如下：文件中的单词之间分隔符是空格</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">hello you hello</span><br><span class="line">hehe haha tom</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">效果：</span><br><span class="line"></span><br><span class="line">最终想要获取类似这样的结果</span><br><span class="line"></span><br><span class="line">​```</span><br><span class="line">haha,2</span><br><span class="line">hehe,2</span><br><span class="line">hello,4</span><br><span class="line">tom,2</span><br><span class="line">you,2</span><br><span class="line">​```</span><br><span class="line"></span><br><span class="line">任务要求:</span><br><span class="line"></span><br><span class="line">1：针对每一个输入目录设置使用不同的自定义Mapper，里面写不同的处理逻辑，因为两份数据中的数据格式是不一样的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">任务提示、思路分析：</span><br><span class="line"></span><br><span class="line">1：使用MultipleInputs实现加载不同路径中的文件，查阅MultipleInputs的相关使用资料</span><br><span class="line"></span><br><span class="line">2：针对不同的输入目录设置不同的自定义Mapper，最终需要定义两个自定义Mapper</span><br></pre></td></tr></table></figure>

<h3 id="mapreduce压缩"><a href="#mapreduce压缩" class="headerlink" title="mapreduce压缩"></a>mapreduce压缩</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">在MapReduce程序中使用gzip数据压缩方式对程序计算性能进行优化</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">效果：</span><br><span class="line">提高程序计算效率</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">任务要求:</span><br><span class="line"></span><br><span class="line">1：对map阶段输出数据进行压缩，指定gzip压缩方式</span><br><span class="line"></span><br><span class="line">2：对reduce阶段输出数据进行压缩，指定gzip压缩方式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">任务提示、思路分析：</span><br><span class="line"></span><br><span class="line">1：在执行任务的时候通过命令行动态指定map端输出数据的压缩格式和reduce端输出数据的压缩格式</span><br><span class="line"></span><br><span class="line">2：具体如何指定数据压缩格式，需要大家自行查阅资料</span><br></pre></td></tr></table></figure>

<h3 id="案例六-去重"><a href="#案例六-去重" class="headerlink" title="案例六 去重"></a>案例六 去重</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">获取员工表所有的job 信息，要求仅列出不同的值。类似下面SQL语句的功能:select distinct job from EMP</span><br><span class="line"></span><br><span class="line">如果k2是job,那么Reducer的输人k3,就是去掉重复后的job,而v2的类型用NullWritable即可。Reducer直接输出k3即可。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082211414.png" alt="image-20240908221146920"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082212806.png" alt="image-20240908221206720"></p>
<h3 id="案例七-多表查询"><a href="#案例七-多表查询" class="headerlink" title="案例七 多表查询"></a>案例七 多表查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">采用 MapReduce 实现类似下面SQL语句的功能:select d.dname,e.ename from emp e,dept d where e.deptno=d.deptno</span><br><span class="line"></span><br><span class="line">(1)Map端读取所有的文件，并为输出的内容加上标识，代表文件数据来源于员工表或部门表。</span><br><span class="line">(2)在 Reduce端，按照标识对数据进行处理。</span><br></pre></td></tr></table></figure>

<h4 id="map-1"><a href="#map-1" class="headerlink" title="map"></a>map</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082222309.png" alt="image-20240908222226492"></p>
<h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082223171.png" alt="image-20240908222327134"></p>
<h4 id="job"><a href="#job" class="headerlink" title="job"></a>job</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082224518.png" alt="image-20240908222430353"></p>
<h3 id="案例八-求出各年销售笔数、各年销售总额"><a href="#案例八-求出各年销售笔数、各年销售总额" class="headerlink" title="案例八 求出各年销售笔数、各年销售总额"></a>案例八 求出各年销售笔数、各年销售总额</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409082326042.png" alt="image-20240908232604809"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解：</span><br><span class="line">提取的年份作为k2,v2可以用类来包装销售额和数量，或者用字符串拼接</span><br></pre></td></tr></table></figure>



<h2 id="YARN"><a href="#YARN" class="headerlink" title="YARN"></a>YARN</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yarn是一个资源调度平台，负责为计算程序提供服务器运行资源，相当于一个分布式的操作系统平台，而MapReduce等运算程序则相当于运行于操作系统之上的应用程序。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091552361.png" alt="image-20240909155200089"></p>
<h3 id="yarn基本架构"><a href="#yarn基本架构" class="headerlink" title="yarn基本架构"></a>yarn基本架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YARN主要由ResourceManager、NodeManager、ApplicationMaster (AM)和Cantainer等组件构成</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091553294.png" alt="image-20240909155328893"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(l)ResourceManager(rm):是整个集群的老大，启动在某台机器上。处理客户端请求、启动/监控ApplicatianMaster、监控NadeManager、资源分配与调度。</span><br><span class="line">是某台机器的老大。单个节点上的资源管理、处(2)NodeManager(nm):理来自ResourceManager的命令、处理来自ApplicarionMaster的命令。是某个MapReduce任务的老大。数据切分、为应用</span><br><span class="line">(3)ApplicationMaster:程序申请资源，并分配给内部任务、任务监控与容错。</span><br><span class="line">(4)Container:对任务运行环境的抽象，用于运行MapReduce任务。封装了CPU、内存等多维资源以及环境变量、启动命令等任务运行相关的信息。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091557836.png" alt="image-20240909155716448"></p>
<h3 id="yarn常用命令操作"><a href="#yarn常用命令操作" class="headerlink" title="yarn常用命令操作"></a>yarn常用命令操作</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">状态的查询，除了可以在web页面查看外，还可以通过命令操Yarn作。常用的命令有:查看任务列表、查看运行日志、查看尝试运行的任务、查看运行容器、查看节点状态、查看队列、更新队列配置等。</span><br></pre></td></tr></table></figure>

<h4 id="查看任务"><a href="#查看任务" class="headerlink" title="查看任务"></a>查看任务</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091605716.png" alt="image-20240909160518358"></p>
<h4 id="常看日志-查看容器"><a href="#常看日志-查看容器" class="headerlink" title="常看日志 查看容器"></a>常看日志 查看容器</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091607720.png" alt="image-20240909160700048"></p>
<h4 id="查看节点状态"><a href="#查看节点状态" class="headerlink" title="查看节点状态"></a>查看节点状态</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091610759.png" alt="image-20240909161028003"></p>
<h4 id="查看队列"><a href="#查看队列" class="headerlink" title="查看队列"></a>查看队列</h4><h4 id="更新配置"><a href="#更新配置" class="headerlink" title="更新配置"></a>更新配置</h4><h3 id="yarn工作原理"><a href="#yarn工作原理" class="headerlink" title="yarn工作原理"></a>yarn工作原理</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091627395.png" alt="image-20240909162745998"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409091628601.png" alt="image-20240909162853527"></p>
<h2 id="数仓建设保姆级教程"><a href="#数仓建设保姆级教程" class="headerlink" title="数仓建设保姆级教程"></a>数仓建设保姆级教程</h2><h3 id="数仓基本概念"><a href="#数仓基本概念" class="headerlink" title="数仓基本概念"></a>数仓基本概念</h3><h4 id="数据仓库架构"><a href="#数据仓库架构" class="headerlink" title="数据仓库架构"></a>数据仓库架构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这里参考此定义， 把数据仓库架构理解成构成数据仓库的组件及其之间的关系， 画</span><br><span class="line">出下面的数仓架构图</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409182259916.png" alt="image-20240918225911423"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在数据仓库技术演化过程中， 产生了几种主要的架构方法， 包括数据集市</span><br><span class="line">架构、 Inmon 企业信息工厂架构、 Kimball 数据仓库架构、 混合型数据仓库架构。</span><br><span class="line">这几种架构我们后面再讲， 接下来看下数仓的基本概念。</span><br></pre></td></tr></table></figure>





<h4 id="数据仓库概念"><a href="#数据仓库概念" class="headerlink" title="数据仓库概念"></a>数据仓库概念</h4><h5 id="基本特征"><a href="#基本特征" class="headerlink" title="基本特征"></a>基本特征</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">数据仓库是面向主题的、 集成的、 非易失的和时变的数据集合， 用以支持管理决</span><br><span class="line">策。</span><br></pre></td></tr></table></figure>

<h6 id="面向主题"><a href="#面向主题" class="headerlink" title="面向主题"></a>面向主题</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">传统数据库中， 最大的特点是面向应用进行数据的组织， 各个业务系统可能是相</span><br><span class="line">互分离的。 而数据仓库则是面向主题的。 主题是一个抽象的概念， 是较高层次上</span><br><span class="line">企业信息系统中的数据综合、 归类并进行分析利用的抽象。 在逻辑意义上， 它是</span><br><span class="line">对应企业中某一宏观分析领域所涉及的分析对象。</span><br></pre></td></tr></table></figure>



<h6 id="集成的"><a href="#集成的" class="headerlink" title="集成的"></a>集成的</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过对分散、 独立、 异构的数据库数据进行抽取、 清理、 转换和汇总便得到了数据仓库的数据， 这样保证了数据仓库内的数据关于整个企业的一致性。</span><br><span class="line">数据仓库中的综合数据不能从原有的数据库系统直接得到。 因此在数据进入数据仓库之前， 必然要经过统一与综合， 这一步是数据仓库建设中最关键、 最复杂的一步， 所要完成的工作有：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">要统一源数据中所有矛盾之处， 如字段的同名异义、 异名同义、 单位不统</span><br><span class="line">一、 字长不一致， 等等。</span><br><span class="line"> 进行数据综合和计算。 数据仓库中的数据综合工作可以在从原有数据库抽</span><br><span class="line">取数据时生成， 但许多是在数据仓库内部生成的， 即进入数据仓库以后进</span><br><span class="line">行综合生成的</span><br></pre></td></tr></table></figure>

<h6 id="非易失性"><a href="#非易失性" class="headerlink" title="非易失性"></a>非易失性</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数据非易失性主要是针对应用而言。 数据仓库的用户对数据的操作大多是数据查</span><br><span class="line">询或比较复杂的挖掘， 一旦数据进入数据仓库以后， 一般情况下被较长时间保留。</span><br><span class="line">数据仓库中一般有大量的查询操作， 但修改和删除操作很少。 因此， 数据经加工</span><br><span class="line">和集成进入数据仓库后是极少更新的， 通常只需要定期的加载和更新。</span><br></pre></td></tr></table></figure>

<h6 id="时变性"><a href="#时变性" class="headerlink" title="时变性"></a>时变性</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数据仓库包含各种粒度的历史数据。 数据仓库中的数据可能与某个特定日期、 星</span><br><span class="line">期、 月份、 季度或者年份有关。 数据仓库的目的是通过分析企业过去一段时间业</span><br><span class="line">务的经营状况， 挖掘其中隐藏的模式。 虽然数据仓库的用户不能修改数据， 但并</span><br><span class="line">不是说数据仓库的数据是永远不变的。 分析的结果只能反映过去的情况， 当业务变化后， 挖掘出的模式会失去时效性。 因此数据仓库的数据需要更新， 以适应决策的需要。 从这个角度讲， 数据仓库建设是一个项目， 更是一个过程。 数据仓库的数据随时间的变化表现在以下几个方面：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1） 数据仓库的数据时限一般要远远长于操作型数据的数据时限。</span><br><span class="line">（2） 操作型系统存储的是当前数据， 而数据仓库中的数据是历史数据。</span><br><span class="line">（3） 数据仓库中的数据是按照时间顺序追加的， 它们都带有时间属性。</span><br></pre></td></tr></table></figure>

<h5 id="为什么要有数据仓库"><a href="#为什么要有数据仓库" class="headerlink" title="为什么要有数据仓库"></a>为什么要有数据仓库</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">先来看下数据仓库的数据从哪里来， 最终要到哪里去？</span><br><span class="line">通常数据仓库的数据来自各个业务应用系统。 业务系统中的数据形式多种多样，</span><br><span class="line">可能是 Oracle、 MySQL、 SQL Server 等关系数据库里的结构化数据， 可能是文</span><br><span class="line">本、 CSV 等平面文件或 Word、 Excel 文档中的数据， 还可能是 HTML、 XML 等自描</span><br><span class="line">述的半结构化数据。 这些业务数据经过一系列的数据抽取、 转换、 清洗， 最终以</span><br><span class="line">一种统一的格式装载进数据仓库。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这时我们就想了， 为什么不能把业务系统的数据直接拿来供即席查询、 分析系统、报表系统等使用呢， 为什么要经过数据仓库这一步？ 实际上在数仓出现之前， 确实是这么做的， 但是有很多数据分析的先驱者当时已经发现， 简单的“ 直接访问”</span><br><span class="line">方式很难良好工作， 这样做的失败案例数不胜数。 下面列举一些直接访问业务系统无法工作的原因：</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">某些业务数据由于安全或其他因素不能直接访问。</span><br><span class="line"> 业务系统的版本变更很频繁， 每次变更都需要重写分析系统并重新测试。</span><br><span class="line"> 很难建立和维护汇总数据来源于多个业务系统版本的报表。</span><br><span class="line"> 业务系统的列名通常是硬编码， 有时仅仅是无意义的字符串， 这让编写分</span><br><span class="line">析系统更加困难。</span><br><span class="line"> 业务系统的数据格式， 如日期、 数字的格式不统一。</span><br><span class="line"> 业务系统的表结构为事务处理性能而优化， 有时并不适合查询与分析。</span><br><span class="line"> 没有适当的方式将有价值的数据合并进特定应用的数据库。</span><br><span class="line"> 没有适当的位置存储元数据。</span><br><span class="line"> 用户需要看到的显示数据字段， 有时在数据库中并不存在。</span><br><span class="line"> 通常事务处理的优先级比分析系统高， 所以如果分析系统和事务处理运行</span><br><span class="line">在同一硬件之上， 分析系统往往性能很差。</span><br><span class="line"> 有误用业务数据的风险。</span><br><span class="line"> 极有可能影响业务系统的性能。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">尽管需要增加软硬件的投入， 但建立独立数据仓库与直接访问业务数据相比， 无论是成本还是带来的好处， 这样做都是值得的。 随着处理器和存储成本的逐年降低，数据仓库方案的优势更加明显， 在经济上也更具可行性。</span><br></pre></td></tr></table></figure>

<h5 id="数据仓库与数据库的区别"><a href="#数据仓库与数据库的区别" class="headerlink" title="数据仓库与数据库的区别"></a>数据仓库与数据库的区别</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库与数据仓库的区别实际讲的是 OLTP 与 OLAP 的区别。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">操作型处理， 联机事务处理 OLTP（On-Line Transaction Processing， ） ，</span><br><span class="line">也可以称面向交易的处理系统， 它是针对具体业务在数据库联机的日常操作， 通</span><br><span class="line">常对少数记录进行查询、 修改。</span><br></pre></td></tr></table></figure>

<p><strong>用户较为关心操作的响应时间、 数据的安全性、完整性和并发支持的用户数等问题。 传统的数据库系统作为数据管理的主要手段，主要用于操作型处理， 像 Mysql， Oracle 等关系型数据库一般属于 OLTP。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分析型处理， 叫联机分析处理 OLAP（On-Line Analytical Processing） 一般针</span><br><span class="line">对某些主题的历史数据进行分析， 支持管理决策。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首先要明白， 数据仓库的出现， 并不是要取代数据库。 数据库是面向事务的设计，数据仓库是面向主题设计的。 数据库一般存储业务数据， 数据仓库存储的一般是历史数据。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数据库设计是尽量避免冗余， 一般针对某一业务应用进行设计， 比如一张简单的</span><br><span class="line">User 表， 记录用户名、 密码等简单数据即可， 符合业务应用， 但是不符合分析。</span><br><span class="line">数据仓库在设计是有意引入冗余， 依照分析需求， 分析维度、 分析指标进行设计。</span><br><span class="line">数据库是为捕获数据而设计， 数据仓库是为分析数据而设计。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">以银行业务为例。 数据库是事务系统的数据平台， 客户在银行做的每笔交易都会</span><br><span class="line">写入数据库， 被记录下来， 这里， 可以简单地理解为用数据库记账。 数据仓库是</span><br><span class="line">分析系统的数据平台， 它从事务系统获取数据， 并做汇总、 加工， 为决策者提供</span><br><span class="line">决策的依据。 比如， 某银行某分行一个月发生多少交易， 该分行当前存款余额是</span><br><span class="line">多少。 如果存款又多， 消费交易又多， 那么该地区就有必要设立 ATM 了。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">显然， 银行的交易量是巨大的， 通常以百万甚至千万次来计算。 事务系统是实时</span><br><span class="line">的， 这就要求时效性， 客户存一笔钱需要几十秒是无法忍受的， 这就要求数据库</span><br><span class="line">只能存储很短一段时间的数据。 而分析系统是事后的， 它要提供关注时间段内所</span><br><span class="line">有的有效数据。 这些数据是海量的， 汇总计算起来也要慢一些， 但是， 只要能够</span><br><span class="line">提供有效的分析数据就达到目的了。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据仓库， 是在数据库已经大量存在的情况下， 为了进一步挖掘数据资源、 为了决策需要而产生的， 它决不是所谓的“大型数据库” 。</span><br></pre></td></tr></table></figure>

<h5 id="数据仓库分层架构"><a href="#数据仓库分层架构" class="headerlink" title="数据仓库分层架构"></a>数据仓库分层架构</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">按照数据流入流出的过程， 数据仓库架构可分为： 源数据、 数据仓库、 数据应用</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409182340438.png" alt="image-20240918234014907"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">数据仓库的数据来源于不同的源数据， 并提供多样的数据应用， 数据自下而上流入数据仓库后向上层开放应用， 而数据仓库只是中间集成化数据管理的一个平台。</span><br><span class="line"></span><br><span class="line">源数据： 此层数据无任何更改， 直接沿用外围系统数据结构和数据， 不对外开放；为临时存储层， 是接口数据的临时存储区域， 为后一步的数据处理做准备。</span><br><span class="line"></span><br><span class="line">数据仓库： 也称为细节层， DW 层的数据应该是一致的、 准确的、 干净的数据， 即对源系统数据进行了清洗（去除了杂质） 后的数据。</span><br><span class="line"></span><br><span class="line">数据应用： 前端应用直接读取的数据源； 根据报表、 专题分析需求而计算生成的数据。</span><br></pre></td></tr></table></figure>

<p><strong>数据仓库从各数据源获取数据及在数据仓库内的数据转换和流动都可以认为是ETL（抽取 Extra, 转化 Transfer, 装载 Load） 的过程， ETL 是数据仓库的流水线，也可以认为是数据仓库的血液， 它维系着数据仓库中数据的新陈代谢， 而数据仓库日常的管理和维护工作的大部分精力就是保持 ETL 的正常和稳定。</strong></p>
<hr>
<p> **那 么 为 什 么 要 数 据 仓 库 进 行 分 层 呢 ? **</p>
<p>1.用空间换时间， 通过大量的预处理来提升应用系统的用户体验（效率） ，因此数据仓库会存在大量冗余的数据； 不分层的话， 如果源业务系统的业务规则发生变化将会影响整个数据清洗过程， 工作量巨大。</p>
<p>2.通过数据分层管理可以简化数据清洗的过程， 因为把原来一步的工作分到了多个步骤去完成， 相当于把一个复杂的工作拆成了多个简单的工作， 把一个大的黑盒变成了一个白盒， 每一层的处理逻辑都相对简单和容易理解，  这样我们比较容易保证每一个步骤的正确性， 当数据发生错误的时候， 往往我们只需要局部调整某个步骤即可。  </p>
<h5 id="主要数据仓库架构"><a href="#主要数据仓库架构" class="headerlink" title="主要数据仓库架构"></a>主要数据仓库架构</h5><p>通过上面的内容我们大概了解数仓的概念， 接下来就看下数仓的几种演进架构。  </p>
<h6 id="数据集市架构"><a href="#数据集市架构" class="headerlink" title="数据集市架构"></a>数据集市架构</h6><p>数据集市是按主题域组织的数据集合， 用于支持部门级的决策。 有两种类型的数据集市： 独立数据集市和从属数据集市  </p>
<p>**独立数据集市  **</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">独立数据集市集中于部门所关心的单一主题域，数据以部门为基础部署，无须考虑企业级别的信息共享与集成。例如，制造部门、人力资源部门和其他部门都各自有他们自己的数据集市。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190014714.png" alt="image-20240919001456486"></p>
<p><strong>优点</strong>： 因为一个部门的业务相对于整个企业要简单， 数据量也小得多， 所以部门的独立数据集市具有周期短、 见效快的特点。  </p>
<p><strong>缺点</strong>：<br>1.从业务角度看， 当部门的分析需求扩展， 或者需要分析跨部门或跨主题域的数据时， 独立数据市场会显得力不从心。<br>2.当数据存在歧义， 比如同一个产品， 在 A 部门和 B 部门的定义不同时， 将无法在部门间进行信息比较。<br>3.每个部门使用不同的技术， 建立不同的 ETL 的过程， 处理不同的事务系统，而在多个独立的数据集市之间还会存在数据的交叉与重叠， 甚至会有数据不一致的情况。  </p>
<p>**从属数据集市  **</p>
<p>从属数据集市的数据来源于数据仓库。 数据仓库里的数据经过整合、 重构、 汇总后传递给从属数据集市。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190019329.png" alt="image-20240919001936122"></p>
<p><strong>建立从属数据集市的好处主要有</strong>：  </p>
<p><strong>性能</strong>： 当数据仓库的查询性能出现问题， 可以考虑建立几个从属数据集市，将查询从数据仓库移出到数据集市。<br><strong>安全</strong>： 每个部门可以完全控制他们自己的数据。<br><strong>数据一致</strong>： 因为每个数据集市的数据来源都是同一个数据仓库， 有效消除了数据不一致的情况。  </p>
<h6 id="Inmon-企业工厂架构"><a href="#Inmon-企业工厂架构" class="headerlink" title="Inmon 企业工厂架构"></a>Inmon 企业工厂架构</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190021133.png" alt="image-20240919002134590"></p>
<p>上图的前两步不过多介绍， 直接从第三步开始。<br><strong>企业级数据仓库</strong>： 是该架构中的核心组件。 正如 Inmon 数据仓库所定义的， 企业级数据仓库是一个细节数据的集成资源库。 其中的数据以最低粒度级别被捕获，存储在满足三范式设计的关系数据库中。<br><strong>部门级数据集市</strong>： 是面向主题数据的部门级视图， 数据从企业级数据仓库获取。数据在进入部门数据集市时可能进行聚合。 数据集市使用多维模型设计， 用于数据分析。 重要的一点是， 所有的报表工具、 BI 工具或其他数据分析应用都从数据集市查询数据， 而不是直接查询企业级数据仓库。  </p>
<h6 id="Kimball-数据仓库架构"><a href="#Kimball-数据仓库架构" class="headerlink" title="Kimball 数据仓库架构"></a>Kimball 数据仓库架构</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190041680.png" alt="image-20240919004146397"></p>
<p>对比上一张图可以看到， Kimball 与 Inmon 两种架构的主要区别在于核心数据仓库的设计和建立。</p>
<p>Kimball 的数据仓库包含高粒度的企业数据， 使用多维模型设计， 这也<strong>意味着数据仓库由星型模式的维度表和事实表构成</strong>。 分析系统或报表工具可以直接访问多维数据仓库里的数据。<br>在此架构中的数据集市也与 Inmon 中的不同。 这里的<strong>数据集市是一个逻辑概念，只是多维数据仓库中的主题域划分</strong>， 并没有自己的物理存储， 也可以说是虚拟的数据集市。  </p>
<h6 id="混合型数据仓库架构"><a href="#混合型数据仓库架构" class="headerlink" title="混合型数据仓库架构"></a>混合型数据仓库架构</h6><p>所谓的混合型结构， 指的是在一个数据仓库环境中， 联合使用 Inmon 和 Kimball两种架构。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190045026.png" alt="image-20240919004511671"></p>
<p>从架构图可以看到， 这种架构将 Inmon 方法中的数据集市部分替换成了一个多维数据仓库， 而数据集市则是多维数据仓库上的逻辑视图。<br><strong>使用这种架构的好处是</strong>： 既可以利用规范化设计消除数据冗余， 保证数据的粒度足够细； 又可以利用多维结构更灵活地在企业级实现报表和分析  </p>
<h5 id="数据仓库元数据的管理"><a href="#数据仓库元数据的管理" class="headerlink" title="数据仓库元数据的管理"></a>数据仓库元数据的管理</h5><p><strong>元数据（Meta Date），主要记录数据仓库中模型的定义、 各层级间的映射关系、监控数据仓库的数据状态及 ETL 的任务运行状态。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一般会通过元数据资料库（ Metadata Repository） 来统一地存储和管理元数据， 其主要目的是使数据仓库的设计、 部署、 操作和管理能达成协同和一致。</span><br></pre></td></tr></table></figure>

<p><strong>元数据是数据仓库管理系统的重要组成部分</strong>， 元数据管理贯穿数据仓库构建的整个过程， 直接影响着数据仓库的构建、使用和维护。</p>
<ol>
<li><p>构建数据仓库的主要步骤之一是 ETL。 这时元数据将发挥重要的作用， 它定义了源数据系统到数据仓库的映射、 数据转换的规则、 数据仓库的逻辑结构、 数据更新的规则、 数据导入历史记录以及装载周期等相关内容。 数据抽取和转换的专家以及数据仓库管理员正是通过元数据高效地构建数据仓库。</p>
</li>
<li><p>用户在使用数据仓库时， 通过元数据访问数据， 明确数据项的含义以及定制报表。</p>
</li>
<li><p>数据仓库的规模及其复杂性离不开正确的元数据管理， 包括增加或移除外部数据源， 改变数据清洗方法， 控制出错的查询以及安排备份等。</p>
</li>
</ol>
<p>元数据可分为<strong>技术元数据</strong>和<strong>业务元数据</strong>。 </p>
<p><strong>技术元数据</strong>为开发和管理数据仓库的 IT人员使用， 它描述了与数据仓库开发、 管理和维护相关的数据， 包括数据源信息、数据转换描述、 数据仓库模型、 数据清洗与更新规则、 数据映射和访问权限等。</p>
<p>而<strong>业务元数据</strong>为管理层和业务分析人员服务， 从业务角度描述数据， 包括商务术语、 数据仓库中有什么数据、 数据的位置和数据的可用性等， 帮助业务人员更好地理解数据仓库中哪些数据是可用的以及如何使用。</p>
<p>由上可见， 元数据不仅定义了数据仓库中数据的模式、 来源、 抽取和转换规则等，而且是整个数据仓库系统运行的基础， <strong>元数据把数据仓库系统中各个松散的组件联系起来， 组成了一个有机的整体</strong></p>
<h5 id="数仓常见术语解析"><a href="#数仓常见术语解析" class="headerlink" title="数仓常见术语解析"></a>数仓常见术语解析</h5><p><strong>数仓名词解释</strong>  </p>
<p><strong>实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">实体是指依附的主体， 就是我们分析的一个对象， 比如我们分析商品的销售情况，如华为手机近半年的销售量是多少， 那华为手机就是一个实体； 我们分析用户的活跃度， 用户就是一个实体。 当然实体也可以现实中不存在的， 比如虚拟的业务对象， 活动， 会员等都可看做一个实体。</span><br></pre></td></tr></table></figure>

<p><strong>维度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">维度就是看待问题的角度， 分析业务数据， 从什么角度分析， 就建立什么样的维度。比如你要分析产品销售情况， 你可以选择按商品类别来进行分析， 这就构成一个维度， 把所有商品类别集合在一起， 就构成了维度表。</span><br></pre></td></tr></table></figure>

<p><strong>度量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">度量是业务流程节点上的一个数值。 比如销量， 价格， 成本等等。</span><br><span class="line">事实表中的度量可分为三类： 完全可加， 半可加， 不可加。</span><br><span class="line">1. 完全可加的度量是最灵活， 最有用的， 比如说销量， 销售额等， 可进行任</span><br><span class="line">意维度汇总；</span><br><span class="line">2. 半可加的度量可以对某些维度汇总， 但不能对所有维度汇总， 差额是常见</span><br><span class="line">的半可加度量， 它除了时间维度外， 可以跨所有维度进行加法操作；</span><br><span class="line">3. 还有一种是完全不可加的， 例如： 比率。 对于这类非可加度量，一种好的方法是， 尽可能存储非可加度量的完全可加分量， 并在计算出最终的非可加事实前， 将这些分量汇总到最终的结果集中。</span><br></pre></td></tr></table></figure>

<p><strong>粒度</strong></p>
<p><strong>口径</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">口径就是取数逻辑（ 如何取数的） ， 比如要取的数是 10 岁以下儿童中男孩的平均身高， 这就是统计的口径。</span><br></pre></td></tr></table></figure>



<p><strong>指标</strong></p>
<p><strong>标签</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">标签是人为设定的、 根据业务场景需求， 对目标对象运用一定的算法得到的高度</span><br><span class="line">精炼的特征标识。 可见标签是经过人为再加工后的结果， 如网红、 白富美、 萝莉。</span><br><span class="line">对于有歧义的标签， 我们内部可进行标签区分， 比如： 苹果， 我们可以定义苹果</span><br><span class="line">指的是水果， 苹果手机才指的是手机</span><br></pre></td></tr></table></figure>



<p><strong>自然键</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">由现实中已经存在的属性组成的键， 它在业务概念中是唯一的， 并具有一定的业</span><br><span class="line">务含义， 比如商品 ID， 员工 ID。</span><br><span class="line">以数仓角度看， 来自于业务系统的标识符就是自然键， 比如业务库中员工的编号。</span><br></pre></td></tr></table></figure>

<p><strong>持久键</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">保持永久性不会发生变化。 有时也被叫做超自然持久键。 比如身份证号属于持久</span><br><span class="line">键。</span><br><span class="line">自然键和持久键区别： 举个例子就明白了， 比如说公司员工离职之后又重新入职，</span><br><span class="line">他的自然键也就是员工编号发生了变化， 但是他的持久键身份证号是不变的。</span><br></pre></td></tr></table></figure>

<p><strong>代理键</strong></p>
<p><strong>退化维度</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">退化维度， 就是那些看起来像是事实表的一个维度关键字， 但实际上并没有对应的</span><br><span class="line">维度表， 就是维度属性存储到事实表中， 这种存储到事实表中的维度列被称为退</span><br><span class="line">化维度。 与其他存储在维表中的维度一样， 退化维度也可以用来进行事实表的过</span><br><span class="line">滤查询、 实现聚合操作等。</span><br><span class="line">那么究竟怎么定义退化维度呢？ 比如说订单 id， 这种量级很大的维度， 没必要</span><br><span class="line">用一张维度表来进行存储， 而我们进行数据查询或者数据过滤的时候又非常需要，</span><br><span class="line">所以这种就冗余在事实表里面， 这种就叫退化维度， citycode 这种我们也会冗</span><br><span class="line">余在事实表里面， 但是它有对应的维度表， 所以它不是退化维度。</span><br></pre></td></tr></table></figure>

<p><strong>下钻</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是在数据分析中常见的概念， 下钻可以理解成增加维的层次， 从而可以由粗粒</span><br><span class="line">度到细粒度来观察数据， 比如对产品销售情况分析时， 可以沿着时间维从年到月</span><br><span class="line">到日更细粒度的观察数据。 从年的维度可以下钻到月的维度、 日的维度等。</span><br></pre></td></tr></table></figure>



<p><strong>上卷</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">知道了下钻， 上卷就容易理解了， 它俩是相逆的操作， 所以上卷可以理解为删掉</span><br><span class="line">维的某些层， 由细粒度到粗粒度观察数据的操作或沿着维的层次向上聚合汇总数</span><br><span class="line">据。</span><br></pre></td></tr></table></figure>

<h5 id="数据集市"><a href="#数据集市" class="headerlink" title="数据集市"></a>数据集市</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数据集市（Data Mart） ， 也叫数据市场， 数据集市就是满足特定的部门或者用</span><br><span class="line">户的需求， 按照多维的方式进行存储， 包括定义维度、 需要计算的指标、 维度的</span><br><span class="line">层次等， 生成面向决策分析需求的数据立方体。 其实就是从数据仓库中抽取出来</span><br><span class="line">的一个小合集。</span><br></pre></td></tr></table></figure>

<h6 id="数仓名词之间关系"><a href="#数仓名词之间关系" class="headerlink" title="数仓名词之间关系"></a>数仓名词之间关系</h6><p><strong>实体表， 事实表， 维度表之间的关系</strong>  </p>
<p><strong>数据集市和数据仓库的关系</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数据集市是企业级数据仓库的一个子集， 他主要面向部门级业务， 并且只面向某</span><br><span class="line">个特定的主题。 为了解决灵活性和性能之间的矛盾， 数据集市就是数据仓库体系</span><br><span class="line">结构中增加的一种小型的部门或工作组级别的数据仓库。 数据集市存储为特定用</span><br><span class="line">户预先计算好的数据， 从而满足用户对性能的需求。 数据集市可以在一定程度上</span><br><span class="line">缓解访问数据仓库的瓶颈。</span><br><span class="line">数据集市和数据仓库的主要区别： 数据仓库是企业级的， 能为整个企业各个部门</span><br><span class="line">的运行提供决策支持手段； 而数据集市则是一种微型的数据仓库,它通常有更少</span><br><span class="line">的数据,更少的主题区域,以及更少的历史数据,因此是部门级的， 一般只能为某</span><br><span class="line">个局部范围内的管理人员服务， 因此也称之为部门级数据仓库。</span><br></pre></td></tr></table></figure>

<h3 id="离线数仓建设核心"><a href="#离线数仓建设核心" class="headerlink" title="离线数仓建设核心"></a>离线数仓建设核心</h3><p><strong>数据仓库的核心是展现层和提供优质的服务。 ETL 及其规范、 分层等所做的一切都是为了一个更清晰易用的展现层。</strong></p>
<h4 id="数仓分层"><a href="#数仓分层" class="headerlink" title="数仓分层"></a>数仓分层</h4><p><strong>数仓分层的原则</strong>：</p>
<ol>
<li><p>为便于数据分析， 要屏蔽底层复杂业务， 简单、 完整、 集成的将数据暴露给分析层。</p>
</li>
<li><p>底层业务变动与上层需求变动对模型冲击最小化， 业务系统变化影响削弱在基础数据层， 结合自上而下的建设方法削弱需求变动对模型的影响。</p>
</li>
<li><p>高内聚松耦合， 即主题之内或各个完整意义的系统内数据的高内聚， 主题之间或各个完整意义的系统间数据的松耦合。</p>
</li>
<li><p>构建仓库基础数据层， 使底层业务数据整合工作与上层应用开发工作相隔离， 为仓库大规模开发奠定基础 仓库层次更加清晰， 对外暴露数据更加统一。</p>
</li>
</ol>
<p>一般采用如下分层结构 ：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409190100571.png" alt="image-20240919010022086"></p>
<h5 id="数据源层：-ODS（-Operational-Data-Store）"><a href="#数据源层：-ODS（-Operational-Data-Store）" class="headerlink" title="数据源层： ODS（ Operational Data Store）"></a>数据源层： ODS（ Operational Data Store）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ODS 层， 是最接近数据源中数据的一层， 为了考虑后续可能需要追溯数据问题，</span><br><span class="line">因此对于这一层就不建议做过多的数据清洗工作， 原封不动地接入原始数据即可，</span><br><span class="line">至于数据的去噪、 去重、 异常值处理等过程可以放在后面的 DWD 层来做。</span><br></pre></td></tr></table></figure>



<h5 id="数据仓库层：-DW（-Data-Warehouse）"><a href="#数据仓库层：-DW（-Data-Warehouse）" class="headerlink" title="数据仓库层： DW（ Data Warehouse）"></a>数据仓库层： DW（ Data Warehouse）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">数据仓库层是我们在做数据仓库时要核心设计的一层， 在这里， 从 ODS 层中获</span><br><span class="line">得的数据按照主题建立各种数据模型。</span><br><span class="line">DW 层又细分为 DWD（ Data Warehouse Detail） 层、 DWM（ Data WareHouse Middle）</span><br><span class="line">层和 DWS（ Data WareHouse Servce） 层。</span><br></pre></td></tr></table></figure>



<h6 id="数据明细层：-DWD（-Data-Warehouse-Detail）"><a href="#数据明细层：-DWD（-Data-Warehouse-Detail）" class="headerlink" title="数据明细层： DWD（ Data Warehouse Detail）"></a>数据明细层： DWD（ Data Warehouse Detail）</h6><p>该层一般保持和 ODS 层一样的数据粒度， 并且提供一定的数据质量保证。 DWD 层要做的就是将<strong>数据清理、 整合、 规范化、 脏数据、 垃圾数据、 规范不一致的、 状态定义不一致的、 命名不规范的数据都会被处理。</strong><br>同时， 为了提高数据明细层的易用性， <strong>该层会采用一些维度退化手法， 将维度退化至事实表中， 减少事实表和维表的关联</strong>。<br>另外， 在该层也会做一部分的<strong>数据聚合</strong>， 将相同主题的数据汇集到一张表中， 提高数据的可用性</p>
<h6 id="数据中间层：-DWM（-Data-WareHouse-Middle）"><a href="#数据中间层：-DWM（-Data-WareHouse-Middle）" class="headerlink" title="数据中间层： DWM（ Data WareHouse Middle）"></a>数据中间层： DWM（ Data WareHouse Middle）</h6><p>该层会在 DWD 层的数据基础上， 数据做轻度的聚合操作， 生成一系列的中间表，提升公共指标的复用性， 减少重复加工。<br>直观来讲， <strong>就是对通用的核心维度进行聚合操作， 算出相应的统计指标。</strong><br>在实际计算中， 如果直接从 DWD 或者 ODS 计算出宽表的统计指标， 会存在计算量太大并且维度太少的问题， 因此一般的做法是， 在 DWM 层先计算出多个小的中间表， 然后再拼接成一张 DWS 的宽表。 由于宽和窄的界限不易界定， 也可以去掉 DWM 这一层， 只留 DWS 层， 将所有的数据再放在 DWS 亦可。</p>
<h6 id="数据服务层：-DWS（-Data-WareHouse-Servce）"><a href="#数据服务层：-DWS（-Data-WareHouse-Servce）" class="headerlink" title="数据服务层： DWS（ Data WareHouse Servce）"></a>数据服务层： DWS（ Data WareHouse Servce）</h6><p>DWS 层为公共汇总层， 会进行轻度汇总， 粒度比明细数据稍粗， 基于 DWD 层上的基础数据， <strong>整合汇总成分析某一个主题域的服务数据， 一般是宽表。</strong> DWS 层应覆盖 80% 的应用场景。 又称数据集市或宽表。<br>按照业务划分， 如主题域流量、 订单、 用户等， 生成字段比较多的宽表， 用于提供后续的业务查询， OLAP 分析， 数据分发等。<br>一般来讲， 该层的数据表会相对比较少， 一张表会涵盖比较多的业务内容， 由于其字段较多， 因此一般也会称该层的表为宽表。</p>
<h5 id="数据应用层：-APP（Application）"><a href="#数据应用层：-APP（Application）" class="headerlink" title="数据应用层： APP（Application）"></a>数据应用层： APP（Application）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在这里， 主要是提供给数据产品和数据分析使用的数据， 一般会存放在 ES、PostgreSql、 Redis 等系统中供线上系统使用， 也可能会存在 Hive 或者 Druid中供数据分析和数据挖掘使用。 比如我们经常说的报表数据， 一般就放在这里。</span><br></pre></td></tr></table></figure>



<h5 id="维表层：-DIM（Dimension）"><a href="#维表层：-DIM（Dimension）" class="headerlink" title="维表层： DIM（Dimension）"></a>维表层： DIM（Dimension）</h5><p>如果维表过多， 也可针对维表设计单独一层， 维表层主要包含两部分数据：<br><strong>高基数维度数据</strong>： 一般是用户资料表、 商品资料表类似的资料表。 数据量可能是千万级或者上亿级别。<br><strong>低基数维度数据</strong>： 一般是配置表， 比如枚举值对应的中文含义， 或者日期维表。数据量可能是个位数或者几千几万。</p>
<h4 id="数仓建模方法"><a href="#数仓建模方法" class="headerlink" title="数仓建模方法"></a>数仓建模方法</h4><p>那数仓建模怎么建呢？ 其实数据仓库的建模方法有很多种， 每一种建模方法代表了哲学上的一个观点， 代表了一种归纳、 概括世界的一种方法。 <strong>常见的有范式建模法、维度建模法、实体建模法</strong>等， 每种方法从本质上将是从不同的角度看待业务中的问题。  </p>
<h5 id="范式建模法（Third-Normal-Form，-3NF）"><a href="#范式建模法（Third-Normal-Form，-3NF）" class="headerlink" title="范式建模法（Third Normal Form， 3NF）"></a>范式建模法（Third Normal Form， 3NF）</h5><p><strong>主要解决关系型数据库的数据存储</strong>， 利用的一种技术层面上的方法。 目<br>前， 我们在关系型数据库中的建模方法， 大部分采用的是三范式建模法。<br>范式是符合某一种级别的关系模式的集合。 构造数据库必须遵循一定的规则，而在关系型数据库中这种规则就是范式， 这一过程也被称为规范化。 <strong>目前关系数据库有六种范式： 第一范式（1NF） 、第二范式（2NF）、第三范式（3NF） 、Boyce-Codd范式（BCNF）、第四范式（4NF）和第五范式（5NF） 。</strong>  </p>
<p><strong>在数据仓库的模型设计中， 一般采用第三范式</strong>。 一个符合第三范式的关系必须具有以下三个条件 :</p>
<ol>
<li>每个属性值唯一， 不具有多义性 ;</li>
<li>每个非主属性必须完全依赖于整个主键， 而非主键的一部分 ;</li>
<li>每个非主属性不能依赖于其他关系中的属性， 因为这样的话， 这种属性应该归到其他关系中去。</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191637873.jpg" alt="微信图片_20240919163629"></p>
<h6 id="第一范式"><a href="#第一范式" class="headerlink" title="第一范式"></a>第一范式</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191652642.jpg" alt="微信图片_20240919165202"></p>
<h6 id="第二范式"><a href="#第二范式" class="headerlink" title="第二范式"></a>第二范式</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191650664.jpg" alt="微信图片_20240919164925"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191650876.jpg" alt="微信图片_20240919164933"></p>
<h6 id="第三范式"><a href="#第三范式" class="headerlink" title="第三范式"></a>第三范式</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191650437.jpg" alt="微信图片_20240919164938"></p>
<h6 id="BC范式、第四范式，第五范式"><a href="#BC范式、第四范式，第五范式" class="headerlink" title="BC范式、第四范式，第五范式"></a>BC范式、第四范式，第五范式</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191659226.jpg" alt="微信图片_20240919165904"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191659901.jpg" alt="微信图片_20240919165909"></p>
<h5 id="维度建模法（Dimensional-Modeling）"><a href="#维度建模法（Dimensional-Modeling）" class="headerlink" title="维度建模法（Dimensional Modeling）"></a>维度建模法（Dimensional Modeling）</h5><p>维度建模以分析决策的需求出发构建模型， 构建的数据模型为分析需求服务， 因此它重点解决用户如何更快速完成分析需求， 同时还有较好的大规模复杂查询的响应性能。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191712941.png" alt="image-20240919171206712"></p>
<p>典型的代表是我们比较熟知的<strong>星形模型</strong>（Star-schema） ， 以及在一些特殊场景下适用的<strong>雪花模型</strong>（Snow-schema） 。<br>维度建模中比较重要的概念就是 <strong>事实表（</strong>Fact table） 和<strong>维度表</strong>（Dimension table） 。 其最简单的描述就是， 按照事实表、 维度表来构建数据仓库、 数据集市。  </p>
<h5 id="实体建模法（Entity-Modeling）"><a href="#实体建模法（Entity-Modeling）" class="headerlink" title="实体建模法（Entity Modeling）"></a>实体建模法（Entity Modeling）</h5><p>实体建模法并不是数据仓库建模中常见的一个方法， 它来源于哲学的一个流派。从哲学的意义上说， 客观世界应该是可以细分的， 客观世界应该可以分成由一个个实体， 以及实体与实体之间的关系组成。 那么我们在数据仓库的建模过程中完全可以引入这个抽象的方法， 将整个业务也可以划分成一个个的实体， 而每个实体之间的关系， 以及针对这些关系的说明就是我们数据建模需要做的工作。<br>虽然实体法粗看起来好像有一些抽象， 其实理解起来很容易。 即我们可以将任何一个业务过程划分成 3 个部分， <strong>实体， 事件， 说明</strong>， 如下图所示  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191716899.png" alt="image-20240919171615703"></p>
<p>上图表述的是一个抽象的含义， 如果我们描述一个简单的事实： “小明开车去学校上学” 。 以这个业务事实为例， 我们可以把“小明” ， “学校” 看成是一个实体， “上学” 描述的是一个业务过程， 我们在这里可以抽象为一个具体“事件” ，而“开车去” 则可以看成是事件“上学” 的一个说明。  </p>
<h5 id="维度建模详解"><a href="#维度建模详解" class="headerlink" title="维度建模详解"></a>维度建模详解</h5><p>目前在互联网公司最常用的建模方法就是维度建模， 我们将重点讲解！<br>维度建模是专门应用于分析型数据库、 数据仓库、 数据集市建模的方法。 数据集市可以理解为是一种”小型数据仓库”。  </p>
<h6 id="维度建模中表的类型"><a href="#维度建模中表的类型" class="headerlink" title="维度建模中表的类型"></a>维度建模中表的类型</h6><p>维度建模分为两种表： 事实表和维度表：</p>
<ol>
<li><p>事实表： 必然存在的一些数据， 像采集的日志文件， 订单表， 都可以作为事实表 。<br>特征： 是一堆主键的集合， 每个主键对应维度表中的一条记录， 客观存在的， 根据主题确定出需要使用的数据</p>
</li>
<li><p>维度表： 维度就是所分析的数据的一个量， 维度表就是以合适的角度来创建的表， 分析问题的一个角度： 时间、 地域、 终端、 用户等角度</p>
</li>
</ol>
<p>**事实表  **</p>
<p>发生在现实世界中的操作型事件， 其所产生的可度量数值， 存储在事实表中。 从最低的粒度级别来看， 事实表行对应一个度量事件， 反之亦然。  </p>
<p><strong>事实表表示对分析主题的度量</strong>。 比如一次购买行为我们就可以理解为是一个事实。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191939274.png" alt="image-20240919193909402"></p>
<p>图中的订单表就是一个事实表， 你可以理解他就是在现实中发生的一次操作型事件， 我们每完成一个订单， 就会在订单中增加一条记录。 事实表的特征： <strong>表里没有存放实际的内容， 他是一堆主键的集合， 这些 ID 分别能对应到维度表中的一条记录。</strong> 事实表包含了与各维度表相关联的外键， 可与维度表关联。 事实表的度量通常是数值类型， 且记录数会不断增加， 表数据规模迅速增长。  </p>
<p>**明细表（ 宽 表 ）   **</p>
<p>事实表的数据中， 有些属性共同组成了一个字段（糅合在一起） ， 比如年月日时分秒构成了时间,当需要根据某一属性进行分组统计的时候， 需要截取拼接之类的操作， 效率极低。 如：  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191945619.png" alt="image-20240919194557477"></p>
<p><strong>为了分析方便， 可以事实表中的一个字段切割提取多个属性出来构成新的字段， 因为字段变多了， 所以称为宽表， 原来的成为窄表。</strong>  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409191946976.png" alt="image-20240919194654598"></p>
<p>又因为宽表的信息更加清晰明细， 所以也可以称之为明细表。  </p>
<hr>
<p><strong>事实表种类</strong><br>事实表分为以下 6 类：</p>
<ol>
<li>事务事实表</li>
<li>周期快照事实表</li>
<li>累积快照事实表</li>
<li>无事实的事实表</li>
<li>聚集事实表</li>
<li>合并事实表</li>
</ol>
<p><strong>事务事实表</strong></p>
<p>表中的一行对应空间或时间上某点的度量事件。 就是一行数据中必须有度量字段，什么是度量， 就是指标， 比如说销售金额， 销售数量等这些可加的或者半可加就是度量值。 另一点就是事务事实表都包含一个与维度表关联的外键。 并且度量值必须和事务粒度保持一致。  </p>
<p><strong>周期快照事实表</strong></p>
<p>顾名思义， 周期事实表就是每行都带有时间值字段， 代表周期， 通常时间值都是标准周期， 如某一天， 某周， 某月等。 粒度是周期， 而不是个体的事务， 也就是说一个周期快照事实表中数据可以是多个事实， 但是它们都属于某个周期内。  </p>
<p><strong>累计快照事实表</strong>  </p>
<p>周期快照事实表是单个周期内数据， 而累计快照事实表是由多个周期数据组成，每行汇总了过程开始到结束之间的度量。 每行数据相当于管道或工作流， 有事件的起点， 过程， 终点， 并且每个关键步骤都包含日期字段。 如订单数据， 累计快照事实表的一行就是一个订单， 当订单产生时插入一行， 当订单发生变化时， 这行就被修改。  </p>
<p><strong>无事实的事实表</strong> </p>
<p><strong>聚集事实表</strong>  </p>
<p><strong>合并事实表</strong>  </p>
<p>**维度表  **</p>
<p>每个维度表都包含单一的主键列。 维度表的主键可以作为与之关联的任何事实表的外键， 当然， 维度表行的描述环境应与事实表行完全对应。 维度表通常比较宽，是扁平型非规范表， 包含大量的低粒度的文本属性。</p>
<p>维度表示你要对数据进行分析时所用的一个量， 比如你要分析产品销售情况， 你可以选择按类别来进行分析， 或按区域来分析。 每个类别就构成一个维度。 上图中的用户表、 商家表、 时间表这些都属于维度表， 这些表都有一个唯一的主键，然后在表中存放了详细的数据信息。</p>
<p>总的说来， 在数据仓库中不需要严格遵守规范化设计原则。 因为数据仓库的主导功能就是面向分析， 以查询为主， 不涉及数据更新操作。 <strong>事实表的设计是以能够正确记录历史信息为准则， 维度表的设计是以能够以合适的角度来聚合主题内容为准则。</strong>  </p>
<p><strong>维度表结构</strong></p>
<p>维度表谨记一条原则， 包含单一主键列， 但有时因业务复杂， 也可能出现联合主键， 请尽量避免， 如果无法避免， 也要确保必须是单一的， 这很重要， 如果维表主键不是单一， 和事实表关联时会出现数据发散， 导致最后结果可能出现错误。<br>维度表通常比较宽， 包含大量的低粒度的文本属性。  </p>
<p><strong>跨表钻取</strong>  </p>
<p>跨表钻取意思是当每个查询的行头都包含相同的一致性属性时， 使不同的查询能够针对两个或更多的事实表进行查询<br><strong>钻取可以改变维的层次， 变换分析的粒度。</strong> 它包括上钻&#x2F;下钻：<br><strong>上钻</strong>（roll-up）：上卷是沿着维的层次向上聚集汇总数据。 例如， 对产品销售数据， 沿着时间维上卷， 可以求出所有产品在所有地区每月（或季度或年或全部）的销售额。<br><strong>下钻</strong>（drill-down）：下钻是上钻的逆操作， 它是沿着维的层次向下， 查看更详细的数据。  </p>
<p><strong>退化维度</strong>  </p>
<p>退化维度就是将维度退回到事实表中。 因为有时维度除了主键没有其他内容， 虽然也是合法维度键， 但是一般都会退回到事实表中， 减少关联次数， 提高查询性能  </p>
<p><strong>多层次维度</strong>  </p>
<p>多数维度包含不止一个自然层次， 如日期维度可以从天的层次到周到月到年的层次。 <strong>所以在有些情况下， 在同一维度中存在不同的层次。</strong>  </p>
<p><strong>维度表空值属性</strong> </p>
<p>当给定维度行没有被全部填充时， 或者当存在属性没有被应用到所有维度行时，将产生空值维度属性。 上述两种情况， 推荐采用描述性字符串代替空值， 如使用unknown 或 not applicable 替换空值  </p>
<p><strong>日历日期维度</strong>   </p>
<p>在日期维度表中， 主键的设置不要使用顺序生成的 id 来表示， 可以使用更有意义的数据表示， 比如将年月日合并起来表示， 即 YYYYMMDD， 或者更加详细的精度  </p>
<h6 id="维度建模三种模式"><a href="#维度建模三种模式" class="headerlink" title="维度建模三种模式"></a>维度建模三种模式</h6><p>**星型模式  **</p>
<p>星形模式(Star Schema)是最常用的维度建模方式。 星型模式是以事实表为中心，所有的维度表直接连接在事实表上， 像星星一样。 星形模式的维度建模由一个事实表和一组维表成， 且具有以下特点： a. 维表只和事实表关联， 维表之间没有关联； b. 每个维表主键为单列， 且该主键放置在事实表中， 作为两边连接的外键； c. 以事实表为核心， 维表围绕核心呈星形分布；  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409192013327.png" alt="image-20240919201327181"></p>
<p>**雪花模式  **</p>
<p>雪花模式(Snowflake Schema)是对星形模式的扩展。 雪花模式的维度表可以拥有其他维度表的， 虽然这种模型相比星型更规范一些， 但是由于这种模型不太容易理解， 维护成本比较高， 而且性能方面需要关联多层维表， 性能也比星型模型要低。 所以一般不是很常用  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409192018892.png" alt="image-20240919201800156"></p>
<p>**星座模式  **</p>
<p>星座模式是星型模式延伸而来， 星型模式是基于一张事实表的， 而<strong>星座模式是基于多张事实表的， 而且共享维度信息</strong>。 前面介绍的两种维度建模方法都是多维表对应单事实表， 但在很多时候维度空间内的事实表不止一个， 而一个维表也可能被多个事实表用到。 <strong>在业务发展后期， 绝大部分维度建模都采用的是星座模式。</strong>  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409192020354.png" alt="image-20240919202038192"></p>
<h6 id="维度建模过程"><a href="#维度建模过程" class="headerlink" title="维度建模过程"></a>维度建模过程</h6><p>我们知道维度建模的表类型有事实表， 维度表； 模式有星形模型， 雪花模型， 星座模型这些概念了， 但是实际业务中， 给了我们一堆数据， 我们怎么拿这些数据进行数仓建设呢， 数仓工具箱作者根据自身 60 多年的实际业务经验， 给我们总结了如下四步， 请务必记住！  </p>
<p><strong>数 仓 工 具 箱 中 的 维 度 建 模 四 步 走 ：</strong>  </p>
<ol>
<li>选择业务过程</li>
</ol>
<p>维度建模是紧贴业务的， 所以必须以业务为根基进行建模， 那么选择业务过程，顾名思义就是在整个业务流程中选取我们需要建模的业务， 根据运营提供的需求及日后的易扩展性等进行选择业务。 比如商城， 整个商城流程分为商家端， 用户端， 平台端， 运营需求是总订单量， 订单人数， 及用户的购买情况等， 我们选择业务过程就选择用户端的数据， 商家及平台端暂不考虑。 业务选择非常重要， 因为后面所有的步骤都是基于此业务数据展开的。  </p>
<ol start="2">
<li>声明粒度</li>
</ol>
<p>先举个例子： 对于用户来说， 一个用户有一个身份证号， 一个户籍地址， 多个手机号， 多张银行卡， 那么与用户粒度相同的粒度属性有身份证粒度， 户籍地址粒度， 比用户粒度更细的粒度有手机号粒度， 银行卡粒度， 存在一对一的关系就是相同粒度。 为什么要提相同粒度呢， 因为维度建模中要求我们， 在同一事实表中，必须具有相同的粒度， 同一事实表中不要混用多种不同的粒度， 不同的粒度数据建立不同的事实表。 并且从给定的业务过程获取数据时， 强烈建议从关注原子粒度开始设计， 也就是从最细粒度开始， 因为原子粒度能够承受无法预期的用户查询。 但是上卷汇总粒度对查询性能的提升很重要的， 所以对于有明确需求的数据，我们建立针对需求的上卷汇总粒度， 对需求不明朗的数据我们建立原子粒度。  </p>
<ol start="3">
<li>确认维度</li>
</ol>
<p>维度表是作为业务分析的入口和描述性标识， 所以也被称为数据仓库的“ 灵魂” 。在一堆的数据中怎么确认哪些是维度属性呢， 如果该列是对具体值的描述， 是一个文本或常量， 某一约束和行标识的参与者， 此时该属性往往是维度属性， 数仓工具箱中告诉我们<strong>牢牢掌握事实表的粒度， 就能将所有可能存在的维度区分开， 并且要确保维度表中不能出现重复数据， 应使维度主键唯一</strong>  </p>
<ol start="4">
<li>确认事实</li>
</ol>
<p>事实表是用来度量的， 基本上都以数量值表示， 事实表中的每行对应一个度量，每行中的数据是一个特定级别的细节数据， 称为粒度。 维度建模的核心原则之一<strong>是同一事实表中的所有度量必须具有相同的粒度</strong>。 这样能确保不会出现重复计算度量的问题。 有时候往往不能确定该列数据是事实属性还是维度属性。 记住<strong>最实用的事实就是数值类型和可加类事实</strong>。 所以可以通过分析该列是否是一种包含多个值并作为计算的参与者的度量， 这种情况下该列往往是事实  </p>
<h3 id="离线数仓建设实战"><a href="#离线数仓建设实战" class="headerlink" title="离线数仓建设实战"></a>离线数仓建设实战</h3><h4 id="业务介绍"><a href="#业务介绍" class="headerlink" title="业务介绍"></a>业务介绍</h4><p>需要针对不同需求的用户开发不同的产品， 所以公司内部有很多条业务线， 但是对于数据部门来说， 所有业务线的数据都是数据源。 <strong>对数据的划分不只是根据业务进行， 而是结合数据的属性</strong>。  </p>
<h4 id="早期规划"><a href="#早期规划" class="headerlink" title="早期规划"></a>早期规划</h4><p>之前开发是不同业务线对应不同的数据团队， 每个数据团队互不干扰， 这种模式比较简单， <strong>只针对自己的业务线进行数仓建设及报表开发即可。</strong></p>
<p>但是随着业务的发展， <strong>频繁迭代及跨部门的垂直业务单元越来越多</strong>， <strong>业务之间的出现耦合情况</strong>， 这时再采用这种烟囱式开发就出现了问题：</p>
<p>例如权限问题， 公司对数据管理比较严格， 不同的数据开发组没有权限共享数据，需要其他业务线的数据权限需要上报审批， 比较耽误时间；</p>
<p><strong>还有重复开发问题， 不同业务线会出现相同的报表需求</strong>， 如果每个业务方都开发各自的报表， 太浪费资源。</p>
<p><strong>所以对于数据开发而言， 需要对各个业务线的数据进行统一管理， 所以就有了数据中台的出现。</strong> </p>
<hr>
<h4 id="数据中台"><a href="#数据中台" class="headerlink" title="数据中台"></a>数据中台</h4><p>我认为数据中台是根据每个公司具体的业务需求而搭建的， 不同的业务， 对中台<br>的理解有所不同。  </p>
<p>公司内部开发的<strong>敏捷数据中台， 主要从数据技术和计算能力的复用， 到数据资产</strong><br><strong>和数据服务的复用</strong>， 数据中台以更大价值带宽， 快准精让数据直接赋能业务。 提<br>供一个统一化的管理， <strong>打破数据孤岛， 追溯数据血缘， 实现自助化及高复用度</strong>。<br>如下所示 ：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211708063.png" alt="image-20240921170833274"></p>
<p>以上解释比较抽象， 我们以实际项目开发来看下数据中台的便利性。<br>比如我们之前做报表开发流程， 首先是要<strong>数据采集</strong>， 不同的数据源通过sqoop等工具采集到大数据平台， 然后进行<strong>数仓搭建</strong>， 最后<strong>产出报表数据</strong>， <strong>放到可视化系统展示， 最终把整个流程写成脚本放到调度平台进行自动化执行。</strong><br><strong>而有了数据中台之后就不需要那么繁琐， 直接进行数仓搭建， 产生报表即可， 无</strong><br><strong>需将精力过多放在数据源、 可视化展示及调度</strong>。 并且可以直观的查看数据血缘关<br>系， 计算表之间血缘。 像下面图中， 表之间的依赖关系很明确  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211711530.png" alt="image-20240921171142957"></p>
<p>另一点， 数据中台的异构数据系统可以非常简单的进行关联查询， 比如 hive 的表关联 mysql 的表。 可透明屏蔽异构数据系统异构交互方式， 轻松实现跨异构数据系统透明混算。  </p>
<p>**异构数据系统原理是数据中台提供虚拟表到物理表之间的映射,终端用户无需关心<br>数据的物理存放位置和底层数据源的特性， 可直接操作数据， 体验类似操作一个虚<br>拟数据库。  **</p>
<p><strong>数据中台额外集成可视化展示</strong>， 提供一站式数据可视化解决方案， 支持 JDBC 数据源和 CSV 文件上传， 支持基于数据模型拖拽智能生成可视化组件， 大屏展示自适应不同大小屏幕。  </p>
<p><strong>调度系统</strong>是公司内部自写集成到数据中台的， 在编写完 sql 语句之后可以直接进行调度。  </p>
<hr>
<h4 id="数仓建设"><a href="#数仓建设" class="headerlink" title="数仓建设"></a>数仓建设</h4><p>到这才真正到数仓建设， 为什么前面我要占那么大篇幅去介绍公司业务及所使用的数据中台系统， 因为下面的数仓建设是根据公司的业务发展及现有的数据中台进行， 数仓的建设离不开公司的业务。  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211718626.png" alt="image-20240921171853254"></p>
<p><strong>数仓建设核心思想： 从设计、 开发、 部署和使用层面， 避免重复建设和指标冗余建设， 从而保障数据口径的规范和统一， 最终实现数据资产全链路关联、 提供标准数据输出以及建立统一的数据公共层</strong>。 有了核心思想， 那怎么开始数仓建设， 有句话说数仓建设者即是技术专家， 也是大半个业务专家， 所以采用的方式就是需求推动数据建设， 并且因为数据中台， 所以各业务知识体系比较集中， 各业务数据不再分散， 加快了数仓建设速度。<br>数仓建设主要从两个方面进行， <strong>模型和规范</strong>， 所有业务进行统一化  </p>
<h5 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h5><p>所有业务采用统一的模型体系， 从而降低研发成本， 增强指标复用， 并且能保证<br>数据口径的统一</p>
<h5 id="模型分层"><a href="#模型分层" class="headerlink" title="模型分层"></a>模型分层</h5><p>结合公司业务， 后期新增需求较多， 所以分层不宜过多， 并且需要清晰明确各层<br>职责， 要保证数据层的稳定又要屏蔽对下游影响， 所以采用如下分层结构：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211725772.png" alt="image-20240921172518645"></p>
<h5 id="数据流向"><a href="#数据流向" class="headerlink" title="数据流向"></a>数据流向</h5><p>遵循模型开发时分层结构， 数据从 ods -&gt; dw -&gt; dm -&gt;app 这样正向流动， 可<br>以防止因数据引用不规范而造成数据链路混乱及 SLA 时效难保障等问题， 同时保<br>证血缘关系简洁化， 能够轻易追踪数据流向。 在开发时应避免以下情况出现：  </p>
<ol>
<li>数据引用链路不正确， 如 ods -&gt; dm -&gt;app ， 出现这种情况说明明细层<br>没有完全覆盖数据； 如 ods -&gt; dw -&gt; app ， 说明轻度汇总层主题划分未<br>覆盖全 。 减少跨层引用， 才能提高中间表的复用度。 理想的数仓模型设<br>计应当具备： <strong>数据模型可复⽤， 完善且规范</strong>。  </li>
<li>尽量避免一层的表生成当前层的表， 如 dw 层表生成 dw 层表， 这样会影响<br>ETL 效率。  </li>
<li>禁止出现反向依赖， 如 dw 表依赖于 dm 表。</li>
</ol>
<h5 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h5><h6 id="表命名规范"><a href="#表命名规范" class="headerlink" title="表命名规范"></a>表命名规范</h6><ol>
<li>对于 ods、 dm、 app 层表名： 类型_主题_表含义， 如： dm_xxsh_user</li>
<li>对于 dw 层表名： 类型_主题_维度_表含义， 如： dw_xxsh_fact_users（事实表） 、 dw_xxsh_dim_city（维度表）</li>
</ol>
<h6 id="字段命名规范"><a href="#字段命名规范" class="headerlink" title="字段命名规范"></a>字段命名规范</h6><p>构建词根， 词根是维度和指标管理的基础， 划分为普通词根与专有词根</p>
<ol>
<li><p>普通词根： 描述事物的最小单元体， 如： sex-性别。</p>
</li>
<li><p>专有词根： 具备行业专属或公司内部规定的描述体， 如： xxsh-公司内部对某个产品的称呼。</p>
</li>
</ol>
<h6 id="脚本命名规范"><a href="#脚本命名规范" class="headerlink" title="脚本命名规范"></a>脚本命名规范</h6><p>脚本名称： 脚本类型.脚本功用.[库名].脚本名称， 如</p>
<p>hive.hive.dm.dm_xxsh_users<br>脚本类型主要分为以下三类：</p>
<ol>
<li>常规 Hive sql： hive</li>
<li>自定义 shell 脚本： sh</li>
<li>自定义 Python 脚本： python</li>
</ol>
<h6 id="脚本内容规范"><a href="#脚本内容规范" class="headerlink" title="脚本内容规范"></a>脚本内容规范</h6><h4 id="数据层具体实现"><a href="#数据层具体实现" class="headerlink" title="数据层具体实现"></a>数据层具体实现</h4><h5 id="数据源层-ODS"><a href="#数据源层-ODS" class="headerlink" title="数据源层 ODS"></a>数据源层 ODS</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211739096.png" alt="image-20240921173920023"></p>
<p>数据源层主要将各个业务数据导入到大数据平台， 作为业务数据的快照存储  </p>
<h5 id="数据明细层-DW"><a href="#数据明细层-DW" class="headerlink" title="数据明细层 DW"></a>数据明细层 DW</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211740888.png" alt="image-20240921174043752"></p>
<p>事实表中的每行对应一个度量， 每行中的数据是一个特定级别的细节数据， 称为粒度。 维度建模的核心原则之一是<strong>同一事实表中的所有度量必须具有相同的粒度</strong>。<br>这样能确保不会出现重复计算度量的问题。<br>维度表一般都是单一主键， 少数是联合主键， 注意维度表不要出现重复数据， 否则和事实表关联会出现<strong>数据发散</strong>问题。<br>有时候往往不能确定该列数据是事实属性还是维度属性。 记住<strong>最实用的事实就是数值类型和可加类事实</strong>。 所以可以通过分析该列是否是一种包含多个值并作为计算的参与者的度量， 这种情况下该列往往是事实； 如果该列是对具体值的描述，是一个文本或常量， 某一约束和行标识的参与者， 此时该属性往往是维度属性。但是还是要结合业务进行最终判断是维度还是事实。  </p>
<h5 id="数据轻度汇总层-DM"><a href="#数据轻度汇总层-DM" class="headerlink" title="数据轻度汇总层 DM"></a>数据轻度汇总层 DM</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211743061.png" alt="image-20240921174324394"></p>
<p>此层命名为轻汇总层， 就代表这一层已经开始对数据进行汇总， 但是不是完全汇<br>总， 只是对相同粒度的数据进行关联汇总， 不同粒度但是有关系的数据也可进行<br>汇总， 此时需要将粒度通过聚合等操作进行统一。  </p>
<h5 id="数据应用层-APP"><a href="#数据应用层-APP" class="headerlink" title="数据应用层 APP"></a>数据应用层 APP</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409211744871.png" alt="image-20240921174404336"></p>
<p>数据应用层的表就是提供给用户使用的， 数仓建设到此就接近尾声了， 接下来就<br>根据不同的需求进行不同的取数， 如直接进行报表展示， 或提供给数据分析的同<br>事所需的数据， 或其他的业务支撑。  </p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一张图总结下数据仓库的构建整体流程：</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409231708309.png" alt="image-20240923170810491"></p>
<h4 id="实际生产中注意事项"><a href="#实际生产中注意事项" class="headerlink" title="实际生产中注意事项"></a>实际生产中注意事项</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">生产环境中操作不能像我们自己测试时那样随意， 一不小心都可能造成生产事故。</span><br><span class="line">所以每步操作都要十分小心， 需全神贯注， 管好大脑管住右手。</span><br><span class="line">仅列出以下但不限于以下的注意事项：</span><br><span class="line"> 请勿操作自己管理及授权表之外的其它库表；</span><br><span class="line"> 未经授权， 请勿操作生产环境中其他人的脚本及文件；</span><br><span class="line"> 在修改生产环境脚本前，请务必自行备份到本地；</span><br><span class="line"> 请确认自己的修改操作能迅速回滚；</span><br><span class="line"> 生产环境中表名及字段等所有命名请遵循命名规则。</span><br></pre></td></tr></table></figure>



<h3 id="实时计算"><a href="#实时计算" class="headerlink" title="实时计算"></a>实时计算</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">实时计算一般都是针对海量数据进行的， 并且要求为秒级。 由于大数据兴起之初，Hadoop并没有给出实时计算解决方案， 随后 Storm， SparkStreaming， Flink等实时计算框架应运而生，而Kafka，ES的兴起使得实时计算领域的技术越来越完善，而随着物联网，机器学习等技术的推广，实时流式计算将在这些领域得到充分的应用</span><br></pre></td></tr></table></figure>

<p><strong>实时计算的三个特征</strong>：</p>
<ol>
<li>无限数据： 无限数据指的是一种不断增长的， 基本上无限的数据集。 这些</li>
</ol>
<p>通常被称为“流数据” ， 而与之相对的是有限的数据集。</p>
<ol start="2">
<li>无界数据处理： 一种持续的数据处理模式,能够通过处理引擎重复的去处</li>
</ol>
<p>理上面的无限数据， 是能够突破有限数据处理引擎的瓶颈的。</p>
<ol start="3">
<li>低延迟： 延迟是多少并没有明确的定义。 但我们都知道数据的价值将随着</li>
</ol>
<p>时间的流逝降低， 时效性将是需要持续解决的问题。  </p>
<p>现在大数据应用比较火爆的领域， 比如推荐系统在实践之初受技术所限， 可能要<br>一分钟， 一小时， 甚至更久对用户进行推荐， 这远远不能满足需要， 我们需要更<br>快的完成对数据的处理， 而不是进行离线的批处理。  </p>
<h4 id="实时计算应用场景"><a href="#实时计算应用场景" class="headerlink" title="实时计算应用场景"></a>实时计算应用场景</h4><p>随着实时技术发展趋于成熟， 实时计算应用越来越广泛， 以下仅列举常见的几种<br>实时计算的应用场景：  </p>
<h5 id="实时智能推荐"><a href="#实时智能推荐" class="headerlink" title="实时智能推荐"></a>实时智能推荐</h5><p>智能推荐会根据用户历史的购买或浏览行为， 通过推荐算法训练模型， 预测用户未来可能会购买的物品或喜爱的资讯。 对个人来说， 推荐系统起着信息过滤的作用， 对 Web&#x2F;App 服务端来说， 推荐系统起着满足用户个性化需求， 提升用户满意度的作用。 推荐系统本身也在飞速发展， 除了算法越来越完善， 对时延的要求也越来越苛刻和实时化。 利用 Flink 流计算帮助用户构建更加实时的智能推荐系统，对用户行为指标进行实时计算， 对模型进行实时更新， 对用户指标进行实时预测，并将预测的信息推送给 Web&#x2F;App 端， 帮助用户获取想要的商品信息， 另一方面也帮助企业提升销售额， 创造更大的商业价值。  </p>
<h5 id="实时欺诈检测"><a href="#实时欺诈检测" class="headerlink" title="实时欺诈检测"></a>实时欺诈检测</h5><p>在金融领域的业务中， 常常出现各种类型的欺诈行为， 例如信用卡欺诈， 信贷申请欺诈等， 而如何保证用户和公司的资金安全， 是近年来许多金融公司及银行共同面对的挑战。 随着不法分子欺诈手段的不断升级， 传统的反欺诈手段已经不足以解决目前所面临的问题。 以往可能需要几个小时才能通过交易数据计算出用户的行为指标， 然后通过规则判别出具有欺诈行为嫌疑的用户， 再进行案件调查处理， 在这种情况下资金可能早已被不法分子转移， 从而给企业和用户造成大量的经济损失。 而运用 Flink 流式计算技术能够在毫秒内就完成对欺诈行为判断指标的计算， 然后实时对交易流水进行实时拦截， 避免因为处理不及时而导致的经济损失  </p>
<h5 id="舆情分析"><a href="#舆情分析" class="headerlink" title="舆情分析"></a>舆情分析</h5><p>有的客户需要做舆情分析， 要求所有数据存放若干年， 舆情数据每日数据量可能超百万， 年数据量可达到几十亿的数据。 而且爬虫爬过来的数据是舆情， 通过大数据技术进行分词之后得到的可能是大段的网友评论， 客户往往要求对舆情进行查询， 做全文本搜索， 并要求响应时间控制在秒级。 爬虫将数据爬到大数据平台的 Kafka 里， 在里面做 Flink 流处理， 去重去噪做语音分析， 写到 ElasticSearch里。 大数据的一个特点是多数据源， 大数据平台能根据不同的场景选择不同的数据源。  </p>
<h5 id="复杂事件处理"><a href="#复杂事件处理" class="headerlink" title="复杂事件处理"></a>复杂事件处理</h5><p>对于复杂事件处理， 比较常见的集中于工业领域， 例如对车载传感器， 机械设备等实时故障检测， 这些业务类型通常数据量都非常大， 且对数据处理的时效性要求非常高。 通过利用 Flink 提供的 CEP 进行时间模式的抽取， 同时应用 Flink的 Sql 进行事件数据的转换， 在流式系统中构建实施规则引擎， 一旦事件触发报警规则， 便立即将告警结果通知至下游通知系统， 从而实现对设备故障快速预警检测， 车辆状态监控等目的。  </p>
<h5 id="实时机器学习"><a href="#实时机器学习" class="headerlink" title="实时机器学习"></a>实时机器学习</h5><p>实时机器学习是一个更宽泛的概念， 传统静态的机器学习主要侧重于静态的模型和历史数据进行训练并提供预测。 很多时候用户的短期行为， 对模型有修正作用，或者说是对业务判断有预测作用。 对系统来说， 需要采集用户最近的行为并进行特征工程， 然后给到实时机器学习系统进行机器学习。 如果动态地实施新规则，或是推出新广告， 就会有很大的参考价值。  </p>
<h4 id="实时计算总览"><a href="#实时计算总览" class="headerlink" title="实时计算总览"></a>实时计算总览</h4><p>我们先来看一张大数据平台的实时架构图：  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202409231720706.png" alt="image-20240923172044534"></p>
<h5 id="数据同步"><a href="#数据同步" class="headerlink" title="数据同步"></a>数据同步</h5><p>在上面这张架构图中， 数据从 Web 平台中产生， 通过数据同步系统导入到大数据平台， 由于数据源不同， 这里的数据同步系统实际上是多个相关系统的组合。 数据库同步通常Sqoop， 日志同步可以选择 Flume 等， 不同的数据源产生的数据质量可能差别很大， 数据库中的格式化数据直接导入大数据系统即可， 而日志和爬虫产生的数据就需要进行大量的清洗、 转化处理才能有效使用。  </p>
<h5 id="数据存储"><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h5><p>该层对原始数据、 清洗关联后的明细数据进行存储， 基于统一的实时数据模型分层理念， 将不同应用场景的数据分别存储在 Kafka、 HDFS、 Kudu、 Clickhouse、Hbase 等存储中。  </p>
<h5 id="数据计算"><a href="#数据计算" class="headerlink" title="数据计算"></a>数据计算</h5><p>计算层主要使用 Flink、 Spark、 Presto 以及 ClickHouse 自带的计算能力等四种计算引擎， Flink 计算引擎主要用于实时数据同步、 流式 ETL、 关键系统秒级实时指标计算场景， Spark SQL 主要用于复杂多维分析的准实时指标计算需求场景， Presto 和 ClickHouse 主要满足多维自助分析、 对查询响应时间要求不太高的场景  </p>
<h5 id="实时应用"><a href="#实时应用" class="headerlink" title="实时应用"></a>实时应用</h5><p>以统一查询服务对各个业务线数据场景进行支持， 业务主要包括实时大屏、 实时数据产品、 实时 OLAP、 实时特征等。  </p>
<p><strong>当然一个好的大数据平台不能缺少元数据管理及数据治理：</strong>  </p>
<ol>
<li><p><strong>元数据及指标管理：</strong> 主要对实时的Kafka表、Kudu 表、Clickhouse 表、Hive表等进行统一管理， 以数仓模型中表的命名方式规范表的命名， 明确每张表的字段含义、 使用方， 指标管理则是尽量通过指标管理系统将所有的实时指标统一管理起来， 明确计算口径， 提供给不同的业务方使用；</p>
</li>
<li><p><strong>数据质量及血缘分析</strong>： 数据质量分为平台监控和数据监控两个部分， 血缘分析则主要是对实时数据依赖关系、 实时任务的依赖关系进行分析。以上架构只是大数据平台通用的数据模型， 如果要具体的建设， 需要考虑以下情况， 业务需求需要实时还是准实时即可， 数据时效性是秒级还是分钟级等。<br> 在调度开销方面， 准实时数据是批处理过程， 因此仍然需要调度系统支持，调度频率较高， 而实时数据却没有调度开销；<br> 在业务灵活性方面， 因为准实时数据是基于 ETL 或 OLAP 引擎实现， 灵活性优于基于流计算的方式；<br> 在对数据晚到的容忍度方面， 因为准实时数据可以基于一个周期内的数据进行全量计算， 因此对于数据晚到的容忍度也是比较高的， 而实时数据使用的是增量计算， 对于数据晚到的容忍度更低一些；<br> 在适用场景方面， 准实时数据主要用于有实时性要求但不太高、 涉及多表关联和业务变更频繁的场景， 如交易类型的实时分析， 实时数据则更适用于实时性要求高、 数据量大的场景， 如实时特征、 流量类型实时分析等场景。</p>
</li>
</ol>
<h4 id="实时架构"><a href="#实时架构" class="headerlink" title="实时架构"></a>实时架构</h4><h5 id="Lambda-架构"><a href="#Lambda-架构" class="headerlink" title="Lambda 架构"></a>Lambda 架构</h5><h5 id="Kappa-架构"><a href="#Kappa-架构" class="headerlink" title="Kappa 架构"></a>Kappa 架构</h5><h3 id="实时数仓建设核心"><a href="#实时数仓建设核心" class="headerlink" title="实时数仓建设核心"></a>实时数仓建设核心</h3></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">智汇君</div><div class="post-copyright__author_desc">路漫漫其修远兮，吾将上下而求索！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20Hadoop%E9%9D%A2%E8%AF%95/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/01/17/面试 Hadoop面试/')">面试 Hadoop面试</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20Hadoop%E9%9D%A2%E8%AF%95/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Tech智汇站</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E9%9D%A2%E8%AF%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>面试<span class="tagsPageCount">12</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20spring%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">spring常见面试题</div></div></a></div><div class="next-post pull-right"><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20hive%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%981/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">面试 hive常见面试题1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/01/17/%E5%B0%9A%E8%A7%82%E4%BA%91%E8%AE%A1%E7%AE%97%E4%B9%8Boracle%E6%95%B0%E6%8D%AE%E5%BA%93-%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86%201/" title="尚观云计算之oracle数据库 基础部分 1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">尚观云计算之oracle数据库 基础部分 1</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20ES%E9%9D%A2%E8%AF%951/" title="面试 ES面试1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 ES面试1</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20hive%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%982/" title="面试 hive常见面试题2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 hive常见面试题2</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20hive%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%981/" title="面试 hive常见面试题1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 hive常见面试题1</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20linux%E9%9D%A2%E8%AF%952/" title="面试 SHELL脚本开发"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 SHELL脚本开发</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20spring%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/" title="spring常见面试题"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">spring常见面试题</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">智汇君</h1><div class="author-info__desc">路漫漫其修远兮，吾将上下而求索！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="/contact/" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(/img/博客微信公众号图片.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hadoop%E9%9D%A2%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">Hadoop面试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hadoop"><span class="toc-number">1.1.</span> <span class="toc-text">Hadoop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HDFS"><span class="toc-number">1.2.</span> <span class="toc-text">HDFS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%BA%E6%9E%B6%E6%84%9F%E7%9F%A5%E4%B8%8E%E5%89%AF%E6%9C%AC%E5%86%97%E4%BD%99%E5%AD%98%E5%82%A8%E7%AD%96%E7%95%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">机架感知与副本冗余存储策略</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MAPREDUCE"><span class="toc-number">1.3.</span> <span class="toc-text">MAPREDUCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%B8%80-WordCount-%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.3.1.</span> <span class="toc-text">案例一 WordCount 程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%BA%8C-%E7%BB%9F%E8%AE%A1%E5%90%84%E4%B8%AA%E9%83%A8%E9%97%A8%E5%91%98%E5%B7%A5%E8%96%AA%E6%B0%B4%E6%80%BB%E5%92%8C"><span class="toc-number">1.3.2.</span> <span class="toc-text">案例二 统计各个部门员工薪水总和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%B8%89-%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.3.3.</span> <span class="toc-text">案例三 序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%9B%9B-%E5%88%86%E5%8C%BA"><span class="toc-number">1.3.4.</span> <span class="toc-text">案例四 分区</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%BA%94-%E5%90%88%E5%B9%B6-%E9%A2%84%E8%81%9A%E5%90%88"><span class="toc-number">1.3.5.</span> <span class="toc-text">案例五 合并 预聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E8%BF%B0MapTask%E5%B9%B6%E8%A1%8C%E5%BA%A6%E5%86%B3%E5%AE%9A%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.6.</span> <span class="toc-text">简述MapTask并行度决定机制?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E8%BF%B0FileInputFormat-%E9%BB%98%E8%AE%A4%E5%BA%94%E8%AF%A5%E6%98%AF%E5%85%B6%E5%AD%90%E7%B1%BBtextinputformat-%E5%88%87%E7%89%87%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.7.</span> <span class="toc-text">简述FileInputFormat(默认应该是其子类textinputformat)切片机制?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapReduce%E7%A8%8B%E5%BA%8F%E5%A6%82%E4%BD%95%E5%A4%A7%E9%87%8F%E5%B0%8F%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.8.</span> <span class="toc-text">MapReduce程序如何大量小文件?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#combinetextinputformat"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">combinetextinputformat</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReduceTask%E5%B9%B6%E8%A1%8C%E5%BA%A6%E4%B8%8E%E5%88%86%E5%8C%BA%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.3.9.</span> <span class="toc-text">ReduceTask并行度与分区的关系?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapReduce%E6%8E%92%E5%BA%8F"><span class="toc-number">1.3.10.</span> <span class="toc-text">MapReduce排序?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%92%E5%BA%8FWritableComparable"><span class="toc-number">1.3.10.1.</span> <span class="toc-text">自定义排序WritableComparable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapReduce%E7%9A%84Combiner%E7%BB%84%E4%BB%B6-%E9%A2%84%E8%81%9A%E5%90%88"><span class="toc-number">1.3.11.</span> <span class="toc-text">MapReduce的Combiner组件(预聚合)?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Combiner"><span class="toc-number">1.3.11.1.</span> <span class="toc-text">自定义Combiner</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapReduce%E5%88%86%E7%BB%84%E6%B1%82TopN-GroupingComparator"><span class="toc-number">1.3.12.</span> <span class="toc-text">MapReduce分组求TopN? GroupingComparator</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#student"><span class="toc-number">1.3.12.1.</span> <span class="toc-text">student</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#map"><span class="toc-number">1.3.12.2.</span> <span class="toc-text">map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groupingcomparator"><span class="toc-number">1.3.12.3.</span> <span class="toc-text">groupingcomparator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E7%AC%AC%E4%B8%80%E5%90%8D"><span class="toc-number">1.3.12.4.</span> <span class="toc-text">分组第一名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84topn"><span class="toc-number">1.3.12.5.</span> <span class="toc-text">分组topn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E8%A3%85job"><span class="toc-number">1.3.12.6.</span> <span class="toc-text">组装job</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MapReduce-Join"><span class="toc-number">1.3.13.</span> <span class="toc-text">MapReduce Join?</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#reduce-join"><span class="toc-number">1.3.13.1.</span> <span class="toc-text">reduce join</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#reducejoin%E7%BC%BA%E7%82%B9"><span class="toc-number">1.3.13.1.1.</span> <span class="toc-text">reducejoin缺点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapjoin"><span class="toc-number">1.3.13.2.</span> <span class="toc-text">mapjoin</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.3.13.2.1.</span> <span class="toc-text">使用场景</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MultipleInputs"><span class="toc-number">1.3.14.</span> <span class="toc-text">MultipleInputs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mapreduce%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.3.15.</span> <span class="toc-text">mapreduce压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%85%AD-%E5%8E%BB%E9%87%8D"><span class="toc-number">1.3.16.</span> <span class="toc-text">案例六 去重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%B8%83-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.17.</span> <span class="toc-text">案例七 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#map-1"><span class="toc-number">1.3.17.1.</span> <span class="toc-text">map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reduce"><span class="toc-number">1.3.17.2.</span> <span class="toc-text">reduce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#job"><span class="toc-number">1.3.17.3.</span> <span class="toc-text">job</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E5%85%AB-%E6%B1%82%E5%87%BA%E5%90%84%E5%B9%B4%E9%94%80%E5%94%AE%E7%AC%94%E6%95%B0%E3%80%81%E5%90%84%E5%B9%B4%E9%94%80%E5%94%AE%E6%80%BB%E9%A2%9D"><span class="toc-number">1.3.18.</span> <span class="toc-text">案例八 求出各年销售笔数、各年销售总额</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#YARN"><span class="toc-number">1.4.</span> <span class="toc-text">YARN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yarn%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.2.</span> <span class="toc-text">yarn基本架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yarn%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.3.</span> <span class="toc-text">yarn常用命令操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">查看任务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%9C%8B%E6%97%A5%E5%BF%97-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">常看日志 查看容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">查看节点状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%9F%E5%88%97"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">查看队列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">更新配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yarn%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.4.</span> <span class="toc-text">yarn工作原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B"><span class="toc-number">1.5.</span> <span class="toc-text">数仓建设保姆级教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.5.1.</span> <span class="toc-text">数仓基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">数据仓库架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A6%82%E5%BF%B5"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">数据仓库概念</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%89%B9%E5%BE%81"><span class="toc-number">1.5.1.2.1.</span> <span class="toc-text">基本特征</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E4%B8%BB%E9%A2%98"><span class="toc-number">1.5.1.2.1.1.</span> <span class="toc-text">面向主题</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%9B%86%E6%88%90%E7%9A%84"><span class="toc-number">1.5.1.2.1.2.</span> <span class="toc-text">集成的</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%9D%9E%E6%98%93%E5%A4%B1%E6%80%A7"><span class="toc-number">1.5.1.2.1.3.</span> <span class="toc-text">非易失性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%97%B6%E5%8F%98%E6%80%A7"><span class="toc-number">1.5.1.2.1.4.</span> <span class="toc-text">时变性</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93"><span class="toc-number">1.5.1.2.2.</span> <span class="toc-text">为什么要有数据仓库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.5.1.2.3.</span> <span class="toc-text">数据仓库与数据库的区别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.4.</span> <span class="toc-text">数据仓库分层架构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.5.</span> <span class="toc-text">主要数据仓库架构</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%B8%82%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.5.1.</span> <span class="toc-text">数据集市架构</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Inmon-%E4%BC%81%E4%B8%9A%E5%B7%A5%E5%8E%82%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.5.2.</span> <span class="toc-text">Inmon 企业工厂架构</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Kimball-%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.5.3.</span> <span class="toc-text">Kimball 数据仓库架构</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%9E%8B%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.1.2.5.4.</span> <span class="toc-text">混合型数据仓库架构</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%85%83%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.5.1.2.6.</span> <span class="toc-text">数据仓库元数据的管理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%B8%B8%E8%A7%81%E6%9C%AF%E8%AF%AD%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.1.2.7.</span> <span class="toc-text">数仓常见术语解析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%B8%82"><span class="toc-number">1.5.1.2.8.</span> <span class="toc-text">数据集市</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%90%8D%E8%AF%8D%E4%B9%8B%E9%97%B4%E5%85%B3%E7%B3%BB"><span class="toc-number">1.5.1.2.8.1.</span> <span class="toc-text">数仓名词之间关系</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE%E6%A0%B8%E5%BF%83"><span class="toc-number">1.5.2.</span> <span class="toc-text">离线数仓建设核心</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%88%86%E5%B1%82"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">数仓分层</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E5%B1%82%EF%BC%9A-ODS%EF%BC%88-Operational-Data-Store%EF%BC%89"><span class="toc-number">1.5.2.1.1.</span> <span class="toc-text">数据源层： ODS（ Operational Data Store）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%B1%82%EF%BC%9A-DW%EF%BC%88-Data-Warehouse%EF%BC%89"><span class="toc-number">1.5.2.1.2.</span> <span class="toc-text">数据仓库层： DW（ Data Warehouse）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%98%8E%E7%BB%86%E5%B1%82%EF%BC%9A-DWD%EF%BC%88-Data-Warehouse-Detail%EF%BC%89"><span class="toc-number">1.5.2.1.2.1.</span> <span class="toc-text">数据明细层： DWD（ Data Warehouse Detail）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%AD%E9%97%B4%E5%B1%82%EF%BC%9A-DWM%EF%BC%88-Data-WareHouse-Middle%EF%BC%89"><span class="toc-number">1.5.2.1.2.2.</span> <span class="toc-text">数据中间层： DWM（ Data WareHouse Middle）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1%E5%B1%82%EF%BC%9A-DWS%EF%BC%88-Data-WareHouse-Servce%EF%BC%89"><span class="toc-number">1.5.2.1.2.3.</span> <span class="toc-text">数据服务层： DWS（ Data WareHouse Servce）</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A-APP%EF%BC%88Application%EF%BC%89"><span class="toc-number">1.5.2.1.3.</span> <span class="toc-text">数据应用层： APP（Application）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%B4%E8%A1%A8%E5%B1%82%EF%BC%9A-DIM%EF%BC%88Dimension%EF%BC%89"><span class="toc-number">1.5.2.1.4.</span> <span class="toc-text">维表层： DIM（Dimension）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%BB%BA%E6%A8%A1%E6%96%B9%E6%B3%95"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">数仓建模方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8C%83%E5%BC%8F%E5%BB%BA%E6%A8%A1%E6%B3%95%EF%BC%88Third-Normal-Form%EF%BC%8C-3NF%EF%BC%89"><span class="toc-number">1.5.2.2.1.</span> <span class="toc-text">范式建模法（Third Normal Form， 3NF）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E8%8C%83%E5%BC%8F"><span class="toc-number">1.5.2.2.1.1.</span> <span class="toc-text">第一范式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%8C%83%E5%BC%8F"><span class="toc-number">1.5.2.2.1.2.</span> <span class="toc-text">第二范式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-number">1.5.2.2.1.3.</span> <span class="toc-text">第三范式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#BC%E8%8C%83%E5%BC%8F%E3%80%81%E7%AC%AC%E5%9B%9B%E8%8C%83%E5%BC%8F%EF%BC%8C%E7%AC%AC%E4%BA%94%E8%8C%83%E5%BC%8F"><span class="toc-number">1.5.2.2.1.4.</span> <span class="toc-text">BC范式、第四范式，第五范式</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E6%B3%95%EF%BC%88Dimensional-Modeling%EF%BC%89"><span class="toc-number">1.5.2.2.2.</span> <span class="toc-text">维度建模法（Dimensional Modeling）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%BB%BA%E6%A8%A1%E6%B3%95%EF%BC%88Entity-Modeling%EF%BC%89"><span class="toc-number">1.5.2.2.3.</span> <span class="toc-text">实体建模法（Entity Modeling）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.5.2.2.4.</span> <span class="toc-text">维度建模详解</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E4%B8%AD%E8%A1%A8%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.2.2.4.1.</span> <span class="toc-text">维度建模中表的类型</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.5.2.2.4.2.</span> <span class="toc-text">维度建模三种模式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E8%BF%87%E7%A8%8B"><span class="toc-number">1.5.2.2.4.3.</span> <span class="toc-text">维度建模过程</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE%E5%AE%9E%E6%88%98"><span class="toc-number">1.5.3.</span> <span class="toc-text">离线数仓建设实战</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">业务介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A9%E6%9C%9F%E8%A7%84%E5%88%92"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">早期规划</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%8F%B0"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">数据中台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">数仓建设</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.5.3.4.1.</span> <span class="toc-text">模型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E5%88%86%E5%B1%82"><span class="toc-number">1.5.3.4.2.</span> <span class="toc-text">模型分层</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B5%81%E5%90%91"><span class="toc-number">1.5.3.4.3.</span> <span class="toc-text">数据流向</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.3.4.4.</span> <span class="toc-text">规范</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A1%A8%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.3.4.4.1.</span> <span class="toc-text">表命名规范</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.3.4.4.2.</span> <span class="toc-text">字段命名规范</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.3.4.4.3.</span> <span class="toc-text">脚本命名规范</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%86%85%E5%AE%B9%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.3.4.4.4.</span> <span class="toc-text">脚本内容规范</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%82%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.5.3.5.</span> <span class="toc-text">数据层具体实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E5%B1%82-ODS"><span class="toc-number">1.5.3.5.1.</span> <span class="toc-text">数据源层 ODS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%98%8E%E7%BB%86%E5%B1%82-DW"><span class="toc-number">1.5.3.5.2.</span> <span class="toc-text">数据明细层 DW</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BD%BB%E5%BA%A6%E6%B1%87%E6%80%BB%E5%B1%82-DM"><span class="toc-number">1.5.3.5.3.</span> <span class="toc-text">数据轻度汇总层 DM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8%E5%B1%82-APP"><span class="toc-number">1.5.3.5.4.</span> <span class="toc-text">数据应用层 APP</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.3.6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E7%94%9F%E4%BA%A7%E4%B8%AD%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.3.7.</span> <span class="toc-text">实际生产中注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97"><span class="toc-number">1.5.4.</span> <span class="toc-text">实时计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">实时计算应用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%99%BA%E8%83%BD%E6%8E%A8%E8%8D%90"><span class="toc-number">1.5.4.1.1.</span> <span class="toc-text">实时智能推荐</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%AC%BA%E8%AF%88%E6%A3%80%E6%B5%8B"><span class="toc-number">1.5.4.1.2.</span> <span class="toc-text">实时欺诈检测</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%88%86%E6%83%85%E5%88%86%E6%9E%90"><span class="toc-number">1.5.4.1.3.</span> <span class="toc-text">舆情分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.5.4.1.4.</span> <span class="toc-text">复杂事件处理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0"><span class="toc-number">1.5.4.1.5.</span> <span class="toc-text">实时机器学习</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97%E6%80%BB%E8%A7%88"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">实时计算总览</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5"><span class="toc-number">1.5.4.2.1.</span> <span class="toc-text">数据同步</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8"><span class="toc-number">1.5.4.2.2.</span> <span class="toc-text">数据存储</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97"><span class="toc-number">1.5.4.2.3.</span> <span class="toc-text">数据计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E5%BA%94%E7%94%A8"><span class="toc-number">1.5.4.2.4.</span> <span class="toc-text">实时应用</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">实时架构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lambda-%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.4.3.1.</span> <span class="toc-text">Lambda 架构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Kappa-%E6%9E%B6%E6%9E%84"><span class="toc-number">1.5.4.3.2.</span> <span class="toc-text">Kappa 架构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE%E6%A0%B8%E5%BF%83"><span class="toc-number">1.5.5.</span> <span class="toc-text">实时数仓建设核心</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/23/Geek%20Uninstaller%EF%BC%8C%E7%BB%BF%E8%89%B2%E5%85%8D%E5%AE%89%E8%A3%85%E8%BD%BB%E9%87%8F%E7%9A%84%E5%BA%94%E7%94%A8%E5%8D%B8%E8%BD%BD%E5%B7%A5%E5%85%B7%EF%BC%81/" title="Geek Uninstaller，绿色免安装轻量的应用卸载工具！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Geek Uninstaller，绿色免安装轻量的应用卸载工具！"/></a><div class="content"><a class="title" href="/2025/01/23/Geek%20Uninstaller%EF%BC%8C%E7%BB%BF%E8%89%B2%E5%85%8D%E5%AE%89%E8%A3%85%E8%BD%BB%E9%87%8F%E7%9A%84%E5%BA%94%E7%94%A8%E5%8D%B8%E8%BD%BD%E5%B7%A5%E5%85%B7%EF%BC%81/" title="Geek Uninstaller，绿色免安装轻量的应用卸载工具！">Geek Uninstaller，绿色免安装轻量的应用卸载工具！</a><time datetime="2025-01-23T14:05:38.000Z" title="发表于 2025-01-23 22:05:38">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E6%8A%96%E9%9F%B3%E8%B0%B7%E6%AD%8Cplay%E7%89%88%EF%BC%8C%E7%9C%9F%E7%9A%84%E5%BE%88%E4%B8%9D%E6%BB%91%EF%BC%81/" title="抖音谷歌play版，真的很丝滑！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="抖音谷歌play版，真的很丝滑！"/></a><div class="content"><a class="title" href="/2025/01/22/%E6%8A%96%E9%9F%B3%E8%B0%B7%E6%AD%8Cplay%E7%89%88%EF%BC%8C%E7%9C%9F%E7%9A%84%E5%BE%88%E4%B8%9D%E6%BB%91%EF%BC%81/" title="抖音谷歌play版，真的很丝滑！">抖音谷歌play版，真的很丝滑！</a><time datetime="2025-01-22T04:43:48.000Z" title="发表于 2025-01-22 12:43:48">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/Quick%20Startup%EF%BC%8C%E5%BF%AB%E6%8D%B7%E5%A4%84%E7%90%86%E8%87%AA%E5%90%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%8A%A0%E5%BF%AB%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E9%80%9F%E5%BA%A6%EF%BC%81/" title="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！"/></a><div class="content"><a class="title" href="/2025/01/22/Quick%20Startup%EF%BC%8C%E5%BF%AB%E6%8D%B7%E5%A4%84%E7%90%86%E8%87%AA%E5%90%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%8A%A0%E5%BF%AB%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E9%80%9F%E5%BA%A6%EF%BC%81/" title="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！">Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！</a><time datetime="2025-01-21T19:35:09.000Z" title="发表于 2025-01-22 03:35:09">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E5%BF%83%E7%BB%AA%E6%97%A5%E8%AE%B0/" title="心绪日记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="心绪日记"/></a><div class="content"><a class="title" href="/2025/01/22/%E5%BF%83%E7%BB%AA%E6%97%A5%E8%AE%B0/" title="心绪日记">心绪日记</a><time datetime="2025-01-21T16:49:22.000Z" title="发表于 2025-01-22 00:49:22">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/20/%E7%9B%90%E9%80%89%E6%95%85%E4%BA%8B%EF%BC%8C%E8%BF%99%E5%87%A0%E4%B8%AA%E7%BD%91%E7%AB%99%E8%B6%B3%E5%A4%9F%E4%BD%A0%E7%9C%8B%EF%BC%81/" title="盐选故事，这几个网站足够你看！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="盐选故事，这几个网站足够你看！"/></a><div class="content"><a class="title" href="/2025/01/20/%E7%9B%90%E9%80%89%E6%95%85%E4%BA%8B%EF%BC%8C%E8%BF%99%E5%87%A0%E4%B8%AA%E7%BD%91%E7%AB%99%E8%B6%B3%E5%A4%9F%E4%BD%A0%E7%9C%8B%EF%BC%81/" title="盐选故事，这几个网站足够你看！">盐选故事，这几个网站足够你看！</a><time datetime="2025-01-20T14:58:34.000Z" title="发表于 2025-01-20 22:58:34">2025-01-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="智汇君" target="_blank">智汇君</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">138</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">54</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">37</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/ChatGPT/" style="font-size: 0.88rem;">ChatGPT<sup>1</sup></a><a href="/tags/CloudFlare/" style="font-size: 0.88rem;">CloudFlare<sup>2</sup></a><a href="/tags/EScrcpy/" style="font-size: 0.88rem;">EScrcpy<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 0.88rem;">GitHub<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 0.88rem;">NodeJs<sup>1</sup></a><a href="/tags/PowerToys/" style="font-size: 0.88rem;">PowerToys<sup>1</sup></a><a href="/tags/US-KG/" style="font-size: 0.88rem;">US.KG<sup>1</sup></a><a href="/tags/Vip%E8%A7%86%E9%A2%91/" style="font-size: 0.88rem;">Vip视频<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>3</sup></a><a href="/tags/github/" style="font-size: 0.88rem;">github<sup>1</sup></a><a href="/tags/idea/" style="font-size: 0.88rem;">idea<sup>1</sup></a><a href="/tags/seal/" style="font-size: 0.88rem;">seal<sup>1</sup></a><a href="/tags/yt-dlp/" style="font-size: 0.88rem;">yt-dlp<sup>1</sup></a><a href="/tags/%E4%BC%91%E7%9C%A0/" style="font-size: 0.88rem;">休眠<sup>1</sup></a><a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size: 0.88rem;">免费<sup>3</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 0.88rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8A%9F%E8%83%BD%E9%9B%86%E5%90%88%E8%BD%AF%E4%BB%B6/" style="font-size: 0.88rem;">功能集合软件<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 0.88rem;">域名<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E6%89%98%E7%AE%A1/" style="font-size: 0.88rem;">域名托管<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E7%94%B3%E8%AF%B7/" style="font-size: 0.88rem;">域名申请<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 0.88rem;">大数据<sup>26</sup></a><a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">大模型<sup>1</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 0.88rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%AE%9E%E6%97%B6%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 0.88rem;">实时语音转文字<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 0.88rem;">廖雪峰<sup>9</sup></a><a href="/tags/%E6%89%8B%E6%9C%BA%E6%8A%95%E5%B1%8F/" style="font-size: 0.88rem;">手机投屏<sup>1</sup></a><a href="/tags/%E6%B3%A8%E9%94%80/" style="font-size: 0.88rem;">注销<sup>1</sup></a><a href="/tags/%E7%94%B5%E9%87%8F%E6%98%BE%E7%A4%BA/" style="font-size: 0.88rem;">电量显示<sup>1</sup></a><a href="/tags/%E7%9D%A1%E7%9C%A0/" style="font-size: 0.88rem;">睡眠<sup>1</sup></a><a href="/tags/%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87/" style="font-size: 0.88rem;">蓝牙设备<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E8%BA%AB%E4%BB%BD%E7%94%9F%E6%88%90/" style="font-size: 0.88rem;">虚拟身份生成<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90/" style="font-size: 0.88rem;">视频解析<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%BD%AC%E5%AD%97%E5%B9%95/" style="font-size: 0.88rem;">视频转字幕<sup>1</sup></a><a href="/tags/%E9%87%8D%E5%90%AF/" style="font-size: 0.88rem;">重启<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 0.88rem;">面试<sup>12</sup></a><a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 0.88rem;">音视频转文字<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("24/12/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 智汇君 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("24/12/2024 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="https://at.alicdn.com/t/c/font_4792307_02gxbpyxcpwp.js?spm=a313x.manage_type_myprojects.i1.10.56323a81KZGFDE&amp;file=font_4792307_02gxbpyxcpwp.js# 阿里图标symbol 引用链接，主题会进行加载 symbol 引用"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>