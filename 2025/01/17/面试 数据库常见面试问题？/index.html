<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>面试 数据库常见面试问题？ | Tech智汇站</title><meta name="keywords" content="面试"><meta name="author" content="智汇君"><meta name="copyright" content="智汇君"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="面试 数据库常见面试问题？"><meta name="application-name" content="面试 数据库常见面试问题？"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="面试 数据库常见面试问题？"><meta property="og:url" content="http://example.com/2025/01/17/面试 数据库常见面试问题？/index.html"><meta property="og:site_name" content="Tech智汇站"><meta property="og:description" content="数据库常见面试问题？mysql课程1234567891011121314151617181920212223常用的存储引擎？InnoDB与MyISAM的区别？什么是事务,以及事务的四大特性?事务的隔离级别有哪些,MySQL默认是哪个?内连接与左外连接的区别是什么?MySQL默认InnoDB引擎的索引"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta property="article:author" content="智汇君"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta name="description" content="数据库常见面试问题？mysql课程1234567891011121314151617181920212223常用的存储引擎？InnoDB与MyISAM的区别？什么是事务,以及事务的四大特性?事务的隔离级别有哪些,MySQL默认是哪个?内连接与左外连接的区别是什么?MySQL默认InnoDB引擎的索引"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%EF%BC%9F/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css#fontawesome_animation 如果有就会加载，示例值：https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":270},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 智汇君","link":"链接: ","source":"来源: Tech智汇站","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Tech智汇站',
  title: '面试 数据库常见面试问题？',
  postAI: '',
  pageFillDescription: '数据库常见面试问题？, mysql, 课程, 稀土掘金, 什么是幻读脏读不可重复读呢？, limit 1000000 加载很慢的话你是怎么解决的呢？, 在高并发情况下如何做到安全的修改同一行数据？, 使用悲观锁, 使用乐观锁, CSDN案例, 案例一, 1.2, 1.3, 7 having的一个使用技巧, 8, 9, 13, 15  变量的使用, 16 dense_rank()   变量的使用, 17 区域段 case when then  concat, 22 like, 25, 33 变量的使用 limit, 34  变量的使用, 41 current_day()substring()year()now(), 42 week, 43 month, 44 month, 案例二, 9 !外连接实现except, 10, 11, 14 case when round 值得注意, 15 PARTITION BY  下面那个with案例值得注意, 16 变量的使用 法一没看懂 法二法六 值得注意, 17 18值得注意 22 ROUND\CASE\CONCAT, ！33 34 35 36 37 39 40 HAVING 变量, ！timestampdiff()\week()\month()\NOW()\YEAR(x)\CURDATE(), 41, 42, 43, 44, 45, LEECODE案例, 262, avg精彩用法, 569 partition by 中位数, 601 lag() lead(), 602 case when, 608 union, 1070, 1972  同一天的第一个电话和最后一个电话 难, mysql注释问题, mysql修改列数据类型, 1988, 1990, 2004, 2020 简单, 2026 简单, 2041 简单, 2051, 常用积累, Delete, 1, 日期相关, DATEDIFF(), TIMESTAMPDIFF(), DATE_FORMAT(), DATE_ADD(), CURDATE()NOW(), month()week()year(), lag()、lead(), roud()、if(), limit(), 一个参数, 两个参数, 分页offset, IFNULL()、NULLIF()、ISNULL(), ltgt、!x3D、ltx3Dgt、NULL、TRUE、FALSE、UNKNOWN, 笛卡尔积, WITH, mod(), substring(), group by 新奇, 自定义变量, CROSS JOIN, 窗口函数, CASE, GROUP_CONCAT(), 正则表达式数据库常见面试问题课程常用的存储引擎与的区别什么是事务以及事务的四大特性事务的隔离级别有哪些默认是哪个内连接与左外连接的区别是什么默认引擎的索引是什么数据结构如何查看的执行计划索引失效的情况有哪些什么是回表查询什么是主从复制的原理是什么主从复制之后的读写分离如何实现数据库的分库分表如何实现性能优化经验优化大多依赖索引进行聚集索引和二级索引对于理解优化很关键能使用聚集使用过滤就不使用二级索引效率更高满足业务需求的情况下尽量降低主键的长度因为二级索引叶子节点会存储主键会导致索引数据大插入数据时尽量选择顺序插入选择使用自增主键避免页分裂尽量不要使用做主键或者是其他自然主键如身份证号长度长且无序批量插入数据执行频率慢查询执行计划详情可以从这几个维度回答这个问题加索引避免返回不必要的数据适当分批量进行优化结构分库分表读写分离数据库优化经验四五千万条记录时就可能要考虑分库分表了这是运维篇的内容建立索引的优劣势优缺点优势提高数据检索的效率降低数据库的成本通过索引列对数据进行排序降低数据排序的成本降低的消耗劣势索引列也是要占用空间的索引大大提高了查询效率同时却也降低更新表的速度如对表进行时效率降低为什么存储引擎选择使用索引结构相对于二叉树层级更少搜索效率高对于无论是叶子节点还是非叶子节点都会保存数据这样导致一页中存储的键值减少指针跟着减少要同样保存大量数据只能增加树的高度导致性能降低相对索引支持范围匹配及排序操作估算主键索引树层时大概能存储多少行数据只要给出主键什么类型多大然后一行数据多大就可以估算先算一个页最大能存储多少个主键然后算出指针数再乘以一个页最大能存储多少行数据就行索引使用有哪些注意事项呢讲的条在索引列上使用的内置函数索引失效对索引列运算如索引失效索引字段上使用或者时可能会导致索引失效左连接查询或者右连接查询查询关联的字段编码格式不一样可能导致索引失效索引不适合哪些场景数据量少的不适合加索引更新比较频繁的也不适合加索引区分度低的字段不适合加索引如性别针对于数据量较大条且查询比较频繁的表建立索引针对于常作为查询条件排序分组操作的字段建立索引尽量选择区分度高的列作为索引尽量建立唯一索引区分度越高使用索引的效率越高如果是字符串类型的字段字段的长度较长可以针对于字段的特点建立前缀索引尽量使用联合索引减少单列索引查询时联合索引很多时候可以覆盖索引节省存储空间避免回表提高查询效率要控制素引的数量索引并不是多多益善索引越多维护索引结构的代价也就越大会影响增删改的效率如果索引列不能存储值请在创建表时使用约束它当优化器知道每列是否包含值时它可以更好地确定哪个索引最有效地用于查询遇到过死锁问题吗你是如何解决的我排查死锁的一般步骤是酱紫的查看死锁日志找出死锁分析加锁情况模拟死锁案发分析死锁日志分析死锁结果聚集索引与非聚集索引的区别稀土掘金什么是幻读脏读不可重复读呢脏读幻读数据量不一样不可重复读数据值不一样加载很慢的话你是怎么解决的呢方案一如果是连续的可以这样返回上次查询的最大记录偏移量再往下复制代码方案二在业务允许的情况下限制页数建议跟业务讨论有没有必要查这么后的分页啦因为绝大多数用户都不会往后翻太多页方案三索引为索引复制代码方案四利用延迟关联或者子查询优化超多分页场景先快速定位需要获取的段然后再关联复制代码条件在高并发情况下如何做到安全的修改同一行数据要安全的修改同一行数据就要保证一个线程在修改时其它线程无法更新这行记录一般有悲观锁和乐观锁两种方案使用悲观锁悲观锁思想就是当前线程要进来修改数据时别的线程都得拒之门外比如可以使用以上这条语句会锁定了表中所有符合检索条件的记录本次事务提交之前别的线程都无法修改这些记录使用乐观锁乐观锁思想就是有线程过来先放过去修改如果看到别的线程没修改过就可以修改成功如果别的线程修改过就修改失败或者重试实现方式乐观锁一般会使用版本号机制或算法实现案例案例一链接学生表教师表科目表成绩表查询同时存在课程和课程的情况查询存在课程但可能不存在课程的情况不存在时显示为查询不存在课程但存在课程的学生情况查询平均成绩大于等于分的学生编号和学生姓名和平均成绩查询在表存在成绩的学生信息查询所有同学的学生编号学生姓名选课总数所有课程的总成绩没成绩的显示为查询李姓老师的数量查询学过张三老师授课的同学信息难度系数查询没有学全所有课程的同学的信息查询至少有一门课学号与的同学所学相同的同学信息查询和号同学学习的课程完全相同的其他同学的信息查询没学过张三老师讲授的任一门课程的学生姓名查询两门及其以上不及格课程的同学的学号姓名及其平均成绩检索课程分数小于按分数降序排列的学生信息按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩查询各科成绩最高分最低分和平均分按各科成绩进行排名并显示排名重复时继续排序查询学生的总成绩并进行排名总分重复时保留名次空缺统计各科成绩分数段人数课程编号课程名称及所占百分比查询各科成绩前三名的记录查询每门课程被选修的学生数查询出只选修两门课程的学生学号和姓名查询男生女生人数查询名字中含有风字的学生信息查询同名同姓学生名单并统计同名同性人数查询年出生的学生名单查询每门课程的平均成绩结果按平均成绩降序排列平均成绩相同按课程编号升序排列查询平均成绩大于等于的所有学生的学号姓名和平均成绩查询课程名称为数学且分数低于的学生姓名和分数查询所有学生的课程及分数情况存在学生没成绩没选课的情况查询任何一门课程成绩在分以上的姓名课程名称和分数查询不及格的课程查询课程编号为且课程成绩在分以上的学生的学号和姓名求每门课程的学生人数假设成绩不重复查询选修张三老师所授课程的学生中成绩最高的学生信息及成绩假设成绩有重复查询选修张三老师所授课程的学生中成绩最高的学生信息及成绩查询不同课程成绩相同的学生的学生编号课程编号学生成绩查询每门科目成绩最好的前两名查询存在课程但可能不存在课程的情况不存在时显示为查询不存在课程但存在课程的学生情况的一个使用技巧查询没有学全所有课程的同学的信息选课数目选课数目查询至少有一门课学号与的同学所学相同的同学信息查询和号同学学习的课程完全相同的其他同学的信息按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩变量的使用按各科成绩进行排名并显示排名重复时继续排序它这个使用变量的方法也不对如图片自定义变量定义变量用来标识变量使用变量定义并使用变量修改或者重新赋值变量的使用查询学生的总成绩并进行排名总分重复时保留名次空缺区域段统计各科成绩分数段人数课程编号课程名称及所占百分比课程编号课程名称选修人数查询名字中含有风字的学生信息风变量的使用假设成绩不重复查询选修张三老师所授课程的学生中成绩最高的学生信息及成绩法一张三法二先查询张三老师所带的课程编号和张三将以上结果与成绩表关联张三将以上结果与学生表关联学号学生姓名课程教师姓名成绩张三变量的使用假设成绩有重复查询选修张三老师所授课程的学生中成绩最高的学生信息及成绩张三张三按照出生日期来算当前月日出生年月的月日则年龄减一查询本周过生日的学生分析使用函数查询本月过生日的学生分析使用函数查询下月过生日的学生案例二字段名学生编号学生姓名出生年月学生性别字段名科目编号科目名称任课老师编号字段名任课教师标号任课老师姓名字段名学生编号科目编号成绩查询课程比课程成绩高的学生的信息及课程分数查询同时存在课程和课程的情况查询存在课程但可能不存在课程的情况不存在时显示为查询不存在课程但存在课程的情况查询平均成绩大于等于分的同学的学生编号和学生姓名和平均成绩查询在表存在成绩的学生信息查询所有同学的学生编号学生姓名选课总数所有课程的总成绩没成绩的显示为查有成绩的学生信息查询李姓老师的数量查询学过张三老师授课的同学的信息查询没有学全所有课程的同学的信息查询至少有一门课与学号为的同学所学相同的同学的信息查询和号的同学学习的课程完全相同的其他同学的信息查询没学过张三老师讲授的任一门课程的学生姓名查询两门及其以上不及格课程的同学的学号姓名及其平均成绩检索课程分数小于按分数降序排列的学生信息按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩查询各科成绩最高分最低分和平均分以如下形式显示课程课程最高分最低分平均分及格率中等率优良率优秀率及格为中等为优良为优秀为还要求选修人数查询结果按人数降序排列若人数相同按课程号升序排列按各科成绩进行排序并显示排名重复时保留名次空缺按各科成绩进行排序并显示排名重复时合并名次查询学生的总成绩并进行排名总分重复时保留名次空缺查询学生的总成绩并进行排名总分重复时不保留名次空缺统计各科成绩各分数段人数课程编号课程名称及所占百分比查询各科成绩前三名的记录查询每门课程被选修的学生数查询出只选修两门课程的学生学号和姓名查询男生女生人数查询名字中含有风字的学生信息查询同名同性学生名单并统计同名人数查询年出生的学生名单查询每门课程的平均成绩结果按平均成绩降序排列平均成绩相同时按课程编号升序排列查询平均成绩大于等于的所有学生的学号姓名和平均成绩查询课程名称为数学且分数低于的学生姓名和分数查询所有学生的课程及分数情况存在学生没成绩没选课的情况查询任何一门课程成绩在分以上的姓名课程名称和分数查询不及格的课程查询课程编号为且课程成绩在分以上的学生的学号和姓名求每门课程的学生人数成绩不重复查询选修张三老师所授课程的学生中成绩最高的学生信息及其成绩成绩有重复的情况下查询选修张三老师所授课程的学生中成绩最高的学生信息及其成绩查询不同课程成绩相同的学生的学生编号课程编号学生成绩查询每门功成绩最好的前两名统计每门课程的学生选修人数超过人的课程才统计检索至少选修两门课程的学生学号查询选修了全部课程的学生信息查询各学生的年龄只按年份来算按照出生日期来算当前月日出生年月的月日则年龄减一查询本周过生日的学生查询下周过生日的学生查询本月过生日的学生查询下月过生日的学生外连接实现先查询出选修了张三老师讲授课程的张三与学生表关联筛选出不在以上结果内的张三值得注意及格率中等率优良率优秀率下面那个案例值得注意在上述查询中是最终的排序它确保结果首先按课程号排序然后按分数降序排序如果你只关心排名而不关心最终排序顺序可以省略此子句案例案例变量的使用法一没看懂法二法六值得注意法一学生的总成绩名次排序法二法二法五是的例子但用了这里的数据把行数据理解成是总成绩结果有莫名错误这样接正确了奇怪等同于窗口函数实现的结果法三法二法五是的例子但用了这里的数据把行数据理解成是总成绩法四法二法五是的例子但用了这里的数据把行数据理解成是总成绩法五法二法五是的例子但用了这里的数据把行数据理解成是总成绩法六法二法五是的例子但用了这里的数据把行数据理解成是总成绩错误写法法二法五是的例子但用了这里的数据把行数据理解成是总成绩值得注意不会课程编号课程名称选修人数的作用是将两个字符拼接起来不会好像有点问题学生编号学生姓名选课数量学生编号学生姓名选课数量风姓名性别同名人数这里有错误了变量法一张三法二先查询张三老师所带的课程编号和张三将以上结果与成绩表关联张三将以上结果与学生表关联学号学生姓名课程教师姓名成绩张三也行张三法一选修人数法二选修人数知识点补充列名的区别包含忽略所有列用代表代码行统计时不会忽略列值为包含所有列相当于行数统计时不会忽略列值为列名只包含列名那一列统计时忽略列为某字段为不计数分析使用日期函数进行相减年龄年龄分析日期相减函数参数参数分析使用函数分析使用函数案例精彩用法精彩中位数方法一注意事项排序时用会有排名相同的情况中位数的逻辑了解不论个数是奇数偶数中位数在总数除以和总数除以加之间同一天的第一个电话和最后一个电话难编写一个查询来找出那些们在任意一天的第一个电话和最后一个电话都是和同一个人的这些电话不论是拨打者还是接收者都会被记录结果请放在一个任意次序约束的表中查询结果格式如下所示选出所有在某个时间跟另一个通话的按和每天分组对标号便于找到每天第一个和最后的一通电话某天第一次通话某天最后一次通话对某人某天第一次和最后一次通话的去重计数值为就是题中需求结果注释问题在中注释不应该使用井号在语句的中间部分尤其是在列表或其他语句结构中井号在中通常用于行尾来标记注释的开始直到行末如果您想在语句的某部分添加注释您应该使用两个连字符后跟空格或者如果注释跨越多行您可以使用注释内容修改列数据类型表是该表的主键此表包含了一些学校的容纳能力容纳能力指的是学校能够接纳学生的最大数量表是该表的主键表中每一行表示有名学生在考试中至少获得了分表中的数据在逻辑上是正确的即记录了高的行相比记录了低的行拥有相同或更少的也就是说对于表中的行与行如果那么每年学校会公布学生申请所需的最低分数要求学校根据所有学生的考试成绩来决定其最低分数要求学校希望确保即使每一个满足分数要求的学生都申请该学校学校也有足够的能力接纳每一个学生学校也希望尽可能多的学生能申请该学校学校必须使用在表中的来作为最低分数要求编写一个查询来查询每所学校的最低分数要求如果同时有多个值满足上述要求则选择其中最小的一个如果数据不足以决定最低分数要求那么输出返回的结果表可以按任意顺序排序查询结果格式如下例所示示例输入表表输出解释学校的容纳能力为选择作为最低分数要求因为学校最多会收到份申请这在学校的容纳能力以内学校的容纳能力为可以选择或作为最低分数要求因为学校最多会收到份申请这在学校的容纳能力以内又因为是所有可选项中最小的因此我们选择学校的容纳能力为选择作为最低分数要求因为学校最多会收到份申请这在学校的容纳能力以内给出的数据不足以确定最低分数要求如果选择作为最低分数要求学校可能会收到份申请然而学校的容纳能力只有我们没有关于更高分数的信息因此我们返回问题三个实验平台中每种实验完成的次数请注意每一对实验平台实验名称都应包含在输出中包括平台上实验次数是零的表是这个表的主键是枚举类型的取值是这三种之一也是枚举类型的取值是这三种之一这个表包含有关随机实验人员进行的实验的用于做实验的平台以及实验名称的信息结果可以以任意顺序给出查询的结果如下所示示例输入输出解释在安卓平台上我们只做了一个实验在平台上我们做了一个实验和一个实验在平台上我们做了两个实验和一个实验笛卡尔积架构表是此表的主键列经验是包含一个值高级初级的枚举类型此表的每一行都显示候选人的月薪和经验一家公司想雇佣新员工公司的工资预算是美元公司的招聘标准是雇佣最多的高级员工在雇佣最多的高级员工后使用剩余预算雇佣最多的初级员工编写一个查询查找根据上述标准雇佣的高级员工和初级员工的数量按任意顺序返回结果表查询结果格式如下例所示示例输入输出说明我们可以雇佣名为的高级员工由于预算是万美元他们的工资总额是万美元我们还有万美元但他们不足以雇佣为的高级员工我们可以雇佣名为的初级员工由于剩下的预算是万美元他们的工资总额是万美元我们还有万美元但他们不足以雇佣为的初级员工按分组开窗按生序排列逐一求和然后就是能招聘的员工能招聘的等级员工上下两表拼接就是题中需求能招聘的等级员工自己思路找出高级和低级的生成临时表然后用变量然后对高级和低级临时表的工资逐行加再筛选出低于预备工资的数据得到高级多少人并且一共花多少再和低级临时表连接条件是高级的总工资低级总工资预算得到低级多少人和低级总工资简单简单别人的答案用函数子查询就可以了简单简单但我只想到了是算出比率然后再这里不要用四舍五入简单简单常用积累删除重复邮件保留最小的来自如果不要貌似多余的会报错不允许在语句的子句中直接使用正在被更新的表是表的别名这个语句会删除表中所有满足条件和条件的行所以答案这样写的意思是最终会在中而不是在笛卡尔积的表里是吗日期相关函数返回两个日期之间的时间结果把示例的换成就是按年计算参数参数能干什么可以计算相差天数小时分钟和秒相比于函数要灵活很多格式是时间小的前时间大的放在后面计算相差天数其中处可以是以下值之一从日期增加指定的时间间隔返回的是一个字符串参数是合法的日期表达式参数是您希望添加的时间间隔参数可以是下列值二使用函数为获取当前时间加天当前日期向前推天加小时加分钟加秒加毫秒加周加月加季加年函数可以用来替代略和这两个函数可以查询我们得到的结果集上下偏移相应行数的相应的结果函数查询当前行向上偏移行对应的结果该函数有三个参数第一个为待查询的参数列名第二个为向上偏移的位数第三个参数为超出最上面边界的默认值函数查询当前行向下偏移行对应的结果该函数有三个参数第一个为待查询的参数列名第二个为向下偏移的位数第三个参数为超出最下面边界的默认值函数返回两个日期之间的时间结果把示例的换成就是按年计算一个参数两个参数其实这个实现分页也是可以的分页例如把结果集分页每页条记录要获取第页的记录可以使用上述查询表示对结果集从号记录开始最多取条注意记录集的索引从开始如果要查询第页那么我们只需要跳过头条记录也就是对结果集从号记录开始查询把设定为函数的使用如果的值为则返回的值如果的值不为则返回的值输出结果输出结果函数的使用如果成立那么返回值为否则返回值为的值输出结果输出结果函数的使用如果的值为则返回如果的值不为则返回输出结果输出结果为了解决这个问题提供了和这两个操作符它们专门用于检查字段是否为当我们使用时如果字段的值为查询将返回如果字段的值不是包括字段中有值和字段为空查询将返回同样地用于检查字段值是否不是安全等于可以用于比较同为一个则为其它情况和类似输入表找出那些没有被的客户推荐的客户的姓名法一法二笛卡尔积笛卡尔积中的笛卡尔积是指两个表的所有可能的组合当两个表没有关联条件时数据库系统会对这两个表进行笛卡尔积操作这会导致性能下降和资源浪费为了优化笛卡尔积操作不是下标为开始新奇这里的是截取的不能再后面截取截取后也不能重命名这里能因为这里同分组下相同自定义变量表和一样的都是笛卡尔积窗口函数你要的操作用于分组的列名按序叠加的列名窗口滑动的数据范围窗口滑动的数据范围用来限定你要的操作所运用的数据的范围具体有如下这些当前行之前的行之后的行无界限表示从前面的起点表示到后面的终点举例理解一下取当前行和前五行共行取当前行和后五行共行取前五行和后五行共行语句格式一语句在执行时将后的表达式的值与各子句的表达式值比较如果相等则执行后面的表达式或语句然后跳出语句否则返回后面的表达式语句格式二后面没有表达式多个子句中的表达式依次执行如果表达式结果为真则执行相应关键字后面的表达式或语句执行完毕之后跳出语句如果所有语句都为则执行子句中的语句小在交换数据和列转行时可以考虑使用语句可以指定自定义的分隔符不指定的情况下默认是正则表达式语句中符号表示连接符比如其结果就是关闭模式的弊端结果的不确定性关闭可能导致分组查询返回不确定的结果特别是当列表中包含非聚合列且这些列没有包含在子句中时将从每个分组中任意选择一个值作为结果这可能导致结果难以预测和解释调试复杂性在没有的约束下编写的查询可能在逻辑上不那么明确尤其是当查询变得复杂时这可能使得调试和维护查询变得更加困难性能问题虽然不是直接结果但关闭并依赖从分组中随机选择数据可能导致查询效率不是最优的特别是在处理大量数据时标准的偏离更接近于标准对分组操作的定义关闭它可能意味着编写的在其他遵循标准的数据库系统中可能不会工作或者产生不同的结果行转列列转行行转列一般使用或语句聚合函数而列转行一般使用多个查询的方法尚硅谷大数据技术之数据湖尚硅谷大数据技术之数据湖左右外连接当连接键不唯一时还是可以正常连接不用去笛卡尔积然后过滤尚硅谷大数据技术之数据湖尚硅谷大数据技术之数据湖全外连接不支持可以用实现这里需要去重和会去重不会去重从索引开始读取个含义是跳过条取出条数据后面是从第条开始读读取条信息即读取第条数据含义是从下标开始取出条数据后面跟的是条数据即读取第条我们在设计列族的时候可以把经常读取的列存储到一个列族中不经常读取的列放到另一个列族中这样我们在读取部分列的数据的时候就只需要读取对应列族文件中的数据提高读取效率在中数据块大小和大小是两个不同的概念它们具有不同的功能和调整目的数据块大小主要影响中的数据存储和访问性能数据块由多个对集合组成每个数据块的大小在创建表的列族时可以指定数据块大小的设定影响数据块索引的大小数据块越小索引越大从而占用更大内存空间因此在随机查找性能和数据块索引内存占用之间需要权衡如果需要更好的随机查找性能可以将数据块设置为较小的值而如果需要更好的序列扫描性能则可以考虑增大数据块的大小而是中用于保存修改数据即对的内存结构当的大小达到一个阈值默认是时会被到文件即以释放内存空间的大小设置主要影响的写入性能和内存使用如果太小可能导致频繁的操作影响写入性能如果太大则可能消耗过多的内存资源因此数据块大小和大小不一样它们是中两个不同的参数需要根据具体的应用场景和性能需求进行独立调整',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-03 23:21:30',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Tech智汇站</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/ChatGPT/" style="font-size: 1.05rem;">ChatGPT<sup>1</sup></a><a href="/tags/CloudFlare/" style="font-size: 1.05rem;">CloudFlare<sup>2</sup></a><a href="/tags/EScrcpy/" style="font-size: 1.05rem;">EScrcpy<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 1.05rem;">GitHub<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 1.05rem;">NodeJs<sup>1</sup></a><a href="/tags/PowerToys/" style="font-size: 1.05rem;">PowerToys<sup>1</sup></a><a href="/tags/US-KG/" style="font-size: 1.05rem;">US.KG<sup>1</sup></a><a href="/tags/Vip%E8%A7%86%E9%A2%91/" style="font-size: 1.05rem;">Vip视频<sup>1</sup></a><a href="/tags/seal/" style="font-size: 1.05rem;">seal<sup>1</sup></a><a href="/tags/yt-dlp/" style="font-size: 1.05rem;">yt-dlp<sup>1</sup></a><a href="/tags/%E4%BC%91%E7%9C%A0/" style="font-size: 1.05rem;">休眠<sup>1</sup></a><a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size: 1.05rem;">免费<sup>3</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 1.05rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8A%9F%E8%83%BD%E9%9B%86%E5%90%88%E8%BD%AF%E4%BB%B6/" style="font-size: 1.05rem;">功能集合软件<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 1.05rem;">域名<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E6%89%98%E7%AE%A1/" style="font-size: 1.05rem;">域名托管<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E7%94%B3%E8%AF%B7/" style="font-size: 1.05rem;">域名申请<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 1.05rem;">大数据<sup>26</sup></a><a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">大模型<sup>1</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 1.05rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%AE%9E%E6%97%B6%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 1.05rem;">实时语音转文字<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 1.05rem;">廖雪峰<sup>7</sup></a><a href="/tags/%E6%89%8B%E6%9C%BA%E6%8A%95%E5%B1%8F/" style="font-size: 1.05rem;">手机投屏<sup>1</sup></a><a href="/tags/%E6%B3%A8%E9%94%80/" style="font-size: 1.05rem;">注销<sup>1</sup></a><a href="/tags/%E7%94%B5%E9%87%8F%E6%98%BE%E7%A4%BA/" style="font-size: 1.05rem;">电量显示<sup>1</sup></a><a href="/tags/%E7%9D%A1%E7%9C%A0/" style="font-size: 1.05rem;">睡眠<sup>1</sup></a><a href="/tags/%E7%A3%81%E5%8A%9B/" style="font-size: 1.05rem;">磁力<sup>1</sup></a><a href="/tags/%E7%A3%81%E5%8A%9B%E6%90%9C%E7%B4%A2/" style="font-size: 1.05rem;">磁力搜索<sup>1</sup></a><a href="/tags/%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87/" style="font-size: 1.05rem;">蓝牙设备<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E8%BA%AB%E4%BB%BD%E7%94%9F%E6%88%90/" style="font-size: 1.05rem;">虚拟身份生成<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90/" style="font-size: 1.05rem;">视频解析<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%BD%AC%E5%AD%97%E5%B9%95/" style="font-size: 1.05rem;">视频转字幕<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%87%8D%E5%90%AF/" style="font-size: 1.05rem;">重启<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.05rem;">面试<sup>12</sup></a><a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 1.05rem;">音视频转文字<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">109</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/" itemprop="url">求职</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/%E9%9D%A2%E8%AF%95/" itemprop="url">面试</a></span></div></div><h1 class="post-title" itemprop="name headline">面试 数据库常见面试问题？</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="post-meta-icon anzhiyufont anzhiyu-icon-calendar-days"></i><span class="post-meta-label">发表于</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="发表于 2025-01-17 17:35:02">2025-01-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%EF%BC%9F/"><header><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/" itemprop="url">求职</a><a class="post-meta-categories" href="/categories/%E6%B1%82%E8%81%8C/%E9%9D%A2%E8%AF%95/" itemprop="url">面试</a><h1 id="CrawlerTitle" itemprop="name headline">面试 数据库常见面试问题？</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">智汇君</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="undefined 2025-01-17 17:35:02">2025-01-17</time></header><h1 id="数据库常见面试问题？"><a href="#数据库常见面试问题？" class="headerlink" title="数据库常见面试问题？"></a>数据库常见面试问题？</h1><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><h3 id="课程"><a href="#课程" class="headerlink" title="课程"></a>课程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">常用的存储引擎？InnoDB与MyISAM的区别？</span><br><span class="line"></span><br><span class="line">什么是事务,以及事务的四大特性?</span><br><span class="line"></span><br><span class="line">事务的隔离级别有哪些,MySQL默认是哪个?</span><br><span class="line"></span><br><span class="line">内连接与左外连接的区别是什么?</span><br><span class="line"></span><br><span class="line">MySQL默认InnoDB引擎的索引是什么数据结构?</span><br><span class="line"></span><br><span class="line">如何查看MySQL的执行计划?</span><br><span class="line"></span><br><span class="line">索引失效的情况有哪些?</span><br><span class="line"></span><br><span class="line">什么是回表查询?</span><br><span class="line"></span><br><span class="line">什么是MVCC?</span><br><span class="line"></span><br><span class="line">MySQL主从复制的原理是什么?</span><br><span class="line"></span><br><span class="line">主从复制之后的读写分离如何实现?</span><br><span class="line"></span><br><span class="line">数据库的分库分表如何实现?</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SQL性能优化经验</span><br><span class="line"></span><br><span class="line">1.sql优化大多依赖索引进行</span><br><span class="line">2.聚集索引和二级索引对于理解sql优化很关键(能使用聚集使用过滤就不使用二级索引，效率更高)</span><br><span class="line">3.满足业务需求的情况下，尽量降低主键的长度 --因为二级索引叶子节点会存储主键，会导致索引数据大</span><br><span class="line">插入数据时，尽量选择顺序插入，选择使用AUTO_INCREMENT自增主键。 --避免页分裂</span><br><span class="line">尽量不要使用UUID做主键或者是其他自然主键，如身份证号  --长度长且无序</span><br><span class="line">4.load data批量插入数据</span><br><span class="line">5.sql执行频率</span><br><span class="line">6.慢查询</span><br><span class="line">7.执行计划</span><br><span class="line">8.profile详情</span><br><span class="line"></span><br><span class="line">可以从这几个维度回答这个问题：</span><br><span class="line">加索引</span><br><span class="line">避免返回不必要的数据</span><br><span class="line">适当分批量进行</span><br><span class="line">优化sql结构</span><br><span class="line">分库分表</span><br><span class="line">读写分离</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">数据库优化经验</span><br><span class="line"></span><br><span class="line">四五千万条记录时，就可能要考虑分库分表了，这是运维篇的内容</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">建立索引的优劣势</span><br><span class="line"></span><br><span class="line">优缺点</span><br><span class="line">优势</span><br><span class="line">提高数据检索的效率，降低数据库的IO成本</span><br><span class="line">通过索引列对数据进行排序，降低数据排序的成本，降低CPU的消耗。</span><br><span class="line"></span><br><span class="line">劣势</span><br><span class="line">索引列也是要占用空间的</span><br><span class="line">索引大大提高了查询效率，同时却也降低更新表的速度，如对表进行INSERT、UPDATE、DELETE时，效率降低。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">为什么InnoDB存储引擎选择使用B+tree索引结构?</span><br><span class="line"></span><br><span class="line">相对于二叉树，层级更少，搜索效率高;</span><br><span class="line">对于B-tree，无论是叶子节点还是非叶子节点，都会保存数据，这样导致一页中存储的键值减少，指针跟着减少，要同样保存大量数据，只能增加树的高度，导致性能降低</span><br><span class="line">相对Hash索引，B+tree支持范围匹配及排序操作</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">估算主键索引树2，3层时，大概能存储多少行数据？</span><br><span class="line"></span><br><span class="line">只要给出主键什么类型，多大，然后一行数据多大？就可以估算</span><br><span class="line">1.先算一个页最大能存储多少个主键 2.然后算出指针数，再乘以一个页最大能存储多少行数据就行</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MySQL 索引使用有哪些注意事项呢？</span><br><span class="line"></span><br><span class="line">讲的10条</span><br><span class="line">+</span><br><span class="line">在索引列上使用mysql的内置函数，索引失效。</span><br><span class="line">对索引列运算（如，+、-、*、/），索引失效。</span><br><span class="line">索引字段上使用（！= 或者 &lt; &gt;，not in）时，可能会导致索引失效。</span><br><span class="line">左连接查询或者右连接查询查询关联的字段编码格式不一样，可能导致索引失效。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">索引不适合哪些场景</span><br><span class="line"></span><br><span class="line">数据量少的不适合加索引</span><br><span class="line">更新比较频繁的也不适合加索引</span><br><span class="line">区分度低的字段不适合加索引（如性别）</span><br><span class="line"></span><br><span class="line">针对于数据量较大(300w条)，且查询比较频繁的表建立索引。</span><br><span class="line">针对于常作为查询条件(where)、排序 (order by)、分组 (group by)操作的字段建立索引。</span><br><span class="line">尽量选择区分度高的列作为索引，尽量建立唯一索引，区分度越高，使用索引的效率越高。</span><br><span class="line">如果是字符串类型的字段，字段的长度较长，可以针对于字段的特点，建立前缀索引。</span><br><span class="line">尽量使用联合索引，减少单列索引，查询时，联合索引很多时候可以覆盖索引，节省存储空间，避免回表，提高查询效率。要控制素引的数量，索引并不是多多益善，索引越多，维护索引结构的代价也就越大，会影响增删改的效率。</span><br><span class="line">如果索引列不能存储NULL值，请在创建表时使用NOT NULL约束它。当优化器知道每列是否包含NULL值时，它可以更好地确定哪个索引最有效地用于查询。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MySQL 遇到过死锁问题吗，你是如何解决的？</span><br><span class="line">我排查死锁的一般步骤是酱紫的：</span><br><span class="line"></span><br><span class="line">查看死锁日志show engine innodb status;</span><br><span class="line">找出死锁Sql</span><br><span class="line">分析sql加锁情况</span><br><span class="line">模拟死锁案发</span><br><span class="line">分析死锁日志</span><br><span class="line">分析死锁结果</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">聚集索引与非聚集索引的区别</span><br></pre></td></tr></table></figure>

<h3 id="稀土掘金"><a href="#稀土掘金" class="headerlink" title="稀土掘金"></a>稀土掘金</h3><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904166939164680">url</a></p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904177261363213">url</a></p>
<h4 id="什么是幻读，脏读，不可重复读呢？"><a href="#什么是幻读，脏读，不可重复读呢？" class="headerlink" title="什么是幻读，脏读，不可重复读呢？"></a>什么是幻读，脏读，不可重复读呢？</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">脏读  x</span><br><span class="line">幻读  数据量不一样</span><br><span class="line">不可重复读 数据值不一样</span><br></pre></td></tr></table></figure>

<h4 id="limit-1000000-加载很慢的话，你是怎么解决的呢？"><a href="#limit-1000000-加载很慢的话，你是怎么解决的呢？" class="headerlink" title="limit 1000000 加载很慢的话，你是怎么解决的呢？"></a>limit 1000000 加载很慢的话，你是怎么解决的呢？</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">方案一：如果id是连续的，可以这样，返回上次查询的最大记录(偏移量)，再往下limit</span><br><span class="line">复制代码select id，name from employee where id&gt;1000000 limit 10.</span><br><span class="line"></span><br><span class="line">方案二：在业务允许的情况下限制页数：</span><br><span class="line">建议跟业务讨论，有没有必要查这么后的分页啦。因为绝大多数用户都不会往后翻太多页。</span><br><span class="line"></span><br><span class="line">方案三：order by + 索引（id为索引）</span><br><span class="line">复制代码select id，name from employee order by id  limit 1000000，10</span><br><span class="line"></span><br><span class="line">方案四：利用延迟关联或者子查询优化超多分页场景。（先快速定位需要获取的id段，然后再关联）</span><br><span class="line">复制代码SELECT a.* FROM employee a, (select id from employee where 条件 LIMIT 1000000,10 ) b where a.id=b.id</span><br></pre></td></tr></table></figure>

<h4 id="在高并发情况下，如何做到安全的修改同一行数据？"><a href="#在高并发情况下，如何做到安全的修改同一行数据？" class="headerlink" title="在高并发情况下，如何做到安全的修改同一行数据？"></a>在高并发情况下，如何做到安全的修改同一行数据？</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要安全的修改同一行数据，就要保证一个线程在修改时其它线程无法更新这行记录。一般有悲观锁和乐观锁两种方案~</span><br></pre></td></tr></table></figure>

<h5 id="使用悲观锁"><a href="#使用悲观锁" class="headerlink" title="使用悲观锁"></a>使用悲观锁</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">悲观锁思想就是，当前线程要进来修改数据时，别的线程都得拒之门外~</span><br><span class="line">比如，可以使用select…for update ~</span><br><span class="line">select * from User where name=‘jay’ for update</span><br><span class="line">update xxx</span><br><span class="line"></span><br><span class="line">以上这条sql语句会锁定了User表中所有符合检索条件（name=‘jay’）的记录。本次事务提交之前，别的线程都无法修改这些记录。</span><br></pre></td></tr></table></figure>

<h5 id="使用乐观锁"><a href="#使用乐观锁" class="headerlink" title="使用乐观锁"></a>使用乐观锁</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">乐观锁思想就是，有线程过来，先放过去修改，如果看到别的线程没修改过，就可以修改成功，如果别的线程修改过，就修改失败或者重试。实现方式：乐观锁一般会使用版本号机制或CAS算法实现。</span><br></pre></td></tr></table></figure>

<h4 id="CSDN案例"><a href="#CSDN案例" class="headerlink" title="CSDN案例"></a>CSDN案例</h4><h5 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42444823/article/details/122565671">csdn链接</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># 学生表 Student：</span><br><span class="line"> </span><br><span class="line">create table Student(</span><br><span class="line"> </span><br><span class="line">SId varchar(10) ,</span><br><span class="line"> </span><br><span class="line">Sname varchar(10),</span><br><span class="line"> </span><br><span class="line">Sage datetime,</span><br><span class="line"> </span><br><span class="line">Ssex varchar(10));</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 教师表 Teacher</span><br><span class="line"> </span><br><span class="line">create table Teacher(</span><br><span class="line"> </span><br><span class="line">TId varchar(10),</span><br><span class="line"> </span><br><span class="line">Tname varchar(10)); </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 科目表 Course</span><br><span class="line"> </span><br><span class="line">create table Course(</span><br><span class="line"> </span><br><span class="line">CId varchar(10),</span><br><span class="line"> </span><br><span class="line">Cname nvarchar(10),</span><br><span class="line"> </span><br><span class="line">TId varchar(10)); </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 成绩表 SC</span><br><span class="line"> </span><br><span class="line">create table SC(</span><br><span class="line"> </span><br><span class="line">SId varchar(10),</span><br><span class="line"> </span><br><span class="line">CId varchar(10),</span><br><span class="line"> </span><br><span class="line">score decimal(18,1)); </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.1查询同时存在01课程和02课程的情况</span><br><span class="line"></span><br><span class="line">1.2查询存在01课程但可能不存在02课程的情况（不存在时显示为null）</span><br><span class="line"></span><br><span class="line">1.3查询不存在01课程但存在02课程的学生情况</span><br><span class="line"></span><br><span class="line">2.0查询平均成绩大于等于60分的学生编号和学生姓名和平均成绩</span><br><span class="line"></span><br><span class="line">3.0查询在sc表存在成绩的学生信息</span><br><span class="line"></span><br><span class="line">4.0查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩（没成绩的显示为nulll）</span><br><span class="line"></span><br><span class="line">5.0查询[李]姓老师的数量</span><br><span class="line"></span><br><span class="line">6.0查询学过[张三]老师授课的同学信息(难度系数★★★)</span><br><span class="line"></span><br><span class="line">7.0查询没有学全所有课程的同学的信息</span><br><span class="line"></span><br><span class="line">8.0查询至少有一门课学号与01的同学所学相同的同学信息</span><br><span class="line"></span><br><span class="line">9.0查询和01号同学学习的课程完全相同的其他同学的信息</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">10.查询没学过[张三]老师讲授的任一门课程的学生姓名</span><br><span class="line"></span><br><span class="line">11.查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</span><br><span class="line"></span><br><span class="line">12.检索01课程分数小于60，按分数降序排列的学生信息</span><br><span class="line"></span><br><span class="line">13.按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩1</span><br><span class="line"></span><br><span class="line">14.查询各科成绩最高分、最低分和平均分</span><br><span class="line"></span><br><span class="line">15.按各科成绩进行排名，并显示排名，score重复时继续排序</span><br><span class="line"></span><br><span class="line">16.查询学生的总成绩，并进行排名，总分重复时保留名次空缺</span><br><span class="line"></span><br><span class="line">17.统计各科成绩分数段人数，课程编号，课程名称，[100-85][85-70][70-60][60-0]及所占百分比</span><br><span class="line"></span><br><span class="line">18.查询各科成绩前三名的记录</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">19.查询每门课程被选修的学生数</span><br><span class="line"></span><br><span class="line">20.查询出只选修两门课程的学生学号和姓名</span><br><span class="line"></span><br><span class="line">21.查询男生、女生人数</span><br><span class="line"></span><br><span class="line">22.查询名字中含有[风]字的学生信息</span><br><span class="line"></span><br><span class="line">23.查询同名同姓学生名单，并统计同名同性人数</span><br><span class="line"></span><br><span class="line">24.查询1990年出生的学生名单</span><br><span class="line"></span><br><span class="line">25.查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同，按课程编号升序排列</span><br><span class="line"></span><br><span class="line">26.查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩</span><br><span class="line"></span><br><span class="line">27.查询课程名称为[数学]，且分数低于60的学生姓名和分数</span><br><span class="line"></span><br><span class="line">28.查询所有学生的课程及分数情况（存在学生没成绩没选课的情况）</span><br><span class="line"></span><br><span class="line">29.查询任何一门课程成绩在70分以上的姓名、课程名称和分数</span><br><span class="line"></span><br><span class="line">30.查询不及格的课程 </span><br><span class="line"></span><br><span class="line">31.查询课程编号为01且课程成绩在80分以上的学生的学号和姓名 </span><br><span class="line"></span><br><span class="line">32.求每门课程的学生人数 </span><br><span class="line"></span><br><span class="line">33.假设成绩不重复，查询选修[张三]老师所授课程的学生中，成绩最高的学生信息及成绩 </span><br><span class="line"></span><br><span class="line">34.假设成绩有重复，查询选修[张三]老师所授课程的学生中，成绩最高的学生信息及成绩 </span><br><span class="line"></span><br><span class="line">35.查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩 </span><br><span class="line"></span><br><span class="line">36.查询每门科目成绩最好的前两名 </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h6 id="1-2"><a href="#1-2" class="headerlink" title="1.2"></a>1.2</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">查询存在01课程但可能不存在02课程的情况（不存在时显示为null）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM (SELECT * FROM sc WHERE cid = &#x27;01&#x27;) a</span><br><span class="line">LEFT JOIN sc </span><br><span class="line">ON a.sid = sc.sid AND sc.cid = &#x27;02&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----</span><br><span class="line">SELECT *</span><br><span class="line">FROM (SELECT * FROM sc WHERE cid = &#x27;01&#x27;) a</span><br><span class="line">LEFT JOIN (SELECT * FROM sc WHERE cid = &#x27;02&#x27;) b</span><br><span class="line">ON a.sid = b.sid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">SELECT *</span><br><span class="line">FROM sc a</span><br><span class="line">LEFT JOIN sc b</span><br><span class="line">ON a.sid = b.sid AND b.cid = &#x27;02&#x27;</span><br><span class="line">WHERE a.cid = &#x27;01&#x27;;</span><br></pre></td></tr></table></figure>

<h6 id="1-3"><a href="#1-3" class="headerlink" title="1.3"></a>1.3</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查询不存在01课程但存在02课程的学生情况</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM sc s1</span><br><span class="line">WHERE s1.CId=&#x27;02&#x27; AND s1.SId not in (</span><br><span class="line">SELECT s2.SId</span><br><span class="line">FROM sc s2</span><br><span class="line">WHERE s2.CId=&#x27;01&#x27;);</span><br></pre></td></tr></table></figure>

<h6 id="7-having的一个使用技巧"><a href="#7-having的一个使用技巧" class="headerlink" title="7 having的一个使用技巧"></a>7 having的一个使用技巧</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查询没有学全所有课程的同学的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT SC.SId,COUNT(cid) 选课数目</span><br><span class="line">			FROM sc</span><br><span class="line">			GROUP BY sid</span><br><span class="line">			HAVING 选课数目 &lt; (SELECT COUNT(cid)FROM course c)</span><br></pre></td></tr></table></figure>

<h6 id="8"><a href="#8" class="headerlink" title="8"></a>8</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">查询至少有一门课学号与01的同学所学相同的同学信息</span><br><span class="line"></span><br><span class="line">SELECT DISTINCT a.*</span><br><span class="line">FROM student a</span><br><span class="line">INNER JOIN (SELECT *</span><br><span class="line">			FROM sc</span><br><span class="line">			WHERE cid IN (SELECT cid FROM sc WHERE sid = &quot;01&quot;)) b</span><br><span class="line">ON a.sid = b.sid;</span><br><span class="line"> </span><br><span class="line">----</span><br><span class="line">SELECT DISTINCT s.*</span><br><span class="line">FROM sc</span><br><span class="line">INNER JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">WHERE sc.cid IN (SELECT cid FROM sc WHERE sid = &quot;01&quot;);</span><br></pre></td></tr></table></figure>





<h6 id="9"><a href="#9" class="headerlink" title="9"></a>9</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">查询和01号同学学习的课程完全相同的其他同学的信息</span><br><span class="line"></span><br><span class="line">SELECT SId,COUNT(*) num</span><br><span class="line">FROM </span><br><span class="line">(</span><br><span class="line">SELECT s1.SId,s1.CId</span><br><span class="line">FROM sc s1</span><br><span class="line">INNER JOIN</span><br><span class="line">(</span><br><span class="line">SELECT sc.*</span><br><span class="line">FROM sc</span><br><span class="line">WHERE sc.SId=&#x27;01&#x27;) s2</span><br><span class="line">WHERE s1.CId=s2.CId</span><br><span class="line">) t</span><br><span class="line">GROUP BY SId</span><br><span class="line">HAVING num = (SELECT COUNT(*) FROM sc WHERE sc.SId=&#x27;01&#x27;)</span><br></pre></td></tr></table></figure>

<h6 id="13"><a href="#13" class="headerlink" title="13"></a>13</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM sc s1</span><br><span class="line">INNER JOIN</span><br><span class="line">(</span><br><span class="line">SELECT SId,AVG(score) as avg</span><br><span class="line">FROM sc</span><br><span class="line">GROUP BY SId</span><br><span class="line">) s2</span><br><span class="line">on s1.SId=s2.SId</span><br><span class="line">ORDER BY avg DESC,s1.SId</span><br></pre></td></tr></table></figure>

<h6 id="15-变量的使用"><a href="#15-变量的使用" class="headerlink" title="15  变量的使用"></a>15  变量的使用</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">按各科成绩进行排名，并显示排名，score重复时继续排序</span><br><span class="line"></span><br><span class="line">SELECT sc.* ,DENSE_RANK() over(PARTITION by CId ORDER BY score DESC) r</span><br><span class="line">FROM sc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----  它这个使用变量的方法也不对 如图片</span><br><span class="line">SELECT sid,</span><br><span class="line">	   cid,</span><br><span class="line">	   score,</span><br><span class="line">	   @rank:=@rank+1 as rk</span><br><span class="line">FROM sc,(SELECT @rank:=0) as t</span><br><span class="line">ORDER BY score DESC;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">-- 自定义变量 --</span><br><span class="line"># ① 定义变量 set @a:=2 (@用来标识变量),使用变量select @a</span><br><span class="line"># ② 定义并使用变量 select @b:=4 </span><br><span class="line"># 修改或者重新赋值 select @b:=6</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202410130953637.png" alt="image-20241013095305533"></p>
<h6 id="16-dense-rank-变量的使用"><a href="#16-dense-rank-变量的使用" class="headerlink" title="16 dense_rank()   变量的使用"></a>16 dense_rank()   变量的使用</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">查询学生的总成绩，并进行排名，总分重复时保留名次空缺</span><br><span class="line"></span><br><span class="line">SELECT SId,totalscore,DENSE_RANK()over(ORDER BY totalscore DESC) r</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT SId,SUM(score) totalscore</span><br><span class="line">FROM sc</span><br><span class="line">GROUP BY SId</span><br><span class="line">) t</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.*,</span><br><span class="line">		@rank:=IF(@sco=sum_score,@rank+0,@rank+1) rk</span><br><span class="line">FROM (SELECT sid,</span><br><span class="line">			 SUM(score) sum_score</span><br><span class="line">	  FROM sc</span><br><span class="line">	  GROUP BY sid</span><br><span class="line">	  ORDER BY sum_score DESC) a,(select @sco:=null,@rank:=0) b</span><br></pre></td></tr></table></figure>

<h6 id="17-区域段-case-when-then-concat"><a href="#17-区域段-case-when-then-concat" class="headerlink" title="17 区域段 case when then  concat"></a>17 区域段 case when then  concat</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">统计各科成绩分数段人数，课程编号，课程名称，[100-85][85-70][70-60][60-0]及所占百分比</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT sc.CId 课程编号,c.Cname 课程名称,COUNT(1) 选修人数</span><br><span class="line">	   ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;=0 AND sc.score &lt;= 60 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(0-60]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;=60 AND sc.score &lt;= 70 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(60-70]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;= 70 AND sc.score &lt;= 85 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(70-85]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;= 85 AND sc.score &lt;= 100 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(85-100]&#x27;</span><br><span class="line">FROM sc</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON sc.cId = c.CId</span><br><span class="line">GROUP BY sc.CId,c.Cname</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="22-like"><a href="#22-like" class="headerlink" title="22 like"></a>22 like</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查询名字中含有[风]字的学生信息</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM student </span><br><span class="line">WHERE sname LIKE &#x27;%风%&#x27;;</span><br></pre></td></tr></table></figure>

<h6 id="25"><a href="#25" class="headerlink" title="25"></a>25</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT CId,AVG(score) avg</span><br><span class="line">FROM sc</span><br><span class="line">GROUP BY CId</span><br><span class="line">ORDER BY avg desc,CId</span><br></pre></td></tr></table></figure>

<h6 id="33-变量的使用-limit"><a href="#33-变量的使用-limit" class="headerlink" title="33 变量的使用 limit"></a>33 变量的使用 limit</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">假设成绩不重复，查询选修[张三]老师所授课程的学生中，成绩最高的学生信息及成绩 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 法一</span><br><span class="line">SELECT *</span><br><span class="line">FROM teacher t</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON t.tid = c.tid</span><br><span class="line">LEFT JOIN sc</span><br><span class="line">ON c.cid = sc.cid</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON s.sid = sc.sid</span><br><span class="line">WHERE t.tname = &quot;张三&quot;</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1;</span><br><span class="line"> </span><br><span class="line"># 法二</span><br><span class="line">-- 1.先查询[张三]老师所带的课程编号cid和tid --</span><br><span class="line">SELECT *</span><br><span class="line">FROM teacher t</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON t.tid = c.tid</span><br><span class="line">WHERE t.tname = &quot;张三&quot;;</span><br><span class="line">-- 2.将以上结果与成绩表sc关联 --</span><br><span class="line">SELECT sc.sid,a.cid,a.cname,a.tname,sc.score</span><br><span class="line">FROM (SELECT t.tid,t.tname,c.cid,c.cname</span><br><span class="line">	  FROM teacher t</span><br><span class="line">	  LEFT JOIN course c</span><br><span class="line">	  ON t.tid = c.tid</span><br><span class="line">	  WHERE t.tname = &quot;张三&quot;) a </span><br><span class="line">LEFT JOIN sc</span><br><span class="line">ON a.cid = sc.cid</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1;</span><br><span class="line">-- 3.将以上结果与学生表student关联 --</span><br><span class="line">SELECT s.sid 学号,s.sname 学生姓名,a.cname 课程,a.tname 教师姓名,a.score 成绩</span><br><span class="line">FROM (SELECT sc.sid,a.cid,a.cname,a.tname,sc.score</span><br><span class="line">	  FROM (SELECT t.tid,t.tname,c.cid,c.cname</span><br><span class="line">			FROM teacher t</span><br><span class="line">			LEFT JOIN course c</span><br><span class="line">			ON t.tid = c.tid</span><br><span class="line">			WHERE t.tname = &quot;张三&quot;) a </span><br><span class="line">		LEFT JOIN sc</span><br><span class="line">		ON a.cid = sc.cid</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1) a</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON a.sid = s.sid;</span><br></pre></td></tr></table></figure>



<h6 id="34-变量的使用"><a href="#34-变量的使用" class="headerlink" title="34  变量的使用"></a>34  变量的使用</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">假设成绩有重复，查询选修[张三]老师所授课程的学生中，成绩最高的学生信息及成绩 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SET @score:=NULL,@rank:=0;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM </span><br><span class="line">(SELECT a.*,</span><br><span class="line">		CASE WHEN @score=score THEN @rank</span><br><span class="line">			 ELSE @score:=score AND @rank:=@rank+1 END rk</span><br><span class="line">FROM </span><br><span class="line">(SELECT s.sid,s.sname,sc.score,c.cid,c.cname</span><br><span class="line"> FROM teacher t</span><br><span class="line"> LEFT JOIN course c</span><br><span class="line"> ON t.tid = c.tid</span><br><span class="line"> LEFT JOIN sc</span><br><span class="line"> ON c.cid = sc.cid</span><br><span class="line"> LEFT JOIN student s</span><br><span class="line"> ON s.sid = sc.sid</span><br><span class="line"> WHERE t.tname = &quot;张三&quot;) a) s</span><br><span class="line"> ORDER BY rk DESC</span><br><span class="line">LIMIT 1;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM </span><br><span class="line">(SELECT a.*,</span><br><span class="line">		CASE WHEN @score=score THEN @rank</span><br><span class="line">			 ELSE @score:=score AND @rank:=@rank+1 END rk</span><br><span class="line">FROM </span><br><span class="line">(SELECT s.sid,s.sname,sc.score,c.cid,c.cname</span><br><span class="line"> FROM teacher t</span><br><span class="line"> LEFT JOIN course c</span><br><span class="line"> ON t.tid = c.tid</span><br><span class="line"> LEFT JOIN sc</span><br><span class="line"> ON c.cid = sc.cid</span><br><span class="line"> LEFT JOIN student s</span><br><span class="line"> ON s.sid = sc.sid</span><br><span class="line"> WHERE t.tname = &quot;张三&quot;) a,(SELECT @score:=NULL,@rank:=0) t) s</span><br><span class="line"> ORDER BY rk DESC</span><br><span class="line">LIMIT 1;</span><br></pre></td></tr></table></figure>

<h6 id="41-current-day-substring-year-now"><a href="#41-current-day-substring-year-now" class="headerlink" title="41 current_day(),substring(),year(),now()"></a>41 current_day(),substring(),year(),now()</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">current_day()	2024-10-14</span><br><span class="line"></span><br><span class="line">now()	2024-10-14 11:01:11</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">按照出生日期来算，当前月日 &lt; 出生年月的月日 则年龄减一 </span><br><span class="line"></span><br><span class="line">SELECT student.SId,CASE </span><br><span class="line">	WHEN SUBSTRING(CURRENT_DATE(),6,10)-SUBSTRING(Sage,6,10)&gt;=0</span><br><span class="line">	THEN</span><br><span class="line">		YEAR(CURRENT_DATE())-YEAR(Sage)</span><br><span class="line">	ELSE</span><br><span class="line">		YEAR(CURRENT_DATE())-YEAR(Sage)-1</span><br><span class="line">END age</span><br><span class="line">FROM student</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    Sno, </span><br><span class="line">    Sname, </span><br><span class="line">    YEAR(CURDATE()) - YEAR(Sage) - </span><br><span class="line">    (DATE_FORMAT(CURDATE(), &#x27;%m%d&#x27;) &lt; DATE_FORMAT(Sage, &#x27;%m%d&#x27;)) AS Age</span><br><span class="line">FROM </span><br><span class="line">    student;</span><br></pre></td></tr></table></figure>



<h6 id="42-week"><a href="#42-week" class="headerlink" title="42 week"></a>42 week</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">查询本周过生日的学生</span><br><span class="line"></span><br><span class="line">-- 【分析】使用week()函数</span><br><span class="line">SELECT *,</span><br><span class="line">       WEEK(sage),</span><br><span class="line">       WEEK(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE WEEK(sage)=WEEK(NOW());</span><br></pre></td></tr></table></figure>

<h6 id="43-month"><a href="#43-month" class="headerlink" title="43 month"></a>43 month</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">查询本月过生日的学生</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 【分析】使用month()函数 --</span><br><span class="line">SELECT *,</span><br><span class="line">       MONTH(sage),</span><br><span class="line">       MONTH(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE MONTH(sage)=MONTH(NOW());</span><br></pre></td></tr></table></figure>



<h6 id="44-month"><a href="#44-month" class="headerlink" title="44 month"></a>44 month</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查询下月过生日的学生 </span><br><span class="line"></span><br><span class="line">SELECT *,</span><br><span class="line">       MONTH(sage),</span><br><span class="line">       MONTH(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE MONTH(sage)=MONTH(NOW())+1;</span><br></pre></td></tr></table></figure>





<h5 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h5><p><a target="_blank" rel="noopener" href="http://www.360doc.com/content/24/0424/09/41302653_1121296713.shtml">url</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/72223558">url</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">student</span><br><span class="line"></span><br><span class="line">字段名	</span><br><span class="line">Sno	学生编号</span><br><span class="line">Sname	学生姓名</span><br><span class="line">Sage	出生年月</span><br><span class="line">Ssex	学生性别</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">course</span><br><span class="line"></span><br><span class="line">字段名	--</span><br><span class="line">Cno	科目编号</span><br><span class="line">Cname	科目名称</span><br><span class="line">Tno	任课老师编号</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">teacher</span><br><span class="line"></span><br><span class="line">字段名	--</span><br><span class="line">Tno	任课教师标号</span><br><span class="line">Tname	任课老师姓名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SC</span><br><span class="line"></span><br><span class="line">字段名	--</span><br><span class="line">Sno	学生编号</span><br><span class="line">Cno	科目编号</span><br><span class="line">score	成绩</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">1. 查询&quot; 01 &quot;课程比&quot; 02 &quot;课程成绩高的学生的信息及课程分数</span><br><span class="line"></span><br><span class="line">1.1 查询同时存在&quot; 01 &quot;课程和&quot; 02 &quot;课程的情况</span><br><span class="line"></span><br><span class="line">1.2 查询存在&quot;01&quot;课程但可能不存在&quot;02&quot;课程的情况(不存在时显示为 null )</span><br><span class="line"></span><br><span class="line">1.3 查询不存在&quot;01&quot;课程但存在&quot;02&quot;课程的情况</span><br><span class="line"></span><br><span class="line">2. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</span><br><span class="line"></span><br><span class="line">3. 查询在 SC 表存在成绩的学生信息</span><br><span class="line"></span><br><span class="line">4. 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 null )</span><br><span class="line"></span><br><span class="line">4.1 查有成绩的学生信息</span><br><span class="line"></span><br><span class="line">5. 查询「李」姓老师的数量 </span><br><span class="line"></span><br><span class="line">6. 查询学过「张三」老师授课的同学的信息 </span><br><span class="line"></span><br><span class="line">7. 查询没有学全所有课程的同学的信息 </span><br><span class="line"></span><br><span class="line">8. 查询至少有一门课与学号为&quot;01&quot;的同学所学相同的同学的信息 </span><br><span class="line"></span><br><span class="line">9. 查询和&quot;01&quot;号的同学学习的课程完全相同的其他同学的信息 </span><br><span class="line"></span><br><span class="line">10. 查询没学过&quot;张三&quot;老师讲授的任一门课程的学生姓名 </span><br><span class="line"></span><br><span class="line">11. 查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩 </span><br><span class="line"></span><br><span class="line">12. 检索&quot;01&quot;课程分数小于60，按分数降序排列的学生信息</span><br><span class="line"></span><br><span class="line">13. 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</span><br><span class="line"></span><br><span class="line">14. 查询各科成绩最高分、最低分和平均分：</span><br><span class="line">    以如下形式显示：课程 ID，课程 name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率</span><br><span class="line">    及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</span><br><span class="line">    还要求选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</span><br><span class="line"></span><br><span class="line">15. 按各科成绩进行排序，并显示排名，Score重复时保留名次空缺</span><br><span class="line"></span><br><span class="line">15.1 按各科成绩进行排序，并显示排名， Score 重复时合并名次</span><br><span class="line"></span><br><span class="line">16.  查询学生的总成绩，并进行排名，总分重复时保留名次空缺</span><br><span class="line"></span><br><span class="line">16.1 查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</span><br><span class="line"></span><br><span class="line">17. 统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[60-0] 及所占百分比</span><br><span class="line"></span><br><span class="line">18. 查询各科成绩前三名的记录</span><br><span class="line"></span><br><span class="line">19. 查询每门课程被选修的学生数 </span><br><span class="line"></span><br><span class="line">20. 查询出只选修两门课程的学生学号和姓名 </span><br><span class="line"></span><br><span class="line">21. 查询男生、女生人数</span><br><span class="line"></span><br><span class="line">22. 查询名字中含有「风」字的学生信息</span><br><span class="line"></span><br><span class="line">23. 查询同名同性学生名单，并统计同名人数</span><br><span class="line"></span><br><span class="line">24. 查询 1990 年出生的学生名单</span><br><span class="line"></span><br><span class="line">25. 查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</span><br><span class="line"></span><br><span class="line">26. 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩 </span><br><span class="line"></span><br><span class="line">27. 查询课程名称为「数学」，且分数低于 60 的学生姓名和分数 </span><br><span class="line"></span><br><span class="line">28. 查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</span><br><span class="line"></span><br><span class="line">29. 查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</span><br><span class="line"></span><br><span class="line">30. 查询不及格的课程</span><br><span class="line"></span><br><span class="line">31. 查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名</span><br><span class="line"></span><br><span class="line">32. 求每门课程的学生人数 </span><br><span class="line"></span><br><span class="line">33. 成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</span><br><span class="line"></span><br><span class="line">34. 成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</span><br><span class="line"></span><br><span class="line">35. 查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩 </span><br><span class="line"></span><br><span class="line">36. 查询每门功成绩最好的前两名</span><br><span class="line"></span><br><span class="line">37. 统计每门课程的学生选修人数（超过 5 人的课程才统计）。</span><br><span class="line"></span><br><span class="line">38. 检索至少选修两门课程的学生学号 </span><br><span class="line"></span><br><span class="line">39. 查询选修了全部课程的学生信息</span><br><span class="line"></span><br><span class="line">40. 查询各学生的年龄，只按年份来算 </span><br><span class="line"></span><br><span class="line">41. 按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</span><br><span class="line"></span><br><span class="line">42. 查询本周过生日的学生</span><br><span class="line"></span><br><span class="line">43. 查询下周过生日的学生</span><br><span class="line"></span><br><span class="line">44. 查询本月过生日的学生</span><br><span class="line"></span><br><span class="line">45. 查询下月过生日的学生</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="9-外连接实现except"><a href="#9-外连接实现except" class="headerlink" title="9 !外连接实现except"></a>9 !外连接实现except</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">from</span><br><span class="line">(</span><br><span class="line">SELECT Sno</span><br><span class="line">from sc</span><br><span class="line">where Cno and Sno=&#x27;01&#x27; in (</span><br><span class="line">    SELECT Cno</span><br><span class="line">    from sc</span><br><span class="line">    where Sno=&#x27;01&#x27;)</span><br><span class="line">    group by Sno</span><br><span class="line">) t1</span><br><span class="line">left join</span><br><span class="line">(</span><br><span class="line">SELECT Sno</span><br><span class="line">from sc</span><br><span class="line">where Cno not in (</span><br><span class="line">    SELECT Cno</span><br><span class="line">    from sc</span><br><span class="line">    where Sno=&#x27;01&#x27;)</span><br><span class="line">    group by Sno</span><br><span class="line">) t2</span><br><span class="line">on t1.Sno=t2.Sno</span><br><span class="line">where t2.Sno is null</span><br></pre></td></tr></table></figure>



<h6 id="10"><a href="#10" class="headerlink" title="10"></a>10</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">-- 1.先查询出选修了张三老师讲授课程的sid -- </span><br><span class="line">SELECT s.sid</span><br><span class="line">FROM  teacher t</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON t.tid = c.tid</span><br><span class="line">LEFT JOIN sc</span><br><span class="line">ON c.cid = sc.cid</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">WHERE tname = &quot;张三&quot;;</span><br><span class="line">-- 2.与学生表student关联,筛选出不在以上结果内的sid --</span><br><span class="line">SELECT s.*</span><br><span class="line">FROM student s</span><br><span class="line">WHERE sid NOT IN (SELECT s.sid</span><br><span class="line">				  FROM  teacher t</span><br><span class="line">				  LEFT JOIN course c</span><br><span class="line">				  ON t.tid = c.tid</span><br><span class="line">				  LEFT JOIN sc</span><br><span class="line">				  ON c.cid = sc.cid</span><br><span class="line">				  LEFT JOIN student s</span><br><span class="line">				  ON sc.sid = s.sid</span><br><span class="line">				  WHERE tname = &quot;张三&quot;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select sid</span><br><span class="line">from student</span><br><span class="line">where sid not in</span><br><span class="line">(</span><br><span class="line">select sid</span><br><span class="line">from sc</span><br><span class="line">where cid in</span><br><span class="line">(</span><br><span class="line">select cid</span><br><span class="line">from teacher t</span><br><span class="line">inner join course c</span><br><span class="line">on t.tid=c.tid</span><br><span class="line">)</span><br><span class="line">group by sid</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h6 id="11"><a href="#11" class="headerlink" title="11"></a>11</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select a.sid,b.sname,avg(a.score) as avg_score</span><br><span class="line">from sc a</span><br><span class="line">left join student b</span><br><span class="line">on a.sid = b.sid</span><br><span class="line">where a.score &lt; 60</span><br><span class="line">group by a.sid</span><br><span class="line">having count(a.cid) &gt;= 2;</span><br></pre></td></tr></table></figure>

<h6 id="14-case-when-round-值得注意"><a href="#14-case-when-round-值得注意" class="headerlink" title="14 case when round 值得注意"></a>14 case when round 值得注意</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(score) min_score</span><br><span class="line">			,MAX(score) max_score</span><br><span class="line">			,AVG(score) avg_score</span><br><span class="line">			,COUNT(1) stu_number</span><br><span class="line">			,SUM(CASE WHEN score &gt;= 60 THEN 1 ELSE 0 END)/COUNT(1) 及格率</span><br><span class="line">			,SUM(CASE WHEN score &gt;= 70 AND score &lt; 80 THEN 1 ELSE 0 END)/COUNT(1) 中等率</span><br><span class="line">			,SUM(CASE WHEN score &gt;= 80 AND score &lt; 90 THEN 1 ELSE 0 END)/COUNT(1) 优良率</span><br><span class="line">			,SUM(CASE WHEN score &gt;= 90 THEN 1 ELSE 0 END)/COUNT(1) 优秀率</span><br><span class="line">FROM sc</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON sc.cid = c.cid </span><br><span class="line">GROUP BY sc.cid</span><br><span class="line">ORDER BY stu_number DESC ,sc.cid ASC;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405121224020.png" alt="image-20240512122430632"></p>
<h6 id="15-PARTITION-BY-下面那个with案例值得注意"><a href="#15-PARTITION-BY-下面那个with案例值得注意" class="headerlink" title="15 PARTITION BY  下面那个with案例值得注意"></a>15 PARTITION BY  下面那个with案例值得注意</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405121203192.png" alt="image-20240512120328077"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT   </span><br><span class="line">    Sno,  </span><br><span class="line">    Cno,  </span><br><span class="line">    score,  </span><br><span class="line">    DENSE_RANK() OVER (PARTITION BY Cno ORDER BY score DESC) AS ranking  </span><br><span class="line">FROM   </span><br><span class="line">    sc  </span><br><span class="line">ORDER BY   </span><br><span class="line">    Cno, score DESC;</span><br><span class="line">    </span><br><span class="line">    在上述查询中，ORDER BY Cno, score DESC是最终的排序，它确保结果首先按课程号排序，然后按分数降序排序。如果你只关心排名而不关心最终排序顺序，可以省略此ORDER BY子句。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">案例</span><br><span class="line"></span><br><span class="line">select Department, Employee, Salary</span><br><span class="line">from (</span><br><span class="line">    select d.name Department, ee.name Employee, ee.salary Salary, dense_rank() over(partition by departmentId order by salary desc) ranks</span><br><span class="line">    from Employee ee</span><br><span class="line">    left join Department d</span><br><span class="line">    on ee.departmentId = d.id</span><br><span class="line">) t</span><br><span class="line">where ranks &lt;= 3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">案例</span><br><span class="line"></span><br><span class="line">WITH t AS (</span><br><span class="line">    SELECT</span><br><span class="line">        employee_id,</span><br><span class="line">        department_id,</span><br><span class="line">        primary_flag,</span><br><span class="line">        COUNT(*) OVER(PARTITION BY employee_id) AS count_over</span><br><span class="line">    FROM Employee</span><br><span class="line">            )</span><br><span class="line">SELECT employee_id,department_id</span><br><span class="line">FROM t</span><br><span class="line">WHERE count_over = 1 or primary_flag = &#x27;Y&#x27;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405281241827.png" alt="image-20240528124147664"></p>
<h6 id="16-变量的使用-法一没看懂-法二法六-值得注意"><a href="#16-变量的使用-法一没看懂-法二法六-值得注意" class="headerlink" title="16 变量的使用 法一没看懂 法二法六 值得注意"></a>16 变量的使用 法一没看懂 法二法六 值得注意</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101047904.png" alt="image-20240510104752646"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">!16 法一</span><br><span class="line">-- 1、学生的总成绩 --</span><br><span class="line">SELECT sid,SUM(score) sum_score</span><br><span class="line">FROM sc</span><br><span class="line">GROUP BY sid</span><br><span class="line">ORDER BY sum_score DESC;</span><br><span class="line"></span><br><span class="line">-- 2、名次排序 --</span><br><span class="line">SELECT a.*,</span><br><span class="line">		@rank:=IF(@sco=sum_score,&#x27; &#x27;,@rank+1) rk</span><br><span class="line">FROM (SELECT sid,</span><br><span class="line">			 SUM(score) sum_score</span><br><span class="line">	  FROM sc</span><br><span class="line">	  GROUP BY sid</span><br><span class="line">	  ORDER BY sum_score DESC) a,(select @sco:=null,@rank:=0) b</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">法二 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line">select a.Sno, a.score,(select count(b.score)+1 --结果有莫名错误</span><br><span class="line">from sc as b</span><br><span class="line">where b.score&gt;a.score)  as &#x27;r&#x27;</span><br><span class="line">from sc as a</span><br><span class="line">order by &#x27;r&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101057067.png" alt="image-20240510105708868"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select a.Sno, a.score,(select count(b.score)+1 --这样接正确了，奇怪</span><br><span class="line">from sc as b</span><br><span class="line">where b.score&gt;a.score)  as r</span><br><span class="line">from sc as a</span><br><span class="line">order by r;</span><br><span class="line"></span><br><span class="line">--等同于rank窗口函数实现的结果</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101059106.png" alt="image-20240510105912068"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">法三 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line"></span><br><span class="line">select sc.Sno, sc.score,DENSE_RANK() OVER(ORDER BY sc.score desc) as r</span><br><span class="line">from sc;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101108470.png" alt="image-20240510110824177"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">法四 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line"></span><br><span class="line">select sc.Sno, sc.score,RANK() OVER(ORDER BY sc.score desc) as r</span><br><span class="line">from sc;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101109512.png" alt="image-20240510110926212"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">法五 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line"></span><br><span class="line">select sc.Sno, sc.score,ROW_NUMBER() OVER(ORDER BY sc.score desc) as r</span><br><span class="line">from sc;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405101112131.png" alt="image-20240510111228079"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">法六 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line"></span><br><span class="line">select a.id, a.score, count(*) as r</span><br><span class="line">from scores a</span><br><span class="line">left join scores b</span><br><span class="line">on a.score &lt; b.score</span><br><span class="line">group by id, score</span><br><span class="line">order by score DESC</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">错误写法 (法二-法五是leecode的例子，但用了这里的数据，把sc行数据理解成是总成绩)</span><br><span class="line"></span><br><span class="line">select *</span><br><span class="line">from sc as a</span><br><span class="line">where EXISTS (</span><br><span class="line">select b.score</span><br><span class="line">from sc as b</span><br><span class="line">where a.Sno!=b.Sno and a.score&lt;=b.score</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">select a.Sno, count(*) as coun</span><br><span class="line">from SC as a</span><br><span class="line">where a.score&lt;=(</span><br><span class="line">select b.score</span><br><span class="line">from SC as b</span><br><span class="line">where a.Sno!=b.Sno</span><br><span class="line">)</span><br><span class="line">group by a.Sno</span><br><span class="line">order by coun;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    s.Sno, </span><br><span class="line">    s.Sname, </span><br><span class="line">    SUM(sc.score) AS TotalScore,</span><br><span class="line">    DENSE_RANK() OVER (ORDER BY SUM(sc.score) DESC) AS Rank</span><br><span class="line">FROM </span><br><span class="line">    student s</span><br><span class="line">JOIN </span><br><span class="line">    SC sc ON s.Sno = sc.Sno</span><br><span class="line">GROUP BY </span><br><span class="line">    s.Sno, s.Sname</span><br><span class="line">ORDER BY </span><br><span class="line">    TotalScore DESC;</span><br></pre></td></tr></table></figure>





<h6 id="17-18值得注意-22-ROUND-CASE-CONCAT"><a href="#17-18值得注意-22-ROUND-CASE-CONCAT" class="headerlink" title="17 18值得注意 22 ROUND\CASE\CONCAT"></a>17 18值得注意 22 ROUND\CASE\CONCAT</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">！17 不会</span><br><span class="line">SELECT sc.cid 课程编号,c.cname 课程名称,COUNT(1) 选修人数</span><br><span class="line">	   ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;=0 AND sc.score &lt;= 60 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(0-60]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;=60 AND sc.score &lt;= 70 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(60-70]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;= 70 AND sc.score &lt;= 85 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(70-85]&#x27;</span><br><span class="line">       ,CONCAT(ROUND(SUM(CASE WHEN sc.score &gt;= 85 AND sc.score &lt;= 100 THEN 1 ELSE 0 END)/COUNT(1),2),&#x27;%&#x27;) AS &#x27;(85-100]&#x27;</span><br><span class="line">FROM sc</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON sc.cid = c.cid</span><br><span class="line">GROUP BY sc.cid;</span><br><span class="line"> </span><br><span class="line">-- concat的作用是将两个字符拼接起来 --</span><br><span class="line"></span><br><span class="line">！18  不会 好像有点问题</span><br><span class="line">SELECT a.*,c.cname</span><br><span class="line">FROM sc a</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON a.cid = c.cid </span><br><span class="line">WHERE (SELECT COUNT(1) </span><br><span class="line">	   FROM sc b</span><br><span class="line">       WHERE b.cid = a.cid AND b.score &gt; a.score) &lt; 3</span><br><span class="line">ORDER BY cid DESC,score DESC;</span><br><span class="line"></span><br><span class="line">19</span><br><span class="line">SELECT sc.sid 学生编号,s.sname 学生姓名,COUNT(sc.cid) 选课数量</span><br><span class="line">FROM sc</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">GROUP BY sc.sid,s.sname</span><br><span class="line">HAVING COUNT(sc.cid) = 2;</span><br><span class="line"></span><br><span class="line">20   </span><br><span class="line">SELECT sc.sid 学生编号,s.sname 学生姓名,COUNT(sc.cid) 选课数量</span><br><span class="line">FROM sc</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">GROUP BY sc.sid，s.sname</span><br><span class="line">HAVING COUNT(sc.cid) = 2;</span><br><span class="line"></span><br><span class="line">21 x</span><br><span class="line"></span><br><span class="line">!22 </span><br><span class="line">SELECT *</span><br><span class="line">FROM student </span><br><span class="line">WHERE sname LIKE &#x27;%风%&#x27;;</span><br><span class="line"></span><br><span class="line">23</span><br><span class="line">SELECT sname 姓名,ssex 性别,COUNT(*) 同名人数</span><br><span class="line">FROM student</span><br><span class="line">GROUP BY sname,ssex;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">24 x+</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405082323141.png" alt="image-20240508232354558"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">25 !</span><br><span class="line">select a.Cno,b.Cname,avg(a.score) as avg_score -- 这里有b.Cname错误了</span><br><span class="line">from SC a</span><br><span class="line">left join Course b</span><br><span class="line">on a.Cno = b.Cno</span><br><span class="line">group by a.Cno</span><br><span class="line">order by avg_score desc,a.Cno asc;</span><br><span class="line"></span><br><span class="line">26</span><br><span class="line">select a.sid,b.sname,avg(a.score) as avg_score</span><br><span class="line">from sc a</span><br><span class="line">left join student b</span><br><span class="line">on a.sid = b.sid</span><br><span class="line">group by a.sid</span><br><span class="line">having avg_score &gt;= 85;</span><br><span class="line"></span><br><span class="line">27 x</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h6 id="！33-34-35-36-37-39-40-HAVING-变量"><a href="#！33-34-35-36-37-39-40-HAVING-变量" class="headerlink" title="！33 34 35 36 37 39 40 HAVING 变量"></a>！33 34 35 36 37 39 40 HAVING 变量</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405082255245.png" alt="image-20240508225527786"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">28 x</span><br><span class="line"></span><br><span class="line">29 x</span><br><span class="line"></span><br><span class="line">30 x</span><br><span class="line"></span><br><span class="line">31 x</span><br><span class="line"></span><br><span class="line">32 x</span><br><span class="line"></span><br><span class="line">33</span><br><span class="line"># 法一</span><br><span class="line">SELECT *</span><br><span class="line">FROM teacher t</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON t.tid = c.tid</span><br><span class="line">LEFT JOIN sc</span><br><span class="line">ON c.cid = sc.cid</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON s.sid = sc.sid</span><br><span class="line">WHERE t.tname = &quot;张三&quot;</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1;</span><br><span class="line"> </span><br><span class="line"># 法二</span><br><span class="line">-- 1.先查询[张三]老师所带的课程编号cid和tid --</span><br><span class="line">SELECT *</span><br><span class="line">FROM teacher t</span><br><span class="line">LEFT JOIN course c</span><br><span class="line">ON t.tid = c.tid</span><br><span class="line">WHERE t.tname = &quot;张三&quot;;</span><br><span class="line">-- 2.将以上结果与成绩表sc关联 --</span><br><span class="line">SELECT sc.sid,a.cid,a.cname,a.tname,sc.score</span><br><span class="line">FROM (SELECT t.tid,t.tname,c.cid,c.cname</span><br><span class="line">	  FROM teacher t</span><br><span class="line">	  LEFT JOIN course c</span><br><span class="line">	  ON t.tid = c.tid</span><br><span class="line">	  WHERE t.tname = &quot;张三&quot;) a </span><br><span class="line">LEFT JOIN sc</span><br><span class="line">ON a.cid = sc.cid</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1;</span><br><span class="line">-- 3.将以上结果与学生表student关联 --</span><br><span class="line">SELECT s.sid 学号,s.sname 学生姓名,a.cname 课程,a.tname 教师姓名,a.score 成绩</span><br><span class="line">FROM (SELECT sc.sid,a.cid,a.cname,a.tname,sc.score</span><br><span class="line">	  FROM (SELECT t.tid,t.tname,c.cid,c.cname</span><br><span class="line">			FROM teacher t</span><br><span class="line">			LEFT JOIN course c</span><br><span class="line">			ON t.tid = c.tid</span><br><span class="line">			WHERE t.tname = &quot;张三&quot;) a </span><br><span class="line">		LEFT JOIN sc</span><br><span class="line">		ON a.cid = sc.cid</span><br><span class="line">ORDER BY sc.score DESC</span><br><span class="line">LIMIT 1) a</span><br><span class="line">LEFT JOIN student s</span><br><span class="line">ON a.sid = s.sid;</span><br><span class="line"></span><br><span class="line">34 ! rank dense_rank也行</span><br><span class="line">SELECT *</span><br><span class="line">FROM </span><br><span class="line">(SELECT a.*,</span><br><span class="line">		CASE WHEN @score=score THEN @rank</span><br><span class="line">			 WHEN @score:=score THEN @rank:=@rank+1 END rk</span><br><span class="line">FROM </span><br><span class="line">(SELECT s.sid,s.sname,sc.score,c.cid,c.cname</span><br><span class="line"> FROM teacher t</span><br><span class="line"> LEFT JOIN course c</span><br><span class="line"> ON t.tid = c.tid</span><br><span class="line"> LEFT JOIN sc</span><br><span class="line"> ON c.cid = sc.cid</span><br><span class="line"> LEFT JOIN student s</span><br><span class="line"> ON s.sid = sc.sid</span><br><span class="line"> WHERE t.tname = &quot;张三&quot;) a,(SELECT @score:=NULL,@rank:=0) t) s</span><br><span class="line">WHERE rk=1;</span><br><span class="line"></span><br><span class="line">35</span><br><span class="line">SELECT a.sid,a.cid,a.score</span><br><span class="line">FROM sc a</span><br><span class="line">INNER JOIN sc b</span><br><span class="line">ON a.sid = b.sid</span><br><span class="line">WHERE a.cid != b.cid AND a.score = b.score</span><br><span class="line">GROUP BY a.cid,a.sid;</span><br><span class="line"></span><br><span class="line">36 !</span><br><span class="line">SELECT sid,cid,score,rk</span><br><span class="line">FROM(</span><br><span class="line">	SELECT sc.*,</span><br><span class="line">		   @rank:=if(@c_cid=cid,if(@sco=score,@rank,@rank+1),1) rk,</span><br><span class="line">		   @sco:=score,</span><br><span class="line">		   @c_cid:=cid</span><br><span class="line">		FROM sc,(SELECT @sco=null,@rank:=0,@c_cid:=null) b</span><br><span class="line">ORDER BY cid,score DESC) a</span><br><span class="line">where a.rk&lt;3;</span><br><span class="line"></span><br><span class="line">37</span><br><span class="line"># 法一</span><br><span class="line">SELECT cid,COUNT(sid) 选修人数</span><br><span class="line">FROM sc </span><br><span class="line">GROUP BY cid</span><br><span class="line">HAVING COUNT(sid) &gt; 5;</span><br><span class="line"> </span><br><span class="line"># 法二</span><br><span class="line">SELECT cid,COUNT(1) 选修人数</span><br><span class="line">FROM sc </span><br><span class="line">GROUP BY cid</span><br><span class="line">HAVING COUNT(1) &gt; 5;</span><br><span class="line"> </span><br><span class="line">-- 知识点补充 --</span><br><span class="line"># COUNT(1) COUNT(*) COUNT(列名)的区别</span><br><span class="line"># COUNT(1)包含忽略所有列，用1代表代码行，统计时不会忽略列值为NULL</span><br><span class="line"># COUNT(*)包含所有列，相当于行数，统计时，不会忽略列值为NULL</span><br><span class="line"># COUNT(列名)只包含列名那一列，统计时忽略列为NULL(某字段为NULL,不计数)</span><br><span class="line"></span><br><span class="line">38 x</span><br><span class="line"></span><br><span class="line">39</span><br><span class="line">SELECT s.*</span><br><span class="line">FROM sc</span><br><span class="line">INNER JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">GROUP BY sid</span><br><span class="line">HAVING COUNT(1) = (SELECT COUNT(1) FROM course);</span><br><span class="line"> </span><br><span class="line">SELECT s.*</span><br><span class="line">FROM sc</span><br><span class="line">INNER JOIN student s</span><br><span class="line">ON sc.sid = s.sid</span><br><span class="line">GROUP BY sid</span><br><span class="line">HAVING COUNT(sc.cid) = (SELECT COUNT(cid) FROM course);</span><br><span class="line"></span><br><span class="line">40</span><br><span class="line">-- 【分析】使用日期函数进行相减 --</span><br><span class="line">SELECT *,YEAR(CURDATE())-YEAR(sage) 年龄</span><br><span class="line">FROM student;</span><br><span class="line"> </span><br><span class="line">SELECT *,YEAR(NOW())-YEAR(sage) 年龄</span><br><span class="line">FROM student;</span><br></pre></td></tr></table></figure>



<h6 id="！timestampdiff-week-month-NOW-YEAR-x-CURDATE"><a href="#！timestampdiff-week-month-NOW-YEAR-x-CURDATE" class="headerlink" title="！timestampdiff()\week()\month()\NOW()\YEAR(x)\CURDATE()"></a>！timestampdiff()\week()\month()\NOW()\YEAR(x)\CURDATE()</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405082237227.png" alt="image-20240508223729648"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405082237869.png" alt="image-20240508223754306"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405082238568.png" alt="image-20240508223813282"></p>
<h6 id="41"><a href="#41" class="headerlink" title="41"></a>41</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">41 !</span><br><span class="line">-- 【分析】日期相减函数timestampdiff(year\,参数1,参数2) --</span><br><span class="line">SELECT *,</span><br><span class="line">	  TIMESTAMPDIFF(YEAR,sage,NOW()) age</span><br><span class="line">FROM student;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    Sno, </span><br><span class="line">    Sname, </span><br><span class="line">    YEAR(CURDATE()) - YEAR(Sage) - </span><br><span class="line">    (DATE_FORMAT(CURDATE(), &#x27;%m%d&#x27;) &lt; DATE_FORMAT(Sage, &#x27;%m%d&#x27;)) AS Age</span><br><span class="line">FROM </span><br><span class="line">    student;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    Sno,</span><br><span class="line">    Sname,</span><br><span class="line">    Sage,</span><br><span class="line">    CASE </span><br><span class="line">        WHEN DATE_FORMAT(CURDATE(), &#x27;%m%d&#x27;) &lt; DATE_FORMAT(Sage, &#x27;%m%d&#x27;)</span><br><span class="line">        THEN YEAR(CURDATE()) - YEAR(Sage) - 1</span><br><span class="line">        ELSE YEAR(CURDATE()) - YEAR(Sage)</span><br><span class="line">    END as actual_age</span><br><span class="line">FROM student;</span><br></pre></td></tr></table></figure>





<h6 id="42"><a href="#42" class="headerlink" title="42"></a>42</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">42</span><br><span class="line">-- 【分析】使用week()函数</span><br><span class="line">SELECT *,</span><br><span class="line">       WEEK(sage),</span><br><span class="line">       WEEK(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE WEEK(sage)=WEEK(NOW());</span><br></pre></td></tr></table></figure>

<h6 id="43"><a href="#43" class="headerlink" title="43"></a>43</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">43</span><br><span class="line">SELECT *,</span><br><span class="line">       WEEK(sage),</span><br><span class="line">       WEEK(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE WEEK(sage)=WEEK(NOW())+1;</span><br></pre></td></tr></table></figure>

<h6 id="44"><a href="#44" class="headerlink" title="44"></a>44</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">44</span><br><span class="line">-- 【分析】使用month()函数 --</span><br><span class="line">SELECT *,</span><br><span class="line">       MONTH(sage),</span><br><span class="line">       MONTH(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE MONTH(sage)=MONTH(NOW());</span><br></pre></td></tr></table></figure>

<h6 id="45"><a href="#45" class="headerlink" title="45"></a>45</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">45</span><br><span class="line">SELECT *,</span><br><span class="line">       MONTH(sage),</span><br><span class="line">       MONTH(NOW())</span><br><span class="line">FROM student</span><br><span class="line">WHERE MONTH(sage)=MONTH(NOW())+1;</span><br></pre></td></tr></table></figure>

<h3 id="LEECODE案例"><a href="#LEECODE案例" class="headerlink" title="LEECODE案例"></a>LEECODE案例</h3><h4 id="262"><a href="#262" class="headerlink" title="262"></a>262</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SELECT T.request_at AS `Day`, </span><br><span class="line">	ROUND(</span><br><span class="line">			SUM(</span><br><span class="line">				IF(T.STATUS = &#x27;completed&#x27;,0,1)</span><br><span class="line">			)</span><br><span class="line">			/ </span><br><span class="line">			COUNT(T.STATUS),</span><br><span class="line">			2</span><br><span class="line">	) AS `Cancellation Rate`</span><br><span class="line">FROM Trips AS T</span><br><span class="line">JOIN Users AS U1 ON (T.client_id = U1.users_id AND U1.banned =&#x27;No&#x27;)</span><br><span class="line">JOIN Users AS U2 ON (T.driver_id = U2.users_id AND U2.banned =&#x27;No&#x27;)</span><br><span class="line">WHERE T.request_at BETWEEN &#x27;2013-10-01&#x27; AND &#x27;2013-10-03&#x27;</span><br><span class="line">GROUP BY T.request_at</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">select t1.request_at</span><br><span class="line">from </span><br><span class="line">(select request_at, count() as fz</span><br><span class="line">from Trips t left join Users u1 on t.client_id=u1.users_id left join Users u2 on  t.driver_id = u2.users_id</span><br><span class="line">where u1.banned != &#x27;YES&#x27; and t.status != &#x27;completed&#x27;</span><br><span class="line">group by t.request_at) t1,</span><br><span class="line">(select request_at,count(*) as fm</span><br><span class="line">from Trips t,Users u1,Users u2</span><br><span class="line">where t.client_id=u1.users_id and t.driver_id = u2.users_id and u1.banned != &#x27;YES&#x27;</span><br><span class="line">group by t.request_at) t2</span><br><span class="line">where t1.request_at=t2.request_at</span><br></pre></td></tr></table></figure>

<h5 id="avg精彩用法"><a href="#avg精彩用法" class="headerlink" title="avg精彩用法"></a>avg精彩用法</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 精彩</span><br><span class="line"># Write your MySQL query statement below</span><br><span class="line">SELECT</span><br><span class="line">    request_at as &#x27;Day&#x27;, round(avg(Status!=&#x27;completed&#x27;), 2) as &#x27;Cancellation Rate&#x27;</span><br><span class="line">FROM </span><br><span class="line">    trips t JOIN users u1 ON (t.client_id = u1.users_id AND u1.banned = &#x27;No&#x27;)</span><br><span class="line">    JOIN users u2 ON (t.driver_id = u2.users_id AND u2.banned = &#x27;No&#x27;)</span><br><span class="line">WHERE	</span><br><span class="line">    request_at BETWEEN &#x27;2013-10-01&#x27; AND &#x27;2013-10-03&#x27;</span><br><span class="line">GROUP BY </span><br><span class="line">    request_at</span><br></pre></td></tr></table></figure>

<h4 id="569-partition-by-中位数"><a href="#569-partition-by-中位数" class="headerlink" title="569 partition by 中位数"></a>569 partition by 中位数</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408121833571.png" alt="image-20240812183309415"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408121833868.png" alt="image-20240812183353125"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SELECT Id, Company, salary</span><br><span class="line">FROM Employee</span><br><span class="line">WHERE Id in</span><br><span class="line">(SELECT E1.Id</span><br><span class="line">FROM Employee AS E1</span><br><span class="line">JOIN</span><br><span class="line">Employee AS E2 </span><br><span class="line">ON E1.company = E2.Company</span><br><span class="line">GROUP BY E1.Id</span><br><span class="line">HAVING SUM(IF(E1.Salary &gt;=E2.Salary,1,0))&gt;= COUNT(*)/ 2</span><br><span class="line">AND SUM(IF(E1.Salary&lt;=E2.salary,1,0))&gt;= COUNT(*)/ 2)</span><br><span class="line">GROUP BY Company,Salary</span><br><span class="line">ORDER BY Company</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--方法一：</span><br><span class="line">--注意事项：排序时用row_number,会有排名相同的情况</span><br><span class="line">--中位数的逻辑了解：不论个数是奇数偶数，中位数在总数除以2和总数除以2加1之间</span><br><span class="line">select id ,company,salary</span><br><span class="line">from (</span><br><span class="line">    select *</span><br><span class="line">    ,row_number() over(partition by company order by salary) as rnk</span><br><span class="line">    ,count(*) over(partition by company ) as cnt</span><br><span class="line">    from Employee) a</span><br><span class="line">where  rnk BETWEEN cnt*1.0/2 AND cnt*1.0/2 + 1</span><br></pre></td></tr></table></figure>



<h4 id="601-lag-lead"><a href="#601-lag-lead" class="headerlink" title="601 lag() lead()"></a>601 lag() lead()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">with people as</span><br><span class="line">(</span><br><span class="line">    select id, visit_date, people,</span><br><span class="line">    Lag(people,2) over(order by id) as pprvPeople,</span><br><span class="line">    Lag(people,1) over(order by id) as prvPeople,</span><br><span class="line">    Lead(people,1) over(order by id) as nextPeople,</span><br><span class="line">    Lead(people,2) over(order by id) as nnextPeople</span><br><span class="line">    from stadium</span><br><span class="line">)</span><br><span class="line">select id, visit_date, people from people</span><br><span class="line">where </span><br><span class="line">(people &gt;= 100 and prvPeople&gt;=100 and pprvPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and nnextPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and prvPeople&gt;=100) </span><br></pre></td></tr></table></figure>



<h4 id="602-case-when"><a href="#602-case-when" class="headerlink" title="602 case when"></a>602 case when</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select case when requester_id is not null then requester_id else accepter_id end  as id, if(c1 is null,0,c1)+if(c2 is null,0,c2) as num</span><br><span class="line">from</span><br><span class="line">(select requester_id,count(*) c1</span><br><span class="line">from RequestAccepted </span><br><span class="line">group by requester_id) t1 </span><br><span class="line">left join </span><br><span class="line">(select accepter_id,count(*) c2 </span><br><span class="line">from RequestAccepted </span><br><span class="line">group by accepter_id) t2</span><br><span class="line">on t1.requester_id=t2.accepter_id</span><br><span class="line">order by num desc limit 1</span><br></pre></td></tr></table></figure>

<h4 id="608-union"><a href="#608-union" class="headerlink" title="608 union"></a>608 union</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">select id,&#x27;Root&#x27; as type</span><br><span class="line">from Tree</span><br><span class="line">where p_id is null</span><br><span class="line">union</span><br><span class="line">select id,&#x27;Inner&#x27; as type</span><br><span class="line">from Tree</span><br><span class="line">where p_id is not null and id not in(</span><br><span class="line">select t2.id</span><br><span class="line">from Tree t1 </span><br><span class="line">right join Tree t2</span><br><span class="line">on t1.p_id=t2.id</span><br><span class="line">where t1.id is null and t2.id is not null and t2.p_id is not null)</span><br><span class="line">union</span><br><span class="line">select t2.id, &#x27;Leaf&#x27; as type</span><br><span class="line">from Tree t1 </span><br><span class="line">right join Tree t2</span><br><span class="line">on t1.p_id=t2.id</span><br><span class="line">where t1.id is null and t2.id is not null and t2.p_id is not null</span><br></pre></td></tr></table></figure>

<h4 id="1070"><a href="#1070" class="headerlink" title="1070"></a>1070</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select product_id,year as first_year,quantity,price</span><br><span class="line">from(</span><br><span class="line">select product_id,year,quantity,price,ROW_NUMBER() over(partition by product_id order by year) as r</span><br><span class="line">from Sales</span><br><span class="line">) t</span><br><span class="line">where t.r=1</span><br></pre></td></tr></table></figure>

<h4 id="1972-同一天的第一个电话和最后一个电话-难"><a href="#1972-同一天的第一个电话和最后一个电话-难" class="headerlink" title="1972  同一天的第一个电话和最后一个电话 难"></a>1972  同一天的第一个电话和最后一个电话 难</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">编写一个 SQL 查询来找出那些ID们在任意一天的第一个电话和最后一个电话都是和同一个人的。这些电话不论是拨打者还是接收者都会被记录。</span><br><span class="line">结果请放在一个任意次序约束的表中。</span><br><span class="line">查询结果格式如下所示：</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408121903084.png" alt="image-20240812190332249"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">--MySQL </span><br><span class="line">with temp as (select * from calls</span><br><span class="line">            union all</span><br><span class="line">            select recipient_id caller_id, caller_id recipient_id, call_time from calls</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">temp1 as (select</span><br><span class="line">            *,</span><br><span class="line">            dense_rank() over (partition by date_format(call_time,&quot;%Y-%m-%d&quot;),caller_id order by call_time asc) rk1,</span><br><span class="line">            dense_rank() over (partition by date_format(call_time,&quot;%Y-%m-%d&quot;),caller_id order by call_time desc) rk2</span><br><span class="line">        from temp</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">select</span><br><span class="line">    distinct caller_id as user_id</span><br><span class="line">from temp1</span><br><span class="line">where rk1 = 1 or rk2 = 1</span><br><span class="line">group by caller_id, date_format(call_time,&quot;%Y-%m-%d&quot;)</span><br><span class="line">having count(distinct recipient_id) = 1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">with t1 as (select</span><br><span class="line">caller_id,recipient_id,call_time #选出 所有id 在某个时间 跟另一个通话的id</span><br><span class="line">from</span><br><span class="line">Calls</span><br><span class="line"> </span><br><span class="line">union all</span><br><span class="line"> </span><br><span class="line">select</span><br><span class="line">recipient_id,caller_id,call_time</span><br><span class="line">from</span><br><span class="line">Calls</span><br><span class="line">),</span><br><span class="line">t2 as (</span><br><span class="line">select#按 caller_id 和 每天 分组  对 call_time标号 便于 找到 每天 第一个 和最后的一通电话</span><br><span class="line">caller_id,recipient_id,call_time,row_number() over(partition by caller_id,date_format(call_time,&#x27;%Y-%m-%d&#x27;) order by call_time) rn,row_number() over(partition by caller_id,date_format(call_time,&#x27;%Y-%m-%d&#x27;) order by call_time desc) rn2</span><br><span class="line">from</span><br><span class="line">t1</span><br><span class="line">),</span><br><span class="line">t3 as (</span><br><span class="line">select</span><br><span class="line">caller_id,recipient_id,date_format(call_time,&#x27;%Y-%m-%d&#x27;) day #某天第一次通话</span><br><span class="line">from</span><br><span class="line">t2</span><br><span class="line">where rn = 1 </span><br><span class="line">union all</span><br><span class="line">select</span><br><span class="line">caller_id,recipient_id,date_format(call_time,&#x27;%Y-%m-%d&#x27;) day#某天最后一次通话</span><br><span class="line">from</span><br><span class="line">t2</span><br><span class="line">where rn2 = 1 </span><br><span class="line">)</span><br><span class="line">select</span><br><span class="line">distinct caller_id user_id</span><br><span class="line">from</span><br><span class="line"> </span><br><span class="line">t3</span><br><span class="line">group by </span><br><span class="line">caller_id,day #对 某人某天第一次 和最后一次通话的id 去重计数  值为1就是题中需求</span><br><span class="line">having</span><br><span class="line">count(distinct recipient_id)=1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t2结果</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202408131737800.png" alt="image-20240813173733417"></p>
<h5 id="mysql注释问题"><a href="#mysql注释问题" class="headerlink" title="mysql注释问题"></a>mysql注释问题</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在MySQL中，注释不应该使用井号（#）在SQL语句的中间部分，尤其是在SELECT列表或其他语句结构中。井号（#）在MySQL中通常用于行尾来标记注释的开始，直到行末。如果您想在SQL语句的某部分添加注释，您应该使用两个连字符（--）后跟空格，或者如果注释跨越多行，您可以使用/* 注释内容 */。</span><br></pre></td></tr></table></figure>

<h5 id="mysql修改列数据类型"><a href="#mysql修改列数据类型" class="headerlink" title="mysql修改列数据类型"></a>mysql修改列数据类型</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MySQL </span><br><span class="line">alter table name modify column col1 int;</span><br><span class="line"></span><br><span class="line">sql server </span><br><span class="line">alter table name alter column col1 int;</span><br></pre></td></tr></table></figure>



<h4 id="1988"><a href="#1988" class="headerlink" title="1988"></a>1988</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">表： Schools</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| school_id   | int  |</span><br><span class="line">| capacity    | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">school_id 是该表的主键。</span><br><span class="line">此表包含了一些学校的容纳能力。容纳能力指的是学校能够接纳学生的最大数量。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">表： Exam</span><br><span class="line"></span><br><span class="line">+---------------+------+</span><br><span class="line">| Column Name   | Type |</span><br><span class="line">+---------------+------+</span><br><span class="line">| score         | int  |</span><br><span class="line">| student_count | int  |</span><br><span class="line">+---------------+------+</span><br><span class="line">score 是该表的主键。</span><br><span class="line">表中每一行表示有 student_count 名学生在考试中至少获得了 score 分。</span><br><span class="line">表中的数据在逻辑上是正确的，即记录了高score的行相比记录了低score的行拥有相同或更少的student_count。</span><br><span class="line">也就是说，对于表中的i行与j行，如果scorei &gt; scorej，那么student_counti &lt;= student_countj</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">每年，学校会公布学生申请所需的最低分数要求。学校根据所有学生的考试成绩来决定其最低分数要求。</span><br><span class="line"></span><br><span class="line">学校希望确保即使每一个满足分数要求的学生都申请该学校，学校也有足够的能力接纳每一个学生。</span><br><span class="line">学校也希望尽可能多的学生能申请该学校。</span><br><span class="line">学校必须使用在 Exam 表中的 score 来作为最低分数要求。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">编写一个SQL查询来查询每所学校的最低分数要求。如果同时有多个score值满足上述要求，则选择其中最小的一个。如果数据不足以决定最低分数要求，那么输出 -1。</span><br><span class="line"></span><br><span class="line">返回的结果表可以按任意顺序排序。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">查询结果格式如下例所示：</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line"></span><br><span class="line">输入:</span><br><span class="line">Schools 表:</span><br><span class="line">+-----------+----------+</span><br><span class="line">| school_id | capacity |</span><br><span class="line">+-----------+----------+</span><br><span class="line">| 11        | 151      |</span><br><span class="line">| 5         | 48       |</span><br><span class="line">| 9         | 9        |</span><br><span class="line">| 10        | 99       |</span><br><span class="line">+-----------+----------+</span><br><span class="line">Exam 表:</span><br><span class="line">+-------+---------------+</span><br><span class="line">| score | student_count |</span><br><span class="line">+-------+---------------+</span><br><span class="line">| 975   | 10            |</span><br><span class="line">| 966   | 60            |</span><br><span class="line">| 844   | 76            |</span><br><span class="line">| 749   | 76            |</span><br><span class="line">| 744   | 100           |</span><br><span class="line">+-------+---------------+</span><br><span class="line">输出:</span><br><span class="line">+-----------+-------+</span><br><span class="line">| school_id | score |</span><br><span class="line">+-----------+-------+</span><br><span class="line">| 5         | 975   |</span><br><span class="line">| 9         | -1    |</span><br><span class="line">| 10        | 749   |</span><br><span class="line">| 11        | 744   |</span><br><span class="line">+-----------+-------+</span><br><span class="line">解释： </span><br><span class="line">- School 5：学校的容纳能力为 48 。选择 975 作为最低分数要求，因为学校最多会收到 10 份申请，这在学校的容纳能力以内。</span><br><span class="line">- School 10：学校的容纳能力为 99 。可以选择 844 或 749 作为最低分数要求，因为学校最多会收到 76 份申请，这在学校的容纳能力以内。又因为 749 是所有可选项中最小的，因此我们选择 749 。</span><br><span class="line">- School 11：学校的容纳能力为 151 。选择 744 作为最低分数要求，因为学校最多会收到 100 份申请，这在学校的容纳能力以内。</span><br><span class="line">- School 9：给出的数据不足以确定最低分数要求。如果选择 975 作为最低分数要求，学校可能会收到 10 份申请，然而学校的容纳能力只有 9 。我们没有关于更高分数的信息，因此我们返回 -1 。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    school_id,</span><br><span class="line">    ifnull(min(score),-1) as score</span><br><span class="line">from Schools</span><br><span class="line">left join Exam</span><br><span class="line">on capacity&gt;=student_count</span><br><span class="line">group by school_id;</span><br></pre></td></tr></table></figure>

<h4 id="1990"><a href="#1990" class="headerlink" title="1990"></a>1990</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">问题：</span><br><span class="line">三个实验平台中每种实验完成的次数</span><br><span class="line">请注意，每一对（实验平台、实验名称）都应包含在输出中，包括平台上实验次数是零的。</span><br><span class="line"></span><br><span class="line">表: Experiments</span><br><span class="line"></span><br><span class="line">+-----------------+------+</span><br><span class="line">| Column Name     | Type |</span><br><span class="line">+-----------------+------+</span><br><span class="line">| experiment_id   | int  |</span><br><span class="line">| platform        | enum |</span><br><span class="line">| experiment_name | enum |</span><br><span class="line">+-----------------+------+</span><br><span class="line"></span><br><span class="line">experiment_id 是这个表的主键.</span><br><span class="line">platform 是枚举类型的，取值是这三种 (&#x27;Android&#x27;, &#x27;IOS&#x27;, &#x27;Web&#x27;) 之一.</span><br><span class="line">experiment_name 也是枚举类型的，取值是这三种 (&#x27;Reading&#x27;, &#x27;Sports&#x27;, &#x27;Programming&#x27;) 之一.</span><br><span class="line">这个表包含有关随机实验人员进行的实验的 ID、用于做实验的平台以及实验名称的信息。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">结果可以以任意顺序给出。</span><br><span class="line">查询的结果如下所示：</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">输入：</span><br><span class="line">Experiments table:</span><br><span class="line">+---------------+----------+-----------------+</span><br><span class="line">| experiment_id | platform | experiment_name |</span><br><span class="line">+---------------+----------+-----------------+</span><br><span class="line">| 4             | IOS      | Programming     |</span><br><span class="line">| 13            | IOS      | Sports          |</span><br><span class="line">| 14            | Android  | Reading         |</span><br><span class="line">| 8             | Web      | Reading         |</span><br><span class="line">| 12            | Web      | Reading         |</span><br><span class="line">| 18            | Web      | Programming     |</span><br><span class="line">+---------------+----------+-----------------+</span><br><span class="line">输出：</span><br><span class="line">+----------+-----------------+-----------------+</span><br><span class="line">| platform | experiment_name | num_experiments |</span><br><span class="line">+----------+-----------------+-----------------+</span><br><span class="line">| Android  | Reading         | 1               |</span><br><span class="line">| Android  | Sports          | 0               |</span><br><span class="line">| Android  | Programming     | 0               |</span><br><span class="line">| IOS      | Reading         | 0               |</span><br><span class="line">| IOS      | Sports          | 1               |</span><br><span class="line">| IOS      | Programming     | 1               |</span><br><span class="line">| Web      | Reading         | 2               |</span><br><span class="line">| Web      | Sports          | 0               |</span><br><span class="line">| Web      | Programming     | 1               |</span><br><span class="line">+----------+-----------------+-----------------+</span><br><span class="line">解释：</span><br><span class="line">在安卓平台上, 我们只做了一个&quot;Reading&quot; 实验.</span><br><span class="line">在 &quot;IOS&quot; 平台上，我们做了一个&quot;Sports&quot; 实验和一个&quot;Programming&quot; 实验.</span><br><span class="line">在 &quot;Web&quot; 平台上，我们做了两个&quot;Reading&quot; 实验和一个&quot;Programming&quot; 实验.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- https://leetcode.cn/problems/count-the-number-of-experiments</span><br><span class="line">drop table if EXISTS Experiments;</span><br><span class="line">Create table If Not Exists Experiments (experiment_id int, platform enum(&#x27;Android&#x27;,&#x27;IOS&#x27;,&#x27;Web&#x27;), experiment_name enum(&#x27;Programming&#x27;,&#x27;Sports&#x27;,&#x27;Reading&#x27;));</span><br><span class="line">insert into Experiments values (4,&#x27;IOS&#x27;,&#x27;Programming&#x27;);</span><br><span class="line">insert into Experiments values (13,&#x27;IOS&#x27;,&#x27;Sports&#x27;);</span><br><span class="line">insert into Experiments values (14,&#x27;Android&#x27;,&#x27;Reading&#x27;);</span><br><span class="line">insert into Experiments values (8,&#x27;Web&#x27;,&#x27;Reading&#x27;);</span><br><span class="line">insert into Experiments values (12,&#x27;Web&#x27;,&#x27;Reading&#x27;);</span><br><span class="line">insert into Experiments values (18,&#x27;Web&#x27;,&#x27;Programming&#x27;);</span><br><span class="line">select * from Experiments;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">with pe as</span><br><span class="line">(   select * from</span><br><span class="line">    (</span><br><span class="line">    select &#x27;IOS&#x27; platform union all</span><br><span class="line">    select &#x27;Android&#x27; platform union all</span><br><span class="line">    select &#x27;Web&#x27; platform</span><br><span class="line">    )p</span><br><span class="line">cross join</span><br><span class="line">(</span><br><span class="line">    select &#x27;Programming&#x27; experiment_name union all</span><br><span class="line">    select &#x27;Sports&#x27; experiment_name union all</span><br><span class="line">    select &#x27;Reading&#x27; experiment_name</span><br><span class="line">)e</span><br><span class="line">)</span><br><span class="line">-- select * from pe;</span><br><span class="line">select pe.platform,pe.experiment_name,count(w.platform) as num_experiments</span><br><span class="line">from pe left join Experiments as w using(platform,experiment_name)</span><br><span class="line">group by platform,experiment_name;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">with new_table as(</span><br><span class="line">    select &#x27;Android&#x27; platform</span><br><span class="line">    union select &#x27;IOS&#x27;</span><br><span class="line">    union select &#x27;Web&#x27;</span><br><span class="line">),</span><br><span class="line">other_table as(</span><br><span class="line">    select &#x27;Reading&#x27; experiment_name</span><br><span class="line">    union select &#x27;Sports&#x27;</span><br><span class="line">    union select &#x27;Programming&#x27;</span><br><span class="line">)</span><br><span class="line">select new_table.platform ,other_table.experiment_name,count(experiment_id)num_experiments</span><br><span class="line">from new_table join other_table #笛卡尔积</span><br><span class="line">left join Experiments E </span><br><span class="line">on E.platform = new_table.platform </span><br><span class="line">AND other_table.experiment_name = E.experiment_name</span><br><span class="line">group by new_table.platform ,other_table.experiment_name</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2004"><a href="#2004" class="headerlink" title="2004"></a>2004</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">SQL架构</span><br><span class="line"></span><br><span class="line">表: Candidates</span><br><span class="line"></span><br><span class="line">+-------------+------+</span><br><span class="line">| Column Name | Type |</span><br><span class="line">+-------------+------+</span><br><span class="line">| employee_id | int  |</span><br><span class="line">| experience  | enum |</span><br><span class="line">| salary      | int  |</span><br><span class="line">+-------------+------+</span><br><span class="line">employee_id是此表的主键列。</span><br><span class="line">经验是包含一个值（“高级”、“初级”）的枚举类型。</span><br><span class="line">此表的每一行都显示候选人的id、月薪和经验。</span><br><span class="line">一家公司想雇佣新员工。公司的工资预算是 70000 美元。公司的招聘标准是：</span><br><span class="line"></span><br><span class="line">雇佣最多的高级员工。</span><br><span class="line">在雇佣最多的高级员工后，使用剩余预算雇佣最多的初级员工。</span><br><span class="line">编写一个SQL查询，查找根据上述标准雇佣的高级员工和初级员工的数量。</span><br><span class="line">按 任意顺序 返回结果表。</span><br><span class="line">查询结果格式如下例所示。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">示例 1:</span><br><span class="line"></span><br><span class="line">输入: </span><br><span class="line">Candidates table:</span><br><span class="line">+-------------+------------+--------+</span><br><span class="line">| employee_id | experience | salary |</span><br><span class="line">+-------------+------------+--------+</span><br><span class="line">| 1           | Junior     | 10000  |</span><br><span class="line">| 9           | Junior     | 10000  |</span><br><span class="line">| 2           | Senior     | 20000  |</span><br><span class="line">| 11          | Senior     | 20000  |</span><br><span class="line">| 13          | Senior     | 50000  |</span><br><span class="line">| 4           | Junior     | 40000  |</span><br><span class="line">+-------------+------------+--------+</span><br><span class="line">输出: </span><br><span class="line">+------------+---------------------+</span><br><span class="line">| experience | accepted_candidates |</span><br><span class="line">+------------+---------------------+</span><br><span class="line">| Senior     | 2                   |</span><br><span class="line">| Junior     | 2                   |</span><br><span class="line">+------------+---------------------+</span><br><span class="line">说明：</span><br><span class="line">我们可以雇佣2名ID为（2,11）的高级员工。由于预算是7万美元，他们的工资总额是4万美元，我们还有3万美元，但他们不足以雇佣ID为13的高级员工。</span><br><span class="line">我们可以雇佣2名ID为（1,9）的初级员工。由于剩下的预算是3万美元，他们的工资总额是2万美元，我们还有1万美元，但他们不足以雇佣ID为4的初级员工。</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">with t1 as (select</span><br><span class="line">employee_id,experience,salary,sum(salary) over(partition by experience order by salary rows between unbounded preceding and current row) so</span><br><span class="line">#按 experience 分组开窗,按salary 生序排列逐一求和   然后 &lt;=70000 就是能招聘的 员工</span><br><span class="line">from</span><br><span class="line">Candidates</span><br><span class="line">),</span><br><span class="line">t2 as (</span><br><span class="line">select</span><br><span class="line">&quot;Senior&quot; experience,count(employee_id) accepted_candidates,70000-ifnull(max(so),0) m   # 能招聘的 Senior 等级员工</span><br><span class="line">from</span><br><span class="line">t1</span><br><span class="line">where</span><br><span class="line">experience = &quot;Senior&quot; and so&lt;=70000</span><br><span class="line"> </span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">select</span><br><span class="line">experience,accepted_candidates</span><br><span class="line">from</span><br><span class="line">t2</span><br><span class="line">union all #上下两表拼接 就是题中需求</span><br><span class="line">select</span><br><span class="line">&quot;Junior&quot; experience,count(employee_id) accepted_candidates # 能招聘的 Junior 等级员工</span><br><span class="line">from</span><br><span class="line">t1</span><br><span class="line">where</span><br><span class="line">experience = &quot;Junior&quot; and so&lt;=(select m from t2)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">自己思路：找出高级和低级的生成临时表，然后用变量from t,@var=0,然后对高级和低级临时表的工资逐行加，再筛选出低于预备工资的数据，得到高级多少人并且一共花多少，再和低级临时表连接，条件是高级的总工资+低级总工资&lt;预算，得到低级多少人和低级总工资</span><br></pre></td></tr></table></figure>



<h4 id="2020-简单"><a href="#2020-简单" class="headerlink" title="2020 简单"></a>2020 简单</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111501368.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">简单 别人的答案</span><br><span class="line"></span><br><span class="line"># Write your MySQL query statement below</span><br><span class="line">with new_table as(</span><br><span class="line">    select  DISTINCT account_id from Subscriptions where </span><br><span class="line">    date_format(start_date,&#x27;%Y&#x27;) = &#x27;2021&#x27; or</span><br><span class="line">    date_format(end_date,&#x27;%Y&#x27;) = &#x27;2021&#x27; </span><br><span class="line">)</span><br><span class="line">select count(*) accounts_count</span><br><span class="line">from Streams S right join new_table N</span><br><span class="line">on N.account_id = S.account_id</span><br><span class="line">where substring(stream_date,1,4) &lt;&gt; &#x27;2021&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用year函数，or, not in，子查询就可以了</span><br></pre></td></tr></table></figure>





<h4 id="2026-简单"><a href="#2026-简单" class="headerlink" title="2026 简单"></a>2026 简单</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">简单 但我只想到了select是算出比率，然后再select</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111507021.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">SELECT problem_id</span><br><span class="line">FROM Problems</span><br><span class="line">#这里不要用round四舍五入</span><br><span class="line">WHERE likes/(likes+dislikes)&lt;0.60</span><br><span class="line">order by problem_id asc</span><br></pre></td></tr></table></figure>



<h4 id="2041-简单"><a href="#2041-简单" class="headerlink" title="2041 简单"></a>2041 简单</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">简单</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111511919.png"></p>
<h4 id="2051"><a href="#2051" class="headerlink" title="2051"></a>2051</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111530105.png" alt="在这里插入图片描述"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111529019.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202406111528723.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">select M.member_id,M.name,(</span><br><span class="line">case</span><br><span class="line">    when count(V.visit_id) = 0 then &#x27;Bronze&#x27;</span><br><span class="line">    when count(P.visit_id)/count(V.visit_id) &lt; 0.5 then &#x27;Silver&#x27;</span><br><span class="line">    when count(P.visit_id)/count(V.visit_id) &lt;0.8 then &#x27;Gold&#x27;</span><br><span class="line">    else &#x27;Diamond&#x27;</span><br><span class="line">    end) AS category</span><br><span class="line">from Members M left join Visits V</span><br><span class="line">on M.member_id = V.member_id </span><br><span class="line">left join Purchases P </span><br><span class="line">on P.visit_id = V.visit_id</span><br><span class="line">group by M.member_id</span><br></pre></td></tr></table></figure>



<h3 id="常用积累"><a href="#常用积累" class="headerlink" title="常用积累"></a>常用积累</h3><h4 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h4><h5 id="1"><a href="#1" class="headerlink" title="1"></a>1</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除重复邮件，保留最小的id email 来自leecode</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line">delete from Person where Person.id not in (</span><br><span class="line">select t.id from (</span><br><span class="line">select p2.id </span><br><span class="line">from Person p2</span><br><span class="line">where p2.email in (select p1.email</span><br><span class="line">from Person p1</span><br><span class="line">group by p1.email</span><br><span class="line">having count(*)=1)</span><br><span class="line">) t</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果不要貌似多余的select t.id from ( 会报错</span><br><span class="line"></span><br><span class="line">--MySQL 不允许在 DELETE 语句的 WHERE 子句中直接使用正在被更新的表。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405161000539.png" alt="image-20240516100028199"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delete from Person where id not in (</span><br><span class="line">	select a.id from (</span><br><span class="line">		select min(id) from Person group by email a</span><br><span class="line">	)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DELETE p1 FROM Person p1,</span><br><span class="line">    Person p2</span><br><span class="line">WHERE</span><br><span class="line">    p1.Email = p2.Email AND p1.Id &gt; p2.Id</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p1是Person表的别名，这个DELETE语句会删除Person表中所有满足JOIN条件和WHERE条件的行</span><br><span class="line"></span><br><span class="line">所以答案这样写的意思是，最终会在P1中delete，而不是在笛卡尔积的表里delete是吗？</span><br></pre></td></tr></table></figure>

<h4 id="日期相关"><a href="#日期相关" class="headerlink" title="日期相关"></a>日期相关</h4><h5 id="DATEDIFF"><a href="#DATEDIFF" class="headerlink" title="DATEDIFF()"></a>DATEDIFF()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DATEDIFF() 函数返回两个日期之间的时间。</span><br><span class="line"></span><br><span class="line">结果：day=DiffDate=enddate−startdate=1day=DiffDate=enddate-startdate=1day=DiffDate=enddate−startdate=1，把示例的day换成year，就是按年计算</span><br><span class="line"></span><br><span class="line">select </span><br><span class="line">    b.Id </span><br><span class="line">from </span><br><span class="line">    weather a </span><br><span class="line">inner join </span><br><span class="line">    weather b </span><br><span class="line">where </span><br><span class="line">    DATEDIFF(b.recordDate,a.recordDate)=1 </span><br><span class="line">and b.Temperature &gt; a.Temperature;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="TIMESTAMPDIFF"><a href="#TIMESTAMPDIFF" class="headerlink" title="TIMESTAMPDIFF()"></a>TIMESTAMPDIFF()</h5><p><a target="_blank" rel="noopener" href="https://www.php.cn/faq/631801.html">timestampdiff</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">timestampdiff(year,参数1,参数2) </span><br><span class="line"></span><br><span class="line">TIMESTAMPDIFF能干什么，可以计算相差天数、小时、分钟和秒，相比于datediff函数要灵活很多。格式是时间小的前，时间大的放在后面。 计算相差天数：</span><br><span class="line"></span><br><span class="line">其中，year处可以是以下值之一：</span><br><span class="line">MICROSECOND</span><br><span class="line">SECOND</span><br><span class="line">MINUTE</span><br><span class="line">HOUR</span><br><span class="line">DAY</span><br><span class="line">WEEK</span><br><span class="line">MONTH</span><br><span class="line">QUARTER</span><br><span class="line">YEAR</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select w1.Id</span><br><span class="line">from Weather as w1, Weather as w2</span><br><span class="line">where TIMESTAMPDIFF(DAY, w2.RecordDate, w1.RecordDate) = 1 </span><br><span class="line">AND w1.Temperature &gt; w2.Temperature</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT TIMESTAMPDIFF(YEAR,&#x27;1999-11-02&#x27;,NOW()) age;</span><br><span class="line">24</span><br><span class="line"></span><br><span class="line">now()</span><br><span class="line">+---------------------+</span><br><span class="line">| 2024-11-01 22:46:28</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202411012250530.png" alt="image-20241101225020808"></p>
<h5 id="DATE-FORMAT"><a href="#DATE-FORMAT" class="headerlink" title="DATE_FORMAT()"></a>DATE_FORMAT()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--2018-12-18</span><br><span class="line"></span><br><span class="line">DATE_FORMAT(trans_date, &#x27;%Y-%m&#x27;)</span><br><span class="line"></span><br><span class="line">--2018-12</span><br></pre></td></tr></table></figure>

<h5 id="DATE-ADD"><a href="#DATE-ADD" class="headerlink" title="DATE_ADD()"></a>DATE_ADD()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">DATE_ADD() ：从日期增加指定的时间间隔，返回的是一个字符串</span><br><span class="line"></span><br><span class="line">DATE_ADD(date,INTERVAL expr type)</span><br><span class="line"></span><br><span class="line">date 参数是合法的日期表达式。expr 参数是您希望添加的时间间隔。</span><br><span class="line"></span><br><span class="line">type 参数可以是下列值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二、使用</span><br><span class="line">now() //now函数为获取当前时间</span><br><span class="line"></span><br><span class="line">select date_add(now(), interval 1 day); - 加1天</span><br><span class="line">select date_add(now(),INTERVAL -1 DAY);-当前日期向前推1天</span><br><span class="line">select date_add(now(), interval 1 hour); -加1小时</span><br><span class="line">select date_add(now(), interval 1 minute); - 加1分钟</span><br><span class="line">select date_add(now(), interval 1 second); -加1秒</span><br><span class="line">select date_add(now(), interval 1 microsecond);-加1毫秒</span><br><span class="line">select date_add(now(), interval 1 week);-加1周</span><br><span class="line">select date_add(now(), interval 1 month);-加1月</span><br><span class="line">select date_add(now(), interval 1 quarter);-加1季</span><br><span class="line">select date_add(now(), interval 1 year);-加1年</span><br><span class="line">MySQL adddate(), addtime()函数，可以用date_add() 来替代。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select IFNULL(round(count(distinct(Result.player_id)) / count(distinct(Activity.player_id)), 2), 0) as fraction</span><br><span class="line">from (</span><br><span class="line">  select Activity.player_id as player_id</span><br><span class="line">  from (</span><br><span class="line">    select player_id, DATE_ADD(MIN(event_date), INTERVAL 1 DAY) as second_date</span><br><span class="line">    from Activity</span><br><span class="line">    group by player_id</span><br><span class="line">  ) as Expected, Activity</span><br><span class="line">  where Activity.event_date = Expected.second_date and Activity.player_id = Expected.player_id</span><br><span class="line">) as Result, Activity</span><br></pre></td></tr></table></figure>

<h5 id="CURDATE-，NOW"><a href="#CURDATE-，NOW" class="headerlink" title="CURDATE()，NOW()"></a>CURDATE()，NOW()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select curdate();</span><br><span class="line">+------------+</span><br><span class="line">| curdate()  |</span><br><span class="line">+------------+</span><br><span class="line">| 2024-11-01 |</span><br><span class="line">+------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select now();</span><br><span class="line">+---------------------+</span><br><span class="line">| now()               |</span><br><span class="line">+---------------------+</span><br><span class="line">| 2024-11-01 22:46:28 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<h5 id="month-week-year"><a href="#month-week-year" class="headerlink" title="month(),week(),year()"></a>month(),week(),year()</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure>



<h4 id="lag-、lead"><a href="#lag-、lead" class="headerlink" title="lag()、lead()"></a>lag()、lead()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">lag()和lead()这两个函数可以查询我们得到的结果集上下偏移相应行数的相应的结果。</span><br><span class="line"></span><br><span class="line">lag()函数：</span><br><span class="line">查询当前行向上偏移n行对应的结果</span><br><span class="line">该函数有三个参数：第一个为待查询的参数列名，第二个为向上偏移的位数，第三个参数为超出最上面边界的默认值。</span><br><span class="line"></span><br><span class="line">lead()函数：</span><br><span class="line">查询当前行向下偏移n行对应的结果</span><br><span class="line">该函数有三个参数：第一个为待查询的参数列名，第二个为向下偏移的位数，第三个参数为超出最下面边界的默认值。</span><br><span class="line"></span><br><span class="line">DATEDIFF()</span><br><span class="line"></span><br><span class="line">DATEDIFF() 函数返回两个日期之间的时间。</span><br><span class="line"></span><br><span class="line">结果：day=DiffDate=enddate−startdate=1day=DiffDate=enddate-startdate=1day=DiffDate=enddate−startdate=1，把示例的day换成year，就是按年计算</span><br><span class="line"></span><br><span class="line">select id</span><br><span class="line">from</span><br><span class="line">    (select </span><br><span class="line">        id,</span><br><span class="line">        temperature,</span><br><span class="line">        recordDate,</span><br><span class="line">        lag(recordDate,1) over(order by recordDate) as last_date,</span><br><span class="line">        lag(temperature,1) over(order by recordDate) as last_temperature</span><br><span class="line">    from Weather) a</span><br><span class="line">where temperature &gt; last_temperature and datediff(recordDate, last_date) = 1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">with people as</span><br><span class="line">(</span><br><span class="line">    select id, visit_date, people,</span><br><span class="line">    Lag(people,2) over(order by id) as pprvPeople,</span><br><span class="line">    Lag(people,1) over(order by id) as prvPeople,</span><br><span class="line">    Lead(people,1) over(order by id) as nextPeople,</span><br><span class="line">    Lead(people,2) over(order by id) as nnextPeople</span><br><span class="line">    from stadium</span><br><span class="line">)</span><br><span class="line">select id, visit_date, people from people</span><br><span class="line">where </span><br><span class="line">(people &gt;= 100 and prvPeople&gt;=100 and pprvPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and nnextPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and prvPeople&gt;=100) </span><br></pre></td></tr></table></figure>



<h4 id="roud-、if"><a href="#roud-、if" class="headerlink" title="roud()、if()"></a>roud()、if()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SELECT T.request_at AS `Day`, </span><br><span class="line">	ROUND(</span><br><span class="line">			SUM(</span><br><span class="line">				IF(T.STATUS = &#x27;completed&#x27;,0,1)</span><br><span class="line">			)</span><br><span class="line">			/ </span><br><span class="line">			COUNT(T.STATUS),</span><br><span class="line">			2</span><br><span class="line">	) AS `Cancellation Rate`</span><br><span class="line">FROM Trips AS T</span><br><span class="line">JOIN Users AS U1 ON (T.client_id = U1.users_id AND U1.banned =&#x27;No&#x27;)</span><br><span class="line">JOIN Users AS U2 ON (T.driver_id = U2.users_id AND U2.banned =&#x27;No&#x27;)</span><br><span class="line">WHERE T.request_at BETWEEN &#x27;2013-10-01&#x27; AND &#x27;2013-10-03&#x27;</span><br><span class="line">GROUP BY T.request_at</span><br></pre></td></tr></table></figure>

<h4 id="limit"><a href="#limit" class="headerlink" title="limit()"></a>limit()</h4><p><a target="_blank" rel="noopener" href="https://www.jb51.net/database/3070058yf.htm"></a></p>
<h5 id="一个参数"><a href="#一个参数" class="headerlink" title="一个参数"></a>一个参数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit 10</span><br></pre></td></tr></table></figure>

<h5 id="两个参数"><a href="#两个参数" class="headerlink" title="两个参数"></a>两个参数</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">limit 0,2</span><br><span class="line"></span><br><span class="line">--其实这个实现分页也是可以的</span><br></pre></td></tr></table></figure>

<h5 id="分页offset"><a href="#分页offset" class="headerlink" title="分页offset"></a>分页offset</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如，把结果集分页，每页3条记录。要获取第1页的记录，可以使用LIMIT 3 OFFSET 0：</span><br><span class="line">SELECT * FROM student LIMIT 3 OFFSET 0;</span><br><span class="line">上述查询LIMIT 3 OFFSET 0表示，对结果集从0号记录开始，最多取3条。注意SQL记录集的索引从0开始。</span><br><span class="line"></span><br><span class="line">如果要查询第2页，那么我们只需要“跳过”头3条记录，也就是对结果集从3号记录开始查询，把OFFSET设定为3：</span><br><span class="line">SELECT * FROM student LIMIT 3 OFFSET 3;</span><br></pre></td></tr></table></figure>

<h4 id="IFNULL-、NULLIF-、ISNULL"><a href="#IFNULL-、NULLIF-、ISNULL" class="headerlink" title="IFNULL()、NULLIF()、ISNULL()"></a>IFNULL()、NULLIF()、ISNULL()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IFNULL()函数的使用</span><br><span class="line">IFNULL(expr1,expr2)，如果expr1的值为null，则返回expr2的值，如果expr1的值不为null，则返回expr1的值。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">SELECT IFNULL(NULL,&#x27;B&#x27;); -- 输出结果：B</span><br><span class="line"> </span><br><span class="line">SELECT IFNULL(&#x27;HELLO&#x27;,&#x27;B&#x27;); -- 输出结果：HELLO</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NULLIF()函数的使用</span><br><span class="line">NULLIF(expr1,expr2)，如果expr1=expr2成立，那么返回值为null，否则返回值为expr1的值。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">SELECT NULLIF(&#x27;A&#x27;,&#x27;A&#x27;); -- 输出结果：null</span><br><span class="line"> </span><br><span class="line">SELECT NULLIF(&#x27;A&#x27;,&#x27;B&#x27;); -- 输出结果：A</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ISNULL()函数的使用</span><br><span class="line"></span><br><span class="line">ISNULL(expr)，如果expr的值为null，则返回1，如果expr1的值不为null，则返回0。</span><br><span class="line"></span><br><span class="line">SELECT ISNULL(NULL); -- 输出结果：1</span><br><span class="line"> </span><br><span class="line">SELECT ISNULL(&#x27;HELLO&#x27;); -- 输出结果：0</span><br></pre></td></tr></table></figure>



<h4 id="、-、、NULL、TRUE、FALSE、UNKNOWN"><a href="#、-、、NULL、TRUE、FALSE、UNKNOWN" class="headerlink" title="&lt;&gt;、!&#x3D;、&lt;&#x3D;&gt;、NULL、TRUE、FALSE、UNKNOWN"></a>&lt;&gt;、!&#x3D;、&lt;&#x3D;&gt;、NULL、TRUE、FALSE、UNKNOWN</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为了解决这个问题，MySQL提供了IS NULL和IS NOT NULL这两个操作符，它们专门用于检查字段是否为NULL。当我们使用IS NULL时，如果字段的值为NULL，查询将返回TRUE；如果字段的值不是NULL（包括字段中有值和字段为空），查询将返回FALSE。 同样地，IS NOT NULL用于检查字段值是否不是NULL。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405171532529.png" alt="image-20240517153247499"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405171533625.png" alt="image-20240517153306278"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405171534845.png" alt="image-20240517153424876"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安全等于可以用于比较null,同null为1，一个则为0。其它情况和=类似</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">输入： </span><br><span class="line">Customer 表:</span><br><span class="line">+----+------+------------+</span><br><span class="line">| id | name | referee_id |</span><br><span class="line">+----+------+------------+</span><br><span class="line">| 1  | Will | null       |</span><br><span class="line">| 2  | Jane | null       |</span><br><span class="line">| 3  | Alex | 2          |</span><br><span class="line">| 4  | Bill | null       |</span><br><span class="line">| 5  | Zack | 1          |</span><br><span class="line">| 6  | Mark | 2          |</span><br><span class="line">+----+------+------------+</span><br><span class="line"></span><br><span class="line">找出那些 没有被 id = 2 的客户 推荐 的客户的姓名。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">法一 </span><br><span class="line">SELECT name</span><br><span class="line">FROM customer</span><br><span class="line">WHERE NOT referee_id &lt;=&gt; 2;</span><br><span class="line"></span><br><span class="line">法二</span><br><span class="line">SELECT name FROM customer WHERE referee_id != 2 OR referee_id IS NULL;</span><br></pre></td></tr></table></figure>

<h4 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql笛卡尔积</span><br><span class="line">SQL中的笛卡尔积（Cartesian Product）是指两个表的所有可能的组合。当两个表没有关联条件时，数据库系统会对这两个表进行笛卡尔积操作，这会导致性能下降和资源浪费。为了优化笛卡尔积操作</span><br></pre></td></tr></table></figure>

<h4 id="WITH"><a href="#WITH" class="headerlink" title="WITH"></a>WITH</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">with people as</span><br><span class="line">(</span><br><span class="line">    select id, visit_date, people,</span><br><span class="line">    Lag(people,2) over(order by id) as pprvPeople,</span><br><span class="line">    Lag(people,1) over(order by id) as prvPeople,</span><br><span class="line">    Lead(people,1) over(order by id) as nextPeople,</span><br><span class="line">    Lead(people,2) over(order by id) as nnextPeople</span><br><span class="line">    from stadium</span><br><span class="line">)</span><br><span class="line">select id, visit_date, people from people</span><br><span class="line">where </span><br><span class="line">(people &gt;= 100 and prvPeople&gt;=100 and pprvPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and nnextPeople&gt;=100) ||</span><br><span class="line">(people &gt;= 100 and nextPeople&gt;=100 and prvPeople&gt;=100) </span><br></pre></td></tr></table></figure>

<h4 id="mod"><a href="#mod" class="headerlink" title="mod()"></a>mod()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mod</span>(id,<span class="number">2</span>) <span class="operator">=</span> <span class="number">1</span> <span class="operator">/</span></span><br><span class="line">id<span class="operator">%</span><span class="number">2</span><span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="substring"><a href="#substring" class="headerlink" title="substring()"></a>substring()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">不是下标为0开始</span><br><span class="line"></span><br><span class="line">--2018-12-18</span><br><span class="line">substring(trans_date,1,7)</span><br></pre></td></tr></table></figure>


<h4 id="group-by-新奇"><a href="#group-by-新奇" class="headerlink" title="group by 新奇"></a>group by 新奇</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_FORMAT(trans_date, &#x27;%Y-%m&#x27;) AS month,</span><br><span class="line">    country,</span><br><span class="line">    COUNT(*) AS trans_count,</span><br><span class="line">    COUNT(IF(state = &#x27;approved&#x27;, 1, NULL)) AS approved_count,</span><br><span class="line">    SUM(amount) AS trans_total_amount,</span><br><span class="line">    SUM(IF(state = &#x27;approved&#x27;, amount, 0)) AS approved_total_amount</span><br><span class="line">FROM Transactions</span><br><span class="line">GROUP BY month, country --这里的month是截取的，不能再group by后面截取，截取后也不能重命名</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select e.student_id,student_name,subject_name,count(*) attended_exams </span><br><span class="line">from Students s ,Examinations e</span><br><span class="line">where s.student_id=e.student_id</span><br><span class="line">group by student_id,subject_name</span><br><span class="line"></span><br><span class="line">-- 这里能select student_name,因为这里同分组下student_name相同</span><br></pre></td></tr></table></figure>



<h4 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Queue 表</span><br><span class="line">+-----------+-------------+--------+------+</span><br><span class="line">| person_id | person_name | weight | turn |</span><br><span class="line">+-----------+-------------+--------+------+</span><br><span class="line">| 5         | Alice       | 250    | 1    |</span><br><span class="line">| 4         | Bob         | 175    | 5    |</span><br><span class="line">| 3         | Alex        | 350    | 2    |</span><br><span class="line">| 6         | John Cena   | 400    | 3    |</span><br><span class="line">| 1         | Winston     | 500    | 6    |</span><br><span class="line">| 2         | Marie       | 200    | 4    |</span><br><span class="line">+-----------+-------------+--------+------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT a.person_name</span><br><span class="line">FROM (</span><br><span class="line">	SELECT person_name, @pre := @pre + weight AS weight</span><br><span class="line">	FROM Queue, (SELECT @pre := 0) tmp</span><br><span class="line">	ORDER BY turn</span><br><span class="line">) a</span><br><span class="line">WHERE a.weight &lt;= 1000</span><br><span class="line">ORDER BY a.weight DESC</span><br><span class="line">LIMIT 1</span><br></pre></td></tr></table></figure>

<h4 id="CROSS-JOIN"><a href="#CROSS-JOIN" class="headerlink" title="CROSS JOIN"></a>CROSS JOIN</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    *</span><br><span class="line">FROM</span><br><span class="line">    Students s</span><br><span class="line">CROSS JOIN</span><br><span class="line">    Subjects sub</span><br><span class="line"></span><br><span class="line">和s</span><br><span class="line">from Students,Subjects</span><br><span class="line"></span><br><span class="line">一样的，都是笛卡尔积</span><br></pre></td></tr></table></figure>

<h4 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[你要的操作] OVER ( PARTITION BY  &lt;用于分组的列名&gt;</span><br><span class="line">                    ORDER BY &lt;按序叠加的列名&gt; </span><br><span class="line">                    ROWS &lt;窗口滑动的数据范围&gt; )</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;窗口滑动的数据范围&gt; 用来限定[ 你要的操作] 所运用的数据的范围，具体有如下这些：</span><br><span class="line"></span><br><span class="line">当前行 - current row</span><br><span class="line">之前的行 - preceding</span><br><span class="line">之后的行 - following</span><br><span class="line">无界限 - unbounded</span><br><span class="line">表示从前面的起点 - unbounded preceding</span><br><span class="line">表示到后面的终点 - unbounded following</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">举例理解一下：</span><br><span class="line"></span><br><span class="line">取当前行和前五行：ROWS between 5 preceding and current row --共6行</span><br><span class="line">取当前行和后五行：ROWS between current row and 5 following --共6行</span><br><span class="line">取前五行和后五行：ROWS between 5 preceding and 5 folowing --共11行</span><br></pre></td></tr></table></figure>

<h4 id="CASE"><a href="#CASE" class="headerlink" title="CASE"></a>CASE</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">case语句格式一</span><br><span class="line"></span><br><span class="line">CASE语句在执行时，将CASE后的表达式的值与各WHEN子句的表达式值比较，如果相等，则执行THEN后面的表达式或语句，然后跳出CASE语句；否则，返回ELSE后面的表达式。</span><br><span class="line"></span><br><span class="line">CASE input_expression</span><br><span class="line">    WHEN expression1 THEN result_expression1</span><br><span class="line">    WHEN expression2 THEN result_expression2</span><br><span class="line">    [...n]</span><br><span class="line">    ELSE result_expression</span><br><span class="line">    END</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">case语句格式二</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CASE</span><br><span class="line">    WHEN expression1 THEN result_expression1</span><br><span class="line">    WHEN expression2 THEN result_expression2</span><br><span class="line">    [...n]</span><br><span class="line">    ELSE result_expression</span><br><span class="line">    END</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CASE后面没有表达式，多个WHEN子句中的表达式依次执行，如果表达式结果为真，则执行相应THEN关键字后面的表达式或语句，执行完毕之后跳出CASE语句。如果所有WHEN语句都为FALSE，则执行ELSE子句中的语句。</span><br><span class="line"></span><br><span class="line">小tips：在交换数据和列转行时可以考虑使用case语句</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">case when then x else x end</span><br><span class="line"></span><br><span class="line">\</span><br><span class="line"></span><br><span class="line">case when then x</span><br><span class="line">when then x else x end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="GROUP-CONCAT"><a href="#GROUP-CONCAT" class="headerlink" title="GROUP_CONCAT()"></a>GROUP_CONCAT()</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202405231753919.png" alt="image-20240523175304465"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT sell_date,</span><br><span class="line">       COUNT(DISTINCT product) num_sold,</span><br><span class="line">       GROUP_CONCAT(DISTINCT product) products</span><br><span class="line">FROM Activities</span><br><span class="line">GROUP BY sell_date</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">可以指定自定义的分隔符，不指定的情况下，默认是 &#x27;,&#x27; GROUP_CONCAT(DISTINCT product ORDER BY product ASC SEPARATOR &#x27;,&#x27;)</span><br></pre></td></tr></table></figure>

<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~~~</span><br><span class="line"></span><br><span class="line">#### ||</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>sql语句中“||”符号表示，连接符。比如’111’||’222’其结果就是’111222’。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### ONLY_FULL_GROUP_BY</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>关闭ONLY_FULL_GROUP_BY模式的弊端</p>
<p>结果的不确定性：关闭 ONLY_FULL_GROUP_BY 可能导致分组查询返回不确定的结果。特别是当 SELECT 列表中包含非聚合列，且这些列没有包含在 GROUP BY 子句中时，MySQL 将从每个分组中任意选择一个值作为结果，这可能导致结果难以预测和解释。<br>调试复杂性：在没有 ONLY_FULL_GROUP_BY 的约束下，编写的查询可能在逻辑上不那么明确，尤其是当查询变得复杂时。这可能使得调试和维护查询变得更加困难。<br>性能问题：虽然不是直接结果，但关闭 ONLY_FULL_GROUP_BY 并依赖 MySQL 从分组中随机选择数据可能导致查询效率不是最优的，特别是在处理大量数据时。<br>标准SQL的偏离：ONLY_FULL_GROUP_BY 更接近于 SQL 标准对分组操作的定义。关闭它可能意味着编写的 SQL 在其他遵循 SQL 标准的数据库系统中可能不会工作或者产生不同的结果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 行转列、列转行</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>行转列一般使用 IF 或 CASE WHEN 语句 + GROUP BY + 聚合函数。而列转行一般使用 UNION + 多个查询 的方法</p>
<p>SELECT<br>  product_id,<br>  SUM(IF(store &#x3D; ‘store1’, price, NULL)) ‘store1’,<br>  SUM(IF(store &#x3D; ‘store2’, price, NULL)) ‘store2’,<br>  SUM(IF(store &#x3D; ‘store3’, price, NULL)) ‘store3’<br>FROM<br>  Products1<br>GROUP BY product_id ;</p>
<p>SELECT product_id, ‘store1’ store, store1 price FROM products WHERE store1 IS NOT NULL<br>UNION<br>SELECT product_id, ‘store2’ store, store2 price FROM products WHERE store2 IS NOT NULL<br>UNION<br>SELECT product_id, ‘store3’ store, store3 price FROM products WHERE store3 IS NOT NULL;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20240528130754538](https://raw.githubusercontent.com/ttyong/hexoBlog/master/尚硅谷大数据技术之数据湖Hudi/202405281307874.png)</span><br><span class="line"></span><br><span class="line">![image-20240528130802977](https://raw.githubusercontent.com/ttyong/hexoBlog/master/尚硅谷大数据技术之数据湖Hudi/202405281308365.png)</span><br><span class="line"></span><br><span class="line">#### 左右外连接当连接键不唯一时</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>还是可以正常连接</p>
<p>不用去笛卡尔积，然后过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20240602143811747](https://raw.githubusercontent.com/ttyong/hexoBlog/master/尚硅谷大数据技术之数据湖Hudi/202406021438298.png)</span><br><span class="line"></span><br><span class="line">![image-20240602143830263](https://raw.githubusercontent.com/ttyong/hexoBlog/master/尚硅谷大数据技术之数据湖Hudi/202406021438977.png)</span><br><span class="line"></span><br><span class="line">#### mysql全外连接</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>mysql不支持<br>可以用left + right +union实现(这里需要去重)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### union和union all</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>union会去重<br>union all不会去重</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### limit</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>limit  2 &#x3D;&#x3D;&gt;从0索引开始读取2个</p>
<p>select * from table limit 2,1;<br>&#x2F;&#x2F;含义是跳过2条取出1条数据，limit后面是从第2条开始读，读取1条信息，即读取第3条数据</p>
<p>select * from table limit 2 offset 1;<br>&#x2F;&#x2F;含义是从下标1开始取出2条数据，limit后面跟的是2条数据，即读取第2,3条</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Hbase</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>1.我们在设计列族的时候，可以把经常读取的列存储到一个列族中，不经常读取的列放到另一个列族中。<br>这样我们在读取部分列的数据的时候，就只需要读取对应列族文件中的数据，提高读取效率。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>在HBase中，数据块大小和MemStore大小是两个不同的概念，它们具有不同的功能和调整目的。</p>
<p>数据块大小主要影响HBase中的数据存储和访问性能。数据块由多个cell（key-value对）集合组成，每个数据块的大小在创建表的列族时可以指定。数据块大小的设定影响数据块索引的大小，数据块越小，索引越大，从而占用更大内存空间。因此，在随机查找性能和数据块索引内存占用之间需要权衡。如果需要更好的随机查找性能，可以将数据块设置为较小的值；而如果需要更好的序列扫描性能，则可以考虑增大数据块的大小。</p>
<p>而MemStore是HBase中用于保存修改数据（即key-value对）的内存结构。当MemStore的大小达到一个阈值（默认是128MB）时，MemStore会被Flush到文件（即StoreFile），以释放内存空间。MemStore的大小设置主要影响HBase的写入性能和内存使用。如果MemStore太小，可能导致频繁的Flush操作，影响写入性能；如果MemStore太大，则可能消耗过多的内存资源。</p>
<p>因此，hbase数据块大小和memstore大小不一样，它们是HBase中两个不同的参数，需要根据具体的应用场景和性能需求进行独立调整。</p>
<pre><code>
</code></pre>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">智汇君</div><div class="post-copyright__author_desc">路漫漫其修远兮，吾将上下而求索！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%EF%BC%9F/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/01/17/面试 数据库常见面试问题？/')">面试 数据库常见面试问题？</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/01/17/%E9%9D%A2%E8%AF%95%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%EF%BC%9F/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Tech智汇站</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E9%9D%A2%E8%AF%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>面试<span class="tagsPageCount">12</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20%E9%97%AE%E7%9A%84%E9%97%AE%E9%A2%98/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">面试 问的问题</div></div></a></div><div class="next-post pull-right"><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">面试 正则表达式</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/01/17/%E5%B0%9A%E8%A7%82%E4%BA%91%E8%AE%A1%E7%AE%97%E4%B9%8Boracle%E6%95%B0%E6%8D%AE%E5%BA%93-%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86%201/" title="尚观云计算之oracle数据库 基础部分 1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">尚观云计算之oracle数据库 基础部分 1</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20ES%E9%9D%A2%E8%AF%951/" title="面试 ES面试1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 ES面试1</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20Hadoop%E9%9D%A2%E8%AF%95/" title="面试 Hadoop面试"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 Hadoop面试</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20hive%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%982/" title="面试 hive常见面试题2"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 hive常见面试题2</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20linux%E9%9D%A2%E8%AF%952/" title="面试 SHELL脚本开发"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 SHELL脚本开发</div></div></a></div><div><a href="/2025/01/17/%E9%9D%A2%E8%AF%95%20hive%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%981/" title="面试 hive常见面试题1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">面试 hive常见面试题1</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">智汇君</h1><div class="author-info__desc">路漫漫其修远兮，吾将上下而求索！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="/contact/" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(/img/博客微信公众号图片.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-number">1.</span> <span class="toc-text">数据库常见面试问题？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql"><span class="toc-number">1.1.</span> <span class="toc-text">mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">课程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%80%E5%9C%9F%E6%8E%98%E9%87%91"><span class="toc-number">1.1.2.</span> <span class="toc-text">稀土掘金</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B9%BB%E8%AF%BB%EF%BC%8C%E8%84%8F%E8%AF%BB%EF%BC%8C%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E5%91%A2%EF%BC%9F"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">什么是幻读，脏读，不可重复读呢？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#limit-1000000-%E5%8A%A0%E8%BD%BD%E5%BE%88%E6%85%A2%E7%9A%84%E8%AF%9D%EF%BC%8C%E4%BD%A0%E6%98%AF%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E7%9A%84%E5%91%A2%EF%BC%9F"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">limit 1000000 加载很慢的话，你是怎么解决的呢？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E9%AB%98%E5%B9%B6%E5%8F%91%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E5%AE%89%E5%85%A8%E7%9A%84%E4%BF%AE%E6%94%B9%E5%90%8C%E4%B8%80%E8%A1%8C%E6%95%B0%E6%8D%AE%EF%BC%9F"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">在高并发情况下，如何做到安全的修改同一行数据？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%82%B2%E8%A7%82%E9%94%81"><span class="toc-number">1.1.2.3.1.</span> <span class="toc-text">使用悲观锁</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">1.1.2.3.2.</span> <span class="toc-text">使用乐观锁</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSDN%E6%A1%88%E4%BE%8B"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">CSDN案例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%B8%80"><span class="toc-number">1.1.2.4.1.</span> <span class="toc-text">案例一</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-2"><span class="toc-number">1.1.2.4.1.1.</span> <span class="toc-text">1.2</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1-3"><span class="toc-number">1.1.2.4.1.2.</span> <span class="toc-text">1.3</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-having%E7%9A%84%E4%B8%80%E4%B8%AA%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.1.2.4.1.3.</span> <span class="toc-text">7 having的一个使用技巧</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8"><span class="toc-number">1.1.2.4.1.4.</span> <span class="toc-text">8</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#9"><span class="toc-number">1.1.2.4.1.5.</span> <span class="toc-text">9</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#13"><span class="toc-number">1.1.2.4.1.6.</span> <span class="toc-text">13</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#15-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.2.4.1.7.</span> <span class="toc-text">15  变量的使用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#16-dense-rank-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.2.4.1.8.</span> <span class="toc-text">16 dense_rank()   变量的使用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#17-%E5%8C%BA%E5%9F%9F%E6%AE%B5-case-when-then-concat"><span class="toc-number">1.1.2.4.1.9.</span> <span class="toc-text">17 区域段 case when then  concat</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#22-like"><span class="toc-number">1.1.2.4.1.10.</span> <span class="toc-text">22 like</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#25"><span class="toc-number">1.1.2.4.1.11.</span> <span class="toc-text">25</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#33-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8-limit"><span class="toc-number">1.1.2.4.1.12.</span> <span class="toc-text">33 变量的使用 limit</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#34-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.2.4.1.13.</span> <span class="toc-text">34  变量的使用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#41-current-day-substring-year-now"><span class="toc-number">1.1.2.4.1.14.</span> <span class="toc-text">41 current_day(),substring(),year(),now()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#42-week"><span class="toc-number">1.1.2.4.1.15.</span> <span class="toc-text">42 week</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#43-month"><span class="toc-number">1.1.2.4.1.16.</span> <span class="toc-text">43 month</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#44-month"><span class="toc-number">1.1.2.4.1.17.</span> <span class="toc-text">44 month</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E4%BA%8C"><span class="toc-number">1.1.2.4.2.</span> <span class="toc-text">案例二</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#9-%E5%A4%96%E8%BF%9E%E6%8E%A5%E5%AE%9E%E7%8E%B0except"><span class="toc-number">1.1.2.4.2.1.</span> <span class="toc-text">9 !外连接实现except</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10"><span class="toc-number">1.1.2.4.2.2.</span> <span class="toc-text">10</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#11"><span class="toc-number">1.1.2.4.2.3.</span> <span class="toc-text">11</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#14-case-when-round-%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F"><span class="toc-number">1.1.2.4.2.4.</span> <span class="toc-text">14 case when round 值得注意</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#15-PARTITION-BY-%E4%B8%8B%E9%9D%A2%E9%82%A3%E4%B8%AAwith%E6%A1%88%E4%BE%8B%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F"><span class="toc-number">1.1.2.4.2.5.</span> <span class="toc-text">15 PARTITION BY  下面那个with案例值得注意</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#16-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8-%E6%B3%95%E4%B8%80%E6%B2%A1%E7%9C%8B%E6%87%82-%E6%B3%95%E4%BA%8C%E6%B3%95%E5%85%AD-%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F"><span class="toc-number">1.1.2.4.2.6.</span> <span class="toc-text">16 变量的使用 法一没看懂 法二法六 值得注意</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#17-18%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F-22-ROUND-CASE-CONCAT"><span class="toc-number">1.1.2.4.2.7.</span> <span class="toc-text">17 18值得注意 22 ROUND\CASE\CONCAT</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%EF%BC%8133-34-35-36-37-39-40-HAVING-%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.2.4.2.8.</span> <span class="toc-text">！33 34 35 36 37 39 40 HAVING 变量</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%EF%BC%81timestampdiff-week-month-NOW-YEAR-x-CURDATE"><span class="toc-number">1.1.2.4.2.9.</span> <span class="toc-text">！timestampdiff()\week()\month()\NOW()\YEAR(x)\CURDATE()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#41"><span class="toc-number">1.1.2.4.2.10.</span> <span class="toc-text">41</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#42"><span class="toc-number">1.1.2.4.2.11.</span> <span class="toc-text">42</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#43"><span class="toc-number">1.1.2.4.2.12.</span> <span class="toc-text">43</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#44"><span class="toc-number">1.1.2.4.2.13.</span> <span class="toc-text">44</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#45"><span class="toc-number">1.1.2.4.2.14.</span> <span class="toc-text">45</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LEECODE%E6%A1%88%E4%BE%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">LEECODE案例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#262"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">262</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#avg%E7%B2%BE%E5%BD%A9%E7%94%A8%E6%B3%95"><span class="toc-number">1.1.3.1.1.</span> <span class="toc-text">avg精彩用法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#569-partition-by-%E4%B8%AD%E4%BD%8D%E6%95%B0"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">569 partition by 中位数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#601-lag-lead"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">601 lag() lead()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#602-case-when"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">602 case when</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#608-union"><span class="toc-number">1.1.3.5.</span> <span class="toc-text">608 union</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1070"><span class="toc-number">1.1.3.6.</span> <span class="toc-text">1070</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1972-%E5%90%8C%E4%B8%80%E5%A4%A9%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%94%B5%E8%AF%9D%E5%92%8C%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E7%94%B5%E8%AF%9D-%E9%9A%BE"><span class="toc-number">1.1.3.7.</span> <span class="toc-text">1972  同一天的第一个电话和最后一个电话 难</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#mysql%E6%B3%A8%E9%87%8A%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.3.7.1.</span> <span class="toc-text">mysql注释问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#mysql%E4%BF%AE%E6%94%B9%E5%88%97%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.3.7.2.</span> <span class="toc-text">mysql修改列数据类型</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1988"><span class="toc-number">1.1.3.8.</span> <span class="toc-text">1988</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1990"><span class="toc-number">1.1.3.9.</span> <span class="toc-text">1990</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2004"><span class="toc-number">1.1.3.10.</span> <span class="toc-text">2004</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2020-%E7%AE%80%E5%8D%95"><span class="toc-number">1.1.3.11.</span> <span class="toc-text">2020 简单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2026-%E7%AE%80%E5%8D%95"><span class="toc-number">1.1.3.12.</span> <span class="toc-text">2026 简单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2041-%E7%AE%80%E5%8D%95"><span class="toc-number">1.1.3.13.</span> <span class="toc-text">2041 简单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2051"><span class="toc-number">1.1.3.14.</span> <span class="toc-text">2051</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%A7%AF%E7%B4%AF"><span class="toc-number">1.1.4.</span> <span class="toc-text">常用积累</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Delete"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">Delete</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1"><span class="toc-number">1.1.4.1.1.</span> <span class="toc-text">1</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E7%9B%B8%E5%85%B3"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">日期相关</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#DATEDIFF"><span class="toc-number">1.1.4.2.1.</span> <span class="toc-text">DATEDIFF()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#TIMESTAMPDIFF"><span class="toc-number">1.1.4.2.2.</span> <span class="toc-text">TIMESTAMPDIFF()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DATE-FORMAT"><span class="toc-number">1.1.4.2.3.</span> <span class="toc-text">DATE_FORMAT()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DATE-ADD"><span class="toc-number">1.1.4.2.4.</span> <span class="toc-text">DATE_ADD()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CURDATE-%EF%BC%8CNOW"><span class="toc-number">1.1.4.2.5.</span> <span class="toc-text">CURDATE()，NOW()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#month-week-year"><span class="toc-number">1.1.4.2.6.</span> <span class="toc-text">month(),week(),year()</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lag-%E3%80%81lead"><span class="toc-number">1.1.4.3.</span> <span class="toc-text">lag()、lead()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#roud-%E3%80%81if"><span class="toc-number">1.1.4.4.</span> <span class="toc-text">roud()、if()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#limit"><span class="toc-number">1.1.4.5.</span> <span class="toc-text">limit()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.4.5.1.</span> <span class="toc-text">一个参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.4.5.2.</span> <span class="toc-text">两个参数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E9%A1%B5offset"><span class="toc-number">1.1.4.5.3.</span> <span class="toc-text">分页offset</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IFNULL-%E3%80%81NULLIF-%E3%80%81ISNULL"><span class="toc-number">1.1.4.6.</span> <span class="toc-text">IFNULL()、NULLIF()、ISNULL()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E3%80%81-%E3%80%81%E3%80%81NULL%E3%80%81TRUE%E3%80%81FALSE%E3%80%81UNKNOWN"><span class="toc-number">1.1.4.7.</span> <span class="toc-text">&lt;&gt;、!&#x3D;、&lt;&#x3D;&gt;、NULL、TRUE、FALSE、UNKNOWN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-number">1.1.4.8.</span> <span class="toc-text">笛卡尔积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WITH"><span class="toc-number">1.1.4.9.</span> <span class="toc-text">WITH</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mod"><span class="toc-number">1.1.4.10.</span> <span class="toc-text">mod()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#substring"><span class="toc-number">1.1.4.11.</span> <span class="toc-text">substring()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#group-by-%E6%96%B0%E5%A5%87"><span class="toc-number">1.1.4.12.</span> <span class="toc-text">group by 新奇</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.4.13.</span> <span class="toc-text">自定义变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CROSS-JOIN"><span class="toc-number">1.1.4.14.</span> <span class="toc-text">CROSS JOIN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">1.1.4.15.</span> <span class="toc-text">窗口函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CASE"><span class="toc-number">1.1.4.16.</span> <span class="toc-text">CASE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GROUP-CONCAT"><span class="toc-number">1.1.4.17.</span> <span class="toc-text">GROUP_CONCAT()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.1.4.18.</span> <span class="toc-text">正则表达式</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/23/Geek%20Uninstaller%EF%BC%8C%E7%BB%BF%E8%89%B2%E5%85%8D%E5%AE%89%E8%A3%85%E8%BD%BB%E9%87%8F%E7%9A%84%E5%BA%94%E7%94%A8%E5%8D%B8%E8%BD%BD%E5%B7%A5%E5%85%B7%EF%BC%81/" title="Geek Uninstaller，绿色免安装轻量的应用卸载工具！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Geek Uninstaller，绿色免安装轻量的应用卸载工具！"/></a><div class="content"><a class="title" href="/2025/01/23/Geek%20Uninstaller%EF%BC%8C%E7%BB%BF%E8%89%B2%E5%85%8D%E5%AE%89%E8%A3%85%E8%BD%BB%E9%87%8F%E7%9A%84%E5%BA%94%E7%94%A8%E5%8D%B8%E8%BD%BD%E5%B7%A5%E5%85%B7%EF%BC%81/" title="Geek Uninstaller，绿色免安装轻量的应用卸载工具！">Geek Uninstaller，绿色免安装轻量的应用卸载工具！</a><time datetime="2025-01-23T14:05:38.000Z" title="发表于 2025-01-23 22:05:38">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E6%8A%96%E9%9F%B3%E8%B0%B7%E6%AD%8Cplay%E7%89%88%EF%BC%8C%E7%9C%9F%E7%9A%84%E5%BE%88%E4%B8%9D%E6%BB%91%EF%BC%81/" title="抖音谷歌play版，真的很丝滑！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="抖音谷歌play版，真的很丝滑！"/></a><div class="content"><a class="title" href="/2025/01/22/%E6%8A%96%E9%9F%B3%E8%B0%B7%E6%AD%8Cplay%E7%89%88%EF%BC%8C%E7%9C%9F%E7%9A%84%E5%BE%88%E4%B8%9D%E6%BB%91%EF%BC%81/" title="抖音谷歌play版，真的很丝滑！">抖音谷歌play版，真的很丝滑！</a><time datetime="2025-01-22T04:43:48.000Z" title="发表于 2025-01-22 12:43:48">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/Quick%20Startup%EF%BC%8C%E5%BF%AB%E6%8D%B7%E5%A4%84%E7%90%86%E8%87%AA%E5%90%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%8A%A0%E5%BF%AB%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E9%80%9F%E5%BA%A6%EF%BC%81/" title="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！"/></a><div class="content"><a class="title" href="/2025/01/22/Quick%20Startup%EF%BC%8C%E5%BF%AB%E6%8D%B7%E5%A4%84%E7%90%86%E8%87%AA%E5%90%AF%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%8A%A0%E5%BF%AB%E7%94%B5%E8%84%91%E5%BC%80%E6%9C%BA%E9%80%9F%E5%BA%A6%EF%BC%81/" title="Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！">Quick Startup，快捷处理自启程序的工具，加快电脑开机速度！</a><time datetime="2025-01-21T19:35:09.000Z" title="发表于 2025-01-22 03:35:09">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E5%BF%83%E7%BB%AA%E6%97%A5%E8%AE%B0/" title="心绪日记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="心绪日记"/></a><div class="content"><a class="title" href="/2025/01/22/%E5%BF%83%E7%BB%AA%E6%97%A5%E8%AE%B0/" title="心绪日记">心绪日记</a><time datetime="2025-01-21T16:49:22.000Z" title="发表于 2025-01-22 00:49:22">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/20/%E7%9B%90%E9%80%89%E6%95%85%E4%BA%8B%EF%BC%8C%E8%BF%99%E5%87%A0%E4%B8%AA%E7%BD%91%E7%AB%99%E8%B6%B3%E5%A4%9F%E4%BD%A0%E7%9C%8B%EF%BC%81/" title="盐选故事，这几个网站足够你看！"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="盐选故事，这几个网站足够你看！"/></a><div class="content"><a class="title" href="/2025/01/20/%E7%9B%90%E9%80%89%E6%95%85%E4%BA%8B%EF%BC%8C%E8%BF%99%E5%87%A0%E4%B8%AA%E7%BD%91%E7%AB%99%E8%B6%B3%E5%A4%9F%E4%BD%A0%E7%9C%8B%EF%BC%81/" title="盐选故事，这几个网站足够你看！">盐选故事，这几个网站足够你看！</a><time datetime="2025-01-20T14:58:34.000Z" title="发表于 2025-01-20 22:58:34">2025-01-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="智汇君" target="_blank">智汇君</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">123</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">51</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">28</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/ChatGPT/" style="font-size: 0.88rem;">ChatGPT<sup>1</sup></a><a href="/tags/CloudFlare/" style="font-size: 0.88rem;">CloudFlare<sup>2</sup></a><a href="/tags/EScrcpy/" style="font-size: 0.88rem;">EScrcpy<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 0.88rem;">GitHub<sup>4</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 0.88rem;">NodeJs<sup>1</sup></a><a href="/tags/PowerToys/" style="font-size: 0.88rem;">PowerToys<sup>1</sup></a><a href="/tags/US-KG/" style="font-size: 0.88rem;">US.KG<sup>1</sup></a><a href="/tags/Vip%E8%A7%86%E9%A2%91/" style="font-size: 0.88rem;">Vip视频<sup>1</sup></a><a href="/tags/seal/" style="font-size: 0.88rem;">seal<sup>1</sup></a><a href="/tags/yt-dlp/" style="font-size: 0.88rem;">yt-dlp<sup>1</sup></a><a href="/tags/%E4%BC%91%E7%9C%A0/" style="font-size: 0.88rem;">休眠<sup>1</sup></a><a href="/tags/%E5%85%8D%E8%B4%B9/" style="font-size: 0.88rem;">免费<sup>3</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 0.88rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8A%9F%E8%83%BD%E9%9B%86%E5%90%88%E8%BD%AF%E4%BB%B6/" style="font-size: 0.88rem;">功能集合软件<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D/" style="font-size: 0.88rem;">域名<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E6%89%98%E7%AE%A1/" style="font-size: 0.88rem;">域名托管<sup>1</sup></a><a href="/tags/%E5%9F%9F%E5%90%8D%E7%94%B3%E8%AF%B7/" style="font-size: 0.88rem;">域名申请<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 0.88rem;">大数据<sup>26</sup></a><a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">大模型<sup>1</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 0.88rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%AE%9E%E6%97%B6%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 0.88rem;">实时语音转文字<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 0.88rem;">廖雪峰<sup>7</sup></a><a href="/tags/%E6%89%8B%E6%9C%BA%E6%8A%95%E5%B1%8F/" style="font-size: 0.88rem;">手机投屏<sup>1</sup></a><a href="/tags/%E6%B3%A8%E9%94%80/" style="font-size: 0.88rem;">注销<sup>1</sup></a><a href="/tags/%E7%94%B5%E9%87%8F%E6%98%BE%E7%A4%BA/" style="font-size: 0.88rem;">电量显示<sup>1</sup></a><a href="/tags/%E7%9D%A1%E7%9C%A0/" style="font-size: 0.88rem;">睡眠<sup>1</sup></a><a href="/tags/%E7%A3%81%E5%8A%9B/" style="font-size: 0.88rem;">磁力<sup>1</sup></a><a href="/tags/%E7%A3%81%E5%8A%9B%E6%90%9C%E7%B4%A2/" style="font-size: 0.88rem;">磁力搜索<sup>1</sup></a><a href="/tags/%E8%93%9D%E7%89%99%E8%AE%BE%E5%A4%87/" style="font-size: 0.88rem;">蓝牙设备<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E8%BA%AB%E4%BB%BD%E7%94%9F%E6%88%90/" style="font-size: 0.88rem;">虚拟身份生成<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%A7%A3%E6%9E%90/" style="font-size: 0.88rem;">视频解析<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91%E8%BD%AC%E5%AD%97%E5%B9%95/" style="font-size: 0.88rem;">视频转字幕<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%87%8D%E5%90%AF/" style="font-size: 0.88rem;">重启<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 0.88rem;">面试<sup>12</sup></a><a href="/tags/%E9%9F%B3%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97/" style="font-size: 0.88rem;">音视频转文字<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("24/12/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 智汇君 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("24/12/2024 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="https://at.alicdn.com/t/c/font_4792307_02gxbpyxcpwp.js?spm=a313x.manage_type_myprojects.i1.10.56323a81KZGFDE&amp;file=font_4792307_02gxbpyxcpwp.js# 阿里图标symbol 引用链接，主题会进行加载 symbol 引用"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>