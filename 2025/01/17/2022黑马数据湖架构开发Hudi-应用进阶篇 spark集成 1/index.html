<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>2022黑马数据湖架构开发Hudi-应用进阶篇 1 | Tech智汇站</title><meta name="keywords" content="大数据"><meta name="author" content="智汇君"><meta name="copyright" content="智汇君"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="2022黑马数据湖架构开发Hudi-应用进阶篇 1"><meta name="application-name" content="2022黑马数据湖架构开发Hudi-应用进阶篇 1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="2022黑马数据湖架构开发Hudi-应用进阶篇 1"><meta property="og:url" content="http://example.com/2025/01/17/2022黑马数据湖架构开发Hudi-应用进阶篇 spark集成 1/index.html"><meta property="og:site_name" content="Tech智汇站"><meta property="og:description" content="2022黑马数据湖架构开发Hudi-应用进阶篇 1123456掌握大数据基础框架安装部署理解滴滴运营分析业务需求及实现思路编程实现滴滴运营分析（数据存储和SQL查询）掌握Hudi与集成Hive掌握结构化流实时流式写入数据到Hudi表了解Hudi表支持SparkSQL语句查询  Hudi 应用进阶篇之"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta property="article:author" content="智汇君"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg"><meta name="description" content="2022黑马数据湖架构开发Hudi-应用进阶篇 1123456掌握大数据基础框架安装部署理解滴滴运营分析业务需求及实现思路编程实现滴滴运营分析（数据存储和SQL查询）掌握Hudi与集成Hive掌握结构化流实时流式写入数据到Hudi表了解Hudi表支持SparkSQL语句查询  Hudi 应用进阶篇之"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20spark%E9%9B%86%E6%88%90%201/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css#fontawesome_animation 如果有就会加载，示例值：https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":270},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 智汇君","link":"链接: ","source":"来源: Tech智汇站","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Tech智汇站',
  title: '2022黑马数据湖架构开发Hudi-应用进阶篇 1',
  postAI: '',
  pageFillDescription: '2022黑马数据湖架构开发Hudi-应用进阶篇 1, Hudi 应用进阶篇之集成Spark–课程内容大纲和学习目标, 大数据环境准备, 离线tar安装MySQL 5.7, 检查系统是否安装过mysql, 卸载 Centos7 系统自带mariadb, 删除etc目录下的my.cnf 一定要删掉等下再重新建, 创建 mysql用户组和用户, 解压安装 mysql, 编译安装并初始化 mysql务必记住数据库管理员临时密码, 编写配置文件 my.cnf 并添加配置, 启动mysql服务器, 添加软连接并重启 mysql 服务, 修改初始密码, 开放远程连接, 开机自启, 客户端远程链接数据库, 安装部署Hive, 首先、解压tar包和设置环境变量, 其次、创建HDFS目录和配置Hive属性, 配置hive-site.xml属性, 再者、添加用户权限hadoop, 初始化数据库和启动MetaStore服务, 启动HiveServer2服务和beeline命令行, 使用beeline客户端连接, 安装部署Zookeeper, 安装部署Kafka, 滴滴运营分析, 集成Hive查询, 结构化流写入Hudi, 集成 SparkSQL–快速体验数据CRUD, 启动服务, 设置参数, 创建表, 插入数据, 更新, 删除黑马数据湖架构开发应用进阶篇掌握大数据基础框架安装部署理解滴滴运营分析业务需求及实现思路编程实现滴滴运营分析数据存储和查询掌握与集成掌握结构化流实时流式写入数据到表了解表支持语句查询应用进阶篇之集成课程内容大纲和学习目标大家好接下来呢我们继续来看我们的一个使用那今天呢我们来给大家讲的应用进阶篇那其实我们的第二部分与应用进阶篇当中呢与我们的集成在前面我们给大家去讲到了呢是一个数据湖框架帮助我们更好的去管理数据那一开始诞生的时候呢就是哎管理存储在文件系统上的数据让我们更好的去管理那比如说它可以对我们存储在上的数据呢小文件进行自动的合并再比如呢可以啊使得我们对文件系统上的数据进行一个更新进行删除以及我们可以对文件系统的数据我们进行的这种查询等等等等好了一开始诞生呢就是跟进行集成的是既不存储数据又不分析数据就是管理数据我们需要使用一个分析引擎来进行操作我们的数据比如说把数据给它放到中去以及从中呢加载数据那在进行管理数据的时候跟很类似都是有表的概念非常类似于我们中的分区表好接下来呢我们就重点讲一讲怎么与集成以及在批量的这种保存数据批量的加载数据流式的保存数据当中去好那接下来呢我们看一下啊前面我们讲到了数据湖框架从诞生之初哎只支持我们进行操作啊呢它的一个中呢数据源我们可以从表读也可以往表写从成为顶级项目以后很多公司呢都开始用它来管理数据诶包括框架呢已经成熟了后来呢也逐渐的去支持我们了那一直到版本当中我们跟的集成也是非常非常的好了并且在版本当中呢我们呢也支持专门支持我们中支持写语句和语句那接下来呢我们先看与的集成那集成呢我们主要从三方面给大家讲那既然与集成我们肯定要去准备我们大数据的这种环境我们知道是分析数据的我们呢是管理数据的那在这里就牵扯到一些东西比如说我们通过我们把数据写到我们表中去了那我们要对这个表的数据分析我们这时候很可能怎么办呢我们使用来做分析哎那我们呢是需要跟我们可以跟我们整合的中的表直接关联到我们中的表就可以了让来管理数据呢做分析数据此外我们也知道我们呢它其实是一个数据湖是一个流式的数据湖框架也就是说我们可以源源不断的增量的把我们的业务数据呢写到的表中去流式的增量的那这时候呢我们也可以使用编写我们框架中的结构化流程序把数据从消费数据然后转换处理后写到我们的表中那这时候呢我们需要去搭建安装我们的的消息队列那这是我们的大数据环境准备第二部分呢我们来通过一个案例就是滴滴的这种出行数据啊诶我们知道这个框架诞生于它的出行数据那我们直接用滴滴公开的这个出行数据哎海口市的一个数据我们来做这些处理首先我们把滴滴的这个数据呢我们给它进行清洗处理以后呢写到我们这个这个表中去然后呢我们使用做这种批量分析以及使用我们来写进行查询分析这第二部分我们来给大家去整合一下第三部分呢我们来讲一下结构化流哎实时的把我们数据写到表这种实时的数据入湖操作这是最常见的一种操作后面呢我们还会讲怎么实时的把数据入湖最后我们给大家讲一下在版本当中的新特性跟我们直接集成我们直接写这种语句创建表删除表以及直接写语句插入数据更新数据删除数据包括我们写查询数据这种操作表的数据这是我们接下来讲的内容四个方面那我们主要的一个学术目标呢六个方面第一我们要掌握我们这一次内容当中涉及到大数据基础框架的安装部署其中主要的其实什的安装的安装部署的安装和我们讲的消息队列的安装我们都是采用这种伪分布式的单机版安装第二点我们要理解整个滴滴运营分析的业务需求以及实现思路其实我们在这里就用来帮我们管理数据啦最终还是存在上去的我们写代码把数据写到我们的表中去以及我们哎对这些运营指标我们来做一些统计分析啊我们呢写程序运行最后呢我们把数据可以保存到我们的数据库当中去紧接着我们来掌握一下与的这种集成啊那这样的话呢我们直接在当中创建表关联到我们护体表写就可以分析了第个方面我们要掌握结构化流怎么如何实时的把流式数据写到我们表中去的哎这个流式的数据湖到底是怎么写入数据的在进程当中这个代码到底怎么写第个方面我们要去了解一下表支持这种语句的这种查询数据的这种管理这是我们的一个学习目标大数据环境准备离线安装接下来呢我们首先来看一下我们第一部分的内容我们在讲与框架集成的时候我们要做一些大数据环境的准备前面我们提到这么一个数据库框架仅仅来管理数据好它从诞生之初就与我们分析引擎呢紧密的进行整合那我们可以通过这个计算引擎提供的这种接口我们把数据保存到表中去哎我们也可以呢使用从表中呢加载数据进行分析不仅支持我们中的批处理和流计算它还可以与我们的进行整合分析那接下来呢我们需要安装一些框架那这个框架呢我们可以看到首先我们需要安装一个数据库原因在于我们要使用与进行整合那的呢框架的原数据呢它是存储在我们的数据库当中的紧接着我们安装这个这么一个储藏框架啊安装完以后我们要去安装一个它是一个大数据当中的协作式框架因为我们要写结构化流程序从消费数据那我们这个框架呢它在管理数据的时候按照消息队列管理的它本身依赖于我们的什么呢那在这里面我们本次讲解的一个使用间接使用与集成我们的所有的软件就在这张图上面那当然的数据同样还是存在文件系统我们主要呢还是使用我们的的这种外部数据源从表读数据往表写数据以及我们结构化流其实也是对吧那我们与的整合其实就是两个表的关联那也就是说表数据关联到我们表存数据的一个目录直接读取就可以了安装安装安装安装好那接下来呢我们首先来去安装这些软件那安装软件当中呢那先呢我们来安装一下这么一个数据库那在的安装有很多种方式我们可以在线通过安装也可以离线安装那在这里呢我们通过一个简单的方式通过解压方式来安装好了这里面有完整的步骤我们按照步骤操作就行了那首先我们来看一下啊我们来切换一下在这边好那我们首先呢我们采用的方式安装数据库检查系统是否安装过命令在这首先我们检查我们这个系统有没有装过数据库来执行一下如果装过的话呢我们首先要把它给卸载掉然后再进行安装好同学们看到这里是没有的紧接着我们继续往下走卸载系统自带好然后呢我们卸载掉我们呢自带的啊这是跟数据库类似的好那我们把它给卸载掉啊我们卸载掉好那我们就是的把这个给它卸载掉删除目录下的一定要删掉等下再重新建好卸载掉完以后我们最好呢把数据库相关的一些配置文件给它删掉那有一个配置文件呢我们知道它是在我们讲的这个系统的目录下面啊往往有一个这个配置文件一定要删掉啊不然的话就会报错我们后面安装创建用户组和用户好紧接着我们安装数据库呢我们需要去干嘛呢创建一个这么一个用户组和用户那接下来我们来执行命令好这个比较简单我们添加在系统添加一个组名称就叫然后呢我们添加一个用户指定这个用户的用户组叫然后呢用户名称叫这样的话呢我们就创建好了解压安装紧接着呢我们需要去下载包我给大家已经已经提前下载好了我们直接呢进行上传就可以了然后我们进行解压安装啊进行解压就可以了这种方式是最简单的方式同学们啊那我们在企业的生产环境中呢我们往往也采用这种方式包安装非常的简单啊避免我们什么在线啊下载等等的东西好解压完以后呢我们来看一下这个目录是比较长的是不是我们直接给它改掉我们不需要那么长的名称好然后同学们可以看到这个包啊它的一个用户名和用户组啊它不属于我们什么呢不属于我们是不是啊我们可以进行修改可改成也可以不修改啊好那我们修改一下吧编译安装并初始化务必记住数据库管理员临时密码好呃那紧接着我们继续往下操作然后呢我们进入到这个目录下面有一个什么呢有个目录同学们啊里面呢有很多脚本其中有个好那我们运行这个脚本呢我们进行初始化的操作在这啊后面加上这么一串啊初始化设置我们的初始用户我们的数据存储目录叫我们的基础目录叫好同学们我们来回车执行一下啊如果有问题咱们再去修改啊好啦呃这样的话呢我们整个呢就给大家去做完了啊编写配置文件并添加配置那做完以后紧接着我们要去编辑一下啊叫在我们叫做下面有个文件的配置文件啊然后呢我们进行加上以下配置直接一下就可以了这个在课程讲过启动服务器接下来我们就可以启动我们的数据库了启动数据库呃启动数据库呢也是比较简单的咱们来启动可以看到啊这里面有个什么那这里面如果启动包异常的话呢这里面有个日志我们可以稍微的去看一下这个文件好同学们看这里面没有报错只是告诉我们这个密码叫什么是不是啊添加软连接并重启服务启动完以后啊我们要添加软链接然后呢再重启我们的服务以后我们启动就不用麻烦了大家看这里面已经说我们重启成功了修改初始密码重启成功以后我们来登录输入我们初始化的一个密码那初始化密码在哪里呢密码就是我们初始化生成的临时密码在哪呢在我们启动的时候应该会告诉我们有一个初始化的密码我们在进行初始化的时候其实这里有个密码同学们要注意啊进来以后我们要去设置一下我们的密码叫好这样的话呢我们就设置好了开放远程连接设置好以后我们来这个数据库然后呢我们要进行更新好执行完以后我们进行刷新一下啊哎我们来刷新一下这个权限开机自启做完以后紧接着同学们我们基本上就设置完成了我们可以退出了退出以后我们来设置一个我们数据库随机启动啊随着我们这个开机进行启动好这里面我们得稍微设置一下啊在这我们重新再来启动一下我们的服务好我们看一下大家看是不是启动了客户端远程链接数据库那紧接着呢我们来通过客户端链接一下好我们就使用我们这个来链接一下那在这里面这里面有一个数据库咱们创建一个链接好那我们看一下这个驱动包哎我们就用它就可以啦然后我们测试一下啊测试一下我们看能不能连接到我们的数据库没有问题的对不对连接在数据库中我们看到的这个用户这张表刚才其实我们更新了它的权限啊我们看一下来看我们是不是更新了呃它的主机任意的主机那这样的话呢我们整个数据库呢我们就安装完成了安装部署这里我按照大数据开发工程师篇来的注意在配置时那个是使用的不是我主机的那我们把马赛克数据库安装好了接下来呢我们来安装那呢我们都知道是大数据当中的数仓的这么一个工具框架啊帮我们去管理数据的按照分层的架构去管理以及呢我们可以使用呢呢来写语句它默认的把转换成来处理数据在企业中呢基本上我们都会用啊哪怕我们用来管理原数据我们用分析或者用分析好那的安装呢也是比较简单的我们直接解压框架的包配置依赖和原数据数据库信息最后呢我们启动它的原数据和服务就可以了那这里有张图是我们框架的一个核心点那我们可以看到这里有个原数据存储在关系数据库当中往往我们选择数据库此外呢它其实最主要它就是一个驱动就是一个引擎当不管是我们命令行还是我们的的界面以及我们讲的通过方式链接我们发送语句语言以后我们这个中的会把进行解析哎然后呢生成我们的计划然后优化最终呢进行执行那执行的话呢我们可以看到把我们的转换成然后处理数据所以说在这里面我们啊我们用来管理原数据我们呢不需要启动因为我们生成的呢运行在本地模式就可以了首先解压包和设置环境变量好我们已经配置好了已经做好了接下来我们来装安装也是比较简单的就是解压上传配置环境变量就可以了好在这里呢这个软件呢我给大家提供了在这啊那接下来呢我们来上传进行操作一下然后呢我们给他一个执行权限解压完以后我们呢要给它重命名并且呢我们创建一个软链接我们整个呢就安装好了紧接着呢我们来根据步骤往下看我们进入到的目录下面去然后呢我们修改配置文件进行修改我们去修改好在这里面我们来命名一下在这里面呢我们需要添加一些东西啊我们看一下这里面有些东西呢其实我们可以把它全部给删掉啊首先我们要设置一个的安装目录这里面有个的配置文件目录这个呢我们要进行设置一下好做完以后紧接着我们再往下看最后一行呢其实就是我们什么呢它的一个包所在的路径啊那这个呢我们可以直接设置我们下面的什么目录就可以了啊同学们好这样的话呢我们整个环境变量里面的配置呢我们基本上就完成了其次创建目录和配置属性配置完以后我们要先干嘛呢启动我们的这个服务好启动服务啊然后呢我们再启动一下好启动完以后我们稍等片刻稍等片刻啊我们等到安全模式结束以后我们再去启动啊再去创建目录那我们可以呢通过我们进行查看这个界面啊查看我们可以看一下这个界面啊目前还是安全模式我们稍等几秒钟创建这个目录配置属性在这里面我们可以看到这就是一个我们说了我们的这个数据库所在的地址这下面还有一些其他的东西啊驱动以及我们用户名密码以及我们讲的存储目录包括我们的地址以及我们讲的其他一些属性配置再者添加用户权限好配置完成以后紧接着我们再做一件事情我们要去看一下我们的这个中啊添加这种哎权限配置我们看有没有配置初始化数据库和启动服务好配好以后紧接着我们要进行初始化我们的数据库同学们那这时候呢我们首先要把我们在我们的的内部目录下面放入的驱动包这驱动包呢在这我们直接放到的内部目录下就可以了注意一下我们要出始化数据库我们进入到的目录下面有一个我们来出始化数据库啊这个工具好接下来呢我们来回车执行一下啊执行一下整个过程呢一开始可能有点慢啊咱们不要去急按照步骤来操作我们看有没有多了一个启动服务和命令行做完以后紧接着第步我们来启动我们的什么呢服务那我们可以直接启启动这个命令大数据开发工程师哪里没有这个启动服务啊只有初始化我们也可以写脚本啊包括我们在启动服务是一样的好那这里呢我给大家写好了脚本这是我们相关的三个脚本那我们可以把脚本呢放到我们的这个下去然后呢我们给他一个执行权限好给它执行权限以后呢然后我们看这个脚本啊同学们那在这里面呢我们来配置一个的环境变量啊我们用就是可以直接启动了啊我们再去启动我们的服务啊就是哎然后呢我们要再去启动我们的使用客户端连接啊当启动完成以后我们去启动什么呢我们来进行一个链接我们来试一下看能不能连接成功同学们啊好了这是我们稍微等一下因为这是比较慢的啊大家看已经链接上去了那这时候我们来看一下我们这个呢中呢是没有表的啊是没有表的那我们它只有一个什么呢这数据库里面呢也没有表好那为了后面的方便呢我们在这个当中呢我们已经我们也配置一个我们的好吧的配置也简单他这里使用默认的驱动失败了然后使用了一个自己下载的注意下安装部署接下来呢我们来安装另外一个就是那鲁这个框架呢我们后面卡夫卡需要依赖包括我们后面讲我们的护地与冯定的集成我们进行实时的数据入库的时候都要用到卡夫卡那卡夫卡呢又依赖于我们组协作框架组的安装呢非常简单我们说是阿尔法奇顶级项目啊它是为分布式的应用呢提供高效高可用的分布式的这种协调服务我们很多很多的框架都依赖于它比如说的高可用我们的高可用数据库卡不卡等等等等都依赖于它那如呢要求我们的集群呢是基数的在整个集群决算当中呢有和主要是用于对外进行什么呢提供这种服务的写数据的那呢可以进行读数据的我们所有的都跟来进行同步好了接下来呢我们来进行安装一下我们是单机版的安装也是很简单我们首先进入到我们安装目录下面去然后呢我们进行安装就可以了好然后呢这里面呢我先退出同学们我们先退出好然后呢我们先看到我们的上下面去然后呢我们去上传我们这个软件包软件包呢这里面我们给大家已经放好了放在这下面叫做好我们直接给他上传就可以了上传完以后我们直接呢进行挤压同学们首先呢给他一个执行权限啊好然后呢我们解压一下吧他包解压一下解压完成以后同学们我们可以看到我们来创建软件机这个用户有点不对我们稍微变一下啊我们把它改成好吧好然后呢我们创建一个软件接啊创建这么一个软件接音节的话呢读我们就叫读好并且我们删除这个软件包把软件删掉没什么用对吧好这样的话呢我们整个就装好了同学们我们可以看一下此时我们已经把如给它解压完成了解压完成以后我们要进行简单的配置进入到组的客服目录下面我们进行配置配置的数据的一个存储目录好进入到目录下面去同学们接入以后我们进入到看膜的下面那这里面有个入杠这个配置文件改个名称同学们啊改完以后我们来进行写一下在这里面呢我们把这个数据的存储目录呢我们稍微改一下啊不用这个目录我们改成一个我们的目录在这里面比较简单一点好我们到群我们创建一个目录我们叫做目录然后我们进拷贝一下这个目录字目录那我们数据放这里面这样的话呢我们整个就配置完成了配置完成以后同学们我们来再做一个事情我们来配置环境变量方便呢我们进行使用好在这里面我们看一下环境变量呢在这同学们啊我们来看一下那回撤一下我们在最后的话去添加就是我们讲的对吧还有我们哎对吧配置一个这么一个好紧接着呢我们往下看这是我们所讲的好那我们保存一下同学们保存下来保存完以后呢这样的话呢我们就配置好了我们就可以启动我们的服务了在这里我们再做一个稍微的配置啊做个什么配置呢同学们我们看一下在这个音目录下同学们有一个脚本我们稍微修改一下这个脚本叫这个脚本在这个脚本当中啊我们去设置一个路径啊设置个什么路径呢就是我们启动组的时候它的日志的一个目录这个目录如果你不设置的话你在哪启动就在哪目录下面这是不好的啊好我们把它设置一个值设置什么值呢同学们看一下就设置我们在做下面啊再组项你就可以了好在组题下面好在这里面呢我们可以起创建一个目录啊创建目录在这我们退出杠什么呢好没底好同学们这样的话呢我们启动组在任何启动它的这个日志上都在字母上去好那这样的话我们然后呢我们来启动组就可以了啊使得生效我们来启动启动比较简单哎我们可以直接打哎就是什么好启动完以后呢我们再打一个四四同学们这是不是单的那我们单机版配置的那这样的话呢我们整个组版呢就给它启动好了安装部署哎那版安装好以后呢我们来安装我们的这个分布式消息对联卡夫卡我们用的是版本那我们知道卡夫卡最初呢由拟音公司开发的它是一个分布式的分区的多副本的多订阅的一个消息系统但是它依赖于一种那最新的版本当中它是不依赖于的啊那卡不卡呢常常用于于用于我们网站的和服务器日志的一个缓存存储它早已是阿帕奇顶级项目了我们只要做牛市的实时计算基本上我们都会用到组卡不卡卡卡呢依赖于我们讲的组集群它这里面的数据呢是放在一个当中的划分成很多分区每个分区呢有多个副本好接下来呢我们来安装一下卡不卡也是比较简单的啊那这里呢我们的软件呢也给大家呢准备好了在我们这一个目录下面大家可以看到这里面有一个叫做卡夫卡的版本基于盖版本的好接下来呢我们来安装一下同学们那首先呢我们进入到部下面去然后呢我们来上传同学们上传完以后我们来进行解压啊进行解压那首先我们啊的话呢我们给他一个权限然后呢我们踏包进行解压踏包解压好解压完成以后我们呢看一下这个目录啊看垂线好像是没有什么问题的对不对卡不卡那在这里面呢我们创建一个软件接啊卡不卡那我们就要卡不卡对吧删除我们这个卡夫卡的什么呢卡包淘啊淘宝好筛然后呢我们进入到卡夫卡的这个目录配置目录叫目录同学们我们看一下目录啊那在目录下面呢我们可以看到它有些配置我们来进行修改好同学们我们来看一下配置在哪里呢好我们看一下在这里面修改内容呢比较简单那首先其实就是一个监听地址一个就是我们的卡夫卡的数据存储地址一个依赖一种的地址好我们只修改这个地方就可以了好我们修改一下不好我们看多少行同学们往下走那这个第一个这是我们不用改这个我们稍微改一下同学们啊稍微改一下然后呢这里面我们写上这个地址就可以了啊我们这是好再往下走下面这个呢我们也不用改什么东西啊不用改好之后注意这个路径我们得改一下同学们这是我们存储的数据的一个路径啊好这是我们讲卡夫卡的一个消息队列对不对我们创建这目录好我们到卡夫卡中去同学们啊然后呢我们麦到创建这么一个路径嗯同学们我们写错了我们不应该写写个杠把杠给去掉好进入到卡夫卡的客服下面下去我们查看我们的这个卡夫卡的最终消息存储的这个磁盘的一个位置好这样配完以后我们继续往下走一直走到最后同学们我们要做最后干嘛呢我们要去做一些事情就是我们依赖的的一个地址地址啊以及我们在上的位置阿卡点好那我们一对就什么呢就叫做卡卡看不看啊那这样的话呢我们整个配置呢就完成了同学们诶少了一个对吧少了一个不能写错啊好我们保存下来保存完以后我们要设置一下环境变量同学们那卡的环境变量呢设置起来也是比较简单的同学们啊我们看一下好我们看一下好我们在下面来设置一下来我们说卡不卡的一个卡不卡等于我们的安装目录好在这里面呢我们一下就是我们讲的卡不卡啊好配置完成以后我们来进行一下使得我们配置生效投入发扬好然后呢我们接下来呢我们就可以去启动我们这个服务了啊那服务启动也是比较简单的同学们我们看一下那卡不卡然后呢我们说哎我们放在后台启动是不是后台启动然后呢我们就指定一下卡卡下面的什么呢然后启动然后我们打个勾同学们看一下勾那个这里面我们可以看到卡夫卡这个节点那在这里给大家介绍个工具一个叫什么呢卡夫卡的工具这个工具呢很好用去链接我们的卡夫卡啊好同学们我们来看一下在这里面我们可以给它创建一个创建一个新的链接好这个名称呢我们叫忽底杠卡夫卡对吧而在这里面我们卡卡的版本是是在我们这台机器上面的啊这个地址其实是我们的地址后面有个卡普卡对吧来我们添加测试一下同学们我们看一下啊那这样的话呢我们创建查看数据呢就比较方便了啊我们直接在这个工具已经链接成功了同学们我们双击一下好那目前呢是没有的对不对什么都没有的只有一台机器那这样的话呢此时我们卡夫卡去安装完成呢安装完成以后我们就可以往卡夫卡消息对面写数据了我们也从可以从卡夫卡怎么样呢消费数据进行处理了那此时呢我们整个大数据的这个环境就给他准备好了那后面呢我们就要开展讲以从应用的角度实战的角度来讲我们与整合的一个使用啊我们批量的把数据加载到互表中去批量从互利表中读数据以及我们与与互表集成来分析互理表数据包括我们结构化流实时统卡卡消费数据并且把数据写到互理表以及我们进行一个查询分析滴滴运营分析集成查询前面呢我们讲到了直接从表里面呢加载数据然后进行指标分析接下来呢我们稍微的变换一下我们说了当我们把数据存到表以后我们还可以与我们的进行集成来做分析好接下来我们看一下我们就把我们前面刚才讲的这个滴滴的出行的这个数据在表中的对不对分区存储我们给它呢映射到我们表中哎我们从表中呢来编写进行查询哎这也是可以的好接下来呢我们来进行看一下怎么去完成那这时候呢我们就要涉及到与我们表的集成那这时候呢我们需要使用到一个包在我们前面编译完的这个安装目录下面其实有个和的这么一个包我们直接把这个包呢放到我们的目录下就可以了那我们拷贝依赖包到的路径下面为了我们能够正常的读取到这个数据啊那拷贝完以后同学们不要急着去操作我们要把我们的的服务给它重启一下那这样的话呢我们整个呃集成就配置好了啊就是一个架包对吧没有其他东西好配置完以后呢紧接着呢我们就需要呢在的命令行呢我们要创建表了把我们讲的滴滴出行的这个表呢映射到表中去啊在这里面呢我们创建表呢是属于一个外部表它基本的语句是这样大家看创建一个表是不是创建一个数据库叫然后呢我们使用数据库在这里面创建一个表这是一个一个外部表然后呢这里面是字段那在这里面我们要注意一下啊我们在这里存储的时候呢要加一个分区好我们呢刚才在存储数据我们分区其实只有一列就日期分区对不对我们就写一个一个分区那在这里面我们要指定一个什么东西呢同学们看就是我们数据的存储格式叫注意它是我们时代存储在互利表中并且是列式存储最后呢我们得指定其实就是我们数据的存储的一个路径就可以了啊这比较简单的好那接下来呢我们切过来呃这边呢同学们我们昨天呢在讲这个的时候呢其实我们已经配置了我们的这个对吧同学们看在这好了我们双击链接一下啊让让他去呢链接一下知道吧我们去链接一下好我们看一下吧好同学们我们来选择所有的我们来链接一下啊链接一下我们嗯穿的面看链接完成以后呢我们在这里编写我们的语句啊编写我们的语句好比较慢稍等片刻这应该是可以链接的啊我们看一下好应该是没有问题的呃我们看一下好了没有因为我们昨天安装好以后呢我们没有去写数据对不对链接好成功以后呢同学们我们在这里面打开一个终端打开一个终端啊打开终端好打开终端以后呢同学们我们来看一下在这里面我们可以去写一下我们在这里写写我们的数据好这个呢我先把它在这里面那首先我们刚才讲的第一步我们来创建一个数据库好同学们我们看一下啊我们说对吧如果不存在的话我们创建而这数据库呢我们叫做湖底可不可以啊好第二步呢我们来使用这个数据库对吧使用啊使用这个数据库那叫什么右侧的话互利对吧好我把这个呢给大家执行一下来我们看一下走好这边我们来看一下这个数据库好大家看是不是多了一个然后呢我们来使用这个数据库使用啊好使用咱们这个数据库这个使用对吧使用结束了啊那接下来第三步同学们我们都知道创建表是不是好我们看一下啊创建我们的表创建我们的表那我们说过了创建的是一个什么表呢外部表是不是不存在我们的创建是不是好这个表呢我们叫杠什么呢忽底杠可不可以啊那这里面是不是咱们字段名称啊好那这字段名称的同学们我们呢直接呢给大家一下啊这字段比较多啊我们写的也比较慢杭州自然名称好同学们这个呢是非常简单的就是我们这个表里面有多少字呢我们就写多少字呢给同学们贴上去我给它贴过来好我们调整一下格式调整格式啊好类型要对上同学们啊对上那第一个就是我们讲的订单然后产品等等那这是我们讲的分区路径以及这这些字段好紧接着呢同学们注意这里面我们需要加上一个什么呢叫的好这里面我们说这个类型我们得加上一下那在这里面我们其实就是一个日期它的类型我们叫什么呢叫子串对不对周长好那接下来呢有几个大家注意一下同学们就是我们讲的这个文件的这种格式啊注意这是固定的我直接贴过来啊在这第一个我们的我们的这种存储其实我们说我们说这个是一个什么是一个劣势存储对不对那我们是存储在什么呢忽底表当中的对吧那我们的输出格式也是好这是我们的数据的存储路径要注意就是存储路径我们是在大家看好了在下面滴滴海口下面是不是好这样的话整个表就创建好了那咱们这是一个分区表同学们注意好我们执行一下这一下啊执行完以后呢我们打开看看这个分区表创建好了那既然是分区表的话同学们都知道我们看一下我们可以是查看啊查看分区表的这个分区分区表的这种分区啊分区那我们说这里面有一个命令叫修帕选是不是这种表的名称啊好那咱们这个表的名称呢叫底点是不是我们的我们的啊搞定好了我们看有没有分区啊现在是没有分区的对不对好同学们现在是没有的是吧那但是同学们来看一下我们这个数据我们看一下啊我们是有的有多少个个分区那咱们是不是要手动添加分区啊好那紧接着呢我们做一件事就是我们讲的哎手动的我们要去添加这个什么呢分区信息添加分区信息好同学们那添加分区呢这个命令大家会去写啊我们来写一下叫什么呢是不是好我们说底是不是然后啊如果不存在的话我们添加分区好同学们这个呢就是我们讲的叫哎我们讲的这个字段值好这个字段值呢我们要注意一下那这里面的值值我们知道这是从月份开始对不对暂开始好那咱们就一直往下添加啊把它添加完成并且在后面我们要去指定一个字段叫什么呢是不是我们的数据的位置啊好数据位置呢我们指定一下同学们这是我们讲完整的那整个数据的位置我们看一下是在这个目录下面同学们注意啊设置中控下面叫什么呢这个路径下面的数据对吧整顿下面诶在后面同学们啊在这里面我们稍微看一下你看点进去嘛这是不是个路径啊整个路径整个路径啊好这样的话呢我们需要去添加个这么一个东西好那我们一个写三四五六七八九十一二三四五六七八钱不多好我们说从多少方呢从二十三二十二号二七二八二九三十三十一好这是这是二十四二十五二十六二十七二十八然后是不是啊以及什么三十一没问题好那我们再看那第二个呢其实就是我们月份的月份从从几号开始从号开始一直到号注意同学们这前面没有啊没有零啊这个对吧年月号对吧月号啊月号好咱们写下一二号号号号号号号号号好我们写一下号号号号号号号号号对吧好最后一个呢重复掉了在这里大家千万不要忘记了我们后面这路径也得改是不是对吧二十三二十四对吧二十七二十八二十九三十好有人说了老师啊这有没有工具呢有工具啊那在这里面我们就采用最简单的方式来做好吧那这其实就是我们讲这样我一一嗦一说把它改掉啊然后呢这是我们讲什么呢嗯这说明举同学们啊最后是咱们讲什么呢那的话呢这是月份月号那这样的话呢我们整个个分区呢我们给它手动添加上去好同学们我们来执行一下个分区好给他执行总共有个分区对不对月份个我们月份个好整个呢执行完成以后呢同学们我们再修一下看一下多少个分区大概分区是不是有了好有了以后紧接着咱们别忙着进行分析进行分析咱们首先来进行查询一下数据好咱们测试好我们进行测试我们来查询数据啊测试我们查询我们的数据好同学们我们来看一下然后呢护理好这里面这个数据呢我们不要查那么多我们首先查一个订单的订单啊然后呢我们查一下叫做我们说这有个叫产品的是不是产品啊我们说有一个类型有一个预支的一个费用是不是还有一个我们叫做交通的类型是吧还有一个我们叫做距离叫啊就是距离好那今天呢我们来查询一下这个数据我们不需要太多我们查询啊条就可以了同学们好那在这里呢我们把这条语句选起来我们来执行一下看结果同学们啊好了呃同学们我们可以看到啊这里面讲到了一点啊我说我们说我们当前的模式什么模式啊严格模式好严格模式我们不加分区呢它会出错的好所以我们先设置一下吧我给他报了一个错就是严格模式好我们设置为什么呢呢就可以了好我先设置好然后呢我们再去执行好再去执行的话大家可以看到数据是不是查出来了查出来了这是我们用这个工具非常好用大家可以看到啊这是我们完整的一个结果同学们可以看到吧好了这是我们所讲的那接下来呢我们就可以在这上面我们写思考来进行什么啊进行我们的这种指标的这种统计分析了好这是我们讲的与互利表的一个集成首先就是创建表创建表的时候要注意啊因为我们是分区目录指定分析字段以及我们下面这几个属性我们就是统一的这样去配置就可以了最后呢我们手动的添加这个分区那刚才说过了我们一定要去设置一些非严格模式然后再去查数据看一下结果那集成完成以后呢那咱们呢就可以继续来去写我们的代码了来做我们的这种分析报告了啊做我们的分结构化流写入集成快速体验数据页启动服务接下来呢我们看另外一个知识点啊也跟我们相关跟我们护底的这种集成是在的最新版本版本当中呢提供的与我们集成说白了就是我们可以在提供的交互式命令行呢我们直接可以写这种语句来关联我们表的数据来对表进行增删改查操作在与集成当中呢我们可以创建表创建表呢我可以创建成管理表外部表分区表可以通过子查询来创建表我们可以写语句直接插入语句插入数据我们可以写语句直接什么呢查询数据当然我们还可以进行更新数据和删除数据更新数据当中我们可以用和两种方式来做好那接下来呢我们来看一下这个怎么与呢来集成我们讲的是命第一件事情我们来启动我们相关服务启动我们命令行好启动的话呢我们首先看一下首先呢老师常谈的问题我们说互的数据呢我们是存在文件系统上面的所以首先我们要去启动我们的的和呢的服务啊这服务其实咱们已经启动过了紧接着我们再往下看我们要启动交互命令啊我们要设置依赖架包和相关属性在这里同学们要注意一下我们运行在本地模式然后呢我们还是把个依赖包给它放上去以及我们讲的序列化那在这里面我们要添加一个东西同学们注意了注意了啊添加个什么呢的扩展写这么一个属性啊也就是说我们创建出命令行以后我们创建对象是个集成的设置参数这样的话呢就启动我们一个的这么一个交互式命令了在这里面我们来进行一个操作啊好稍等片刻啊稍等好启动完以后呢我们可以打个默认情况下其实我们这个数据库啊它只有一个数据库对不对没有其他数据库好启动完以后紧接着在这里面我们得设置几个属性因为我们对互利操作的时候在命令行你是插入数据更新数据删除数据的默认它的这个并行度啊为太大了我们把这数据呢给它设置小一点同学们设置为几呢设置为好三个呢设置完以后一个是一个是一个设置完以后紧接着呢我们要设置一下同步不同步我们表的原数据啊是不同步的啊创建表这个属性设置完以后我们就准备好了接下来呢我们就可以去使用了好接下来我们看一下怎么去用啊这个也是比较简单的好那紧接着呢我们往下走那首先呢我们来创建这么一张表啊我们编写一个语句那我们创建一张表呢关联到我们表中去同学们我们来看一下啊好同学们这时候呢这个表已经创建完成了好创建完表以后我们接下来往表里面写数据那写数据的话呢创建完以后我们可以显示一下这个表我大家看这个表里面增加了我们讲的个字段是不是好这个我们不管紧接着我们往这个表里面怎么样呢写数据往表里面写数据我们使用什么语句呢我们把数据呢写到表中去那这个就比较简单了我们叫插入数据好我们一次性多插几条数据进去好我们给他执行大家稍等片刻啊这个比较慢我们先不管它其实我们这个表中有几条数据了有条数据好同学们紧接着往下看接下来呢我们来从这个表里查数据我们这就是我们所讲的这是用来进行操作我们数据的那此时我们可以看一下我们这个表的这个结构好那这种方式呢就非常非常的极大的简便了让我们直接写写词口语句好那我们也可以指定字段来进行查询我们查询一些数据同学们我们来指定字段啊我们查询一下我们直接一下就可以了同学们来看一下好在这叫看一下回撤那这样的话我们看到我们只查这么几个字段啊只查这么几个字段更新当数据查询完以后呢我们还可以干什么呢我们还可以进行更新数据同学们更新数据更新数据就是我们讲的标准的这种语句比如说我们更新一个表这就是更新语句啊删除好当然我们这里面还可以怎么样呢我们还可以删除数据那就是我们再去查一这条数据我们看能不能查到同学们看一下有没有数据啊没有数据已经查不到了因为这条数据是不是被我们删除掉了被我们删掉了好这是我们讲的这个跟我们支持写这种要语句和我们讲的插入更新删除查询的语句非常的方便好这个功能呢我们要知道一下有这功能',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-03 23:24:47',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Tech智汇站</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 1.05rem;">GitHub<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 1.05rem;">NodeJs<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>3</sup></a><a href="/tags/github/" style="font-size: 1.05rem;">github<sup>1</sup></a><a href="/tags/idea/" style="font-size: 1.05rem;">idea<sup>1</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 1.05rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 1.05rem;">大数据<sup>26</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 1.05rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 1.05rem;">廖雪峰<sup>9</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.05rem;">面试<sup>12</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">74</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url">大数据</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi/" itemprop="url">2022黑马数据湖架构开发Hudi</a></span></div></div><h1 class="post-title" itemprop="name headline">2022黑马数据湖架构开发Hudi-应用进阶篇 1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="post-meta-icon anzhiyufont anzhiyu-icon-calendar-days"></i><span class="post-meta-label">发表于</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="发表于 2025-01-17 17:35:02">2025-01-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20spark%E9%9B%86%E6%88%90%201/"><header><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url">大数据</a><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi/" itemprop="url">2022黑马数据湖架构开发Hudi</a><h1 id="CrawlerTitle" itemprop="name headline">2022黑马数据湖架构开发Hudi-应用进阶篇 1</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">智汇君</span><time itemprop="dateCreated datePublished" datetime="2025-01-17T09:35:02.000Z" title="undefined 2025-01-17 17:35:02">2025-01-17</time></header><h1 id="2022黑马数据湖架构开发Hudi-应用进阶篇-1"><a href="#2022黑马数据湖架构开发Hudi-应用进阶篇-1" class="headerlink" title="2022黑马数据湖架构开发Hudi-应用进阶篇 1"></a>2022黑马数据湖架构开发Hudi-应用进阶篇 1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">掌握大数据基础框架安装部署</span><br><span class="line">理解滴滴运营分析业务需求及实现思路</span><br><span class="line">编程实现滴滴运营分析（数据存储和SQL查询）</span><br><span class="line">掌握Hudi与集成Hive</span><br><span class="line">掌握结构化流实时流式写入数据到Hudi表</span><br><span class="line">了解Hudi表支持SparkSQL语句查询</span><br></pre></td></tr></table></figure>

<h2 id="Hudi-应用进阶篇之集成Spark–课程内容大纲和学习目标"><a href="#Hudi-应用进阶篇之集成Spark–课程内容大纲和学习目标" class="headerlink" title="Hudi 应用进阶篇之集成Spark–课程内容大纲和学习目标"></a>Hudi 应用进阶篇之集成Spark–课程内容大纲和学习目标</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">大家好，接下来呢，我们继续来看我们hudi的一个使用，那今天呢，我们来给大家讲hudi的应用进阶篇，那其实我们的第二部分与应用进阶篇当中呢，与我们Spark的集成，在前面我们给大家去讲到了，hudi呢是一个数据湖框架，帮助我们更好的去管理数据，那hudi一开始诞生的时候呢，就是。哎，管理存储在HDFS文件系统上的数据。让我们更好的去管理，那比如说它可以对我们存储在HDF S上的数据呢小文件进行自动的合并。再比如hudi呢，可以啊，使得我们对文件系统上的数据进行一个更新，进行删除。以及我们可以对文件系统的数据，我们进行hudi的这种查询等等等等。好了，hudi一开始诞生呢，就是跟Spark进行集成的。hudi是既不存储数据又不分析数据，就是管理数据，我们需要使用一个分析引擎来进行操作我们的数据，比如说把数据给它放到hudi中去，以及从hudi中呢加载数据，那hudi在进行管理数据的时候跟hive很类似，都是有表的概念，非常类似于我们hive中的分区表。</span><br><span class="line"></span><br><span class="line">好，接下来呢，我们就重点讲一讲hudi怎么与Spark集成，以及在批量的这种保存数据，批量的加载数据，流式的保存数据当中去。好，那接下来呢，我们看一下啊，前面我们讲到了数据湖框架hudi，从诞生之初，哎，只支持我们Spark进行操作啊，Spark呢，它的一个sql中呢，datasource数据源我们可以从hudi表读，也可以往hudi表写，从hudi成为apache顶级项目以后。很多公司呢，都开始用它来管理数据，诶包括flink框架呢，已经成熟了，后来呢，也逐渐的去支持我们hudi了。那一直到0.9版本当中，我们hudi跟flink的集成也是非常非常的好了，并且在0.9版本当中呢，我们hudi呢也支持专门支持我们Spark sql中支持写DDL语句和DML语句，那</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">接下来呢，我们先看与Spark的集成，那Spark集成呢，我们主要从三方面给大家讲。那既然与Spark集成，我们肯定要去准备我们大数据的这种环境，我们知道Spark是分析数据的，我们。hudi呢是管理数据的，那在这里就牵扯到一些东西，比如说我们通过Spark，我们把数据写到我们hudi表中去了，那我们要对这个hudi表的数据分析，我们这时候很可能怎么办呢？我们使用hive来做分析，哎，那我们hive呢，是需要跟我们可以跟我们hudi整合的，hive中的表直接关联到我们hudi中的表就可以了，让hudi来管理数据，Hive呢做分析数据</span><br><span class="line"></span><br><span class="line">此外我们也知道我们hudi呢，它其实是一个数据湖，是一个流式的数据湖框架，也就是说我们可以源源不断的增量的把我们的业务数据呢写到hudi的表中去。流式的，增量的。那这时候呢，我们也可以使用编写我们Spark框架中的结构化流程序，把数据从kafka消费数据然后转换处理后写到我们的hudi表中，那这时候呢，我们需要去搭建安装我们的kafka的消息队列。那这是我们的大数据环境准备</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">第二部分呢，我们来通过一个案例，就是滴滴的这种出行数据啊，诶，我们知道hudi这个框架诞生于Uber，它的出行数据，那我们直接用滴滴公开的这个出行数据，哎，海口市的一个数据，我们来做这些处理，首先我们把滴滴的这个数据呢，我们给它进行清洗处理以后呢，写到我们这个。这个hudi表中去，然后呢。我们使用spark做这种批量分析以及使用hive我们来写sql进行查询分析。这第二部分我们来给大家去整合一下</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">第三部分呢，我们来讲一下结构化流，哎，实时的把我们数据写到hudi表，这种实时的数据入湖操作，这是最常见的一种操作，后面呢，我们还会讲flink怎么实时的把数据入湖。最后我们给大家讲一下在hudi0.9版本当中的新特性，跟我们spark直接集成，我们直接写这种DDL语句，创建表、删除表，以及直接写DML语句插入数据、更新数据，删除数据，包括我们写DQL查询数据，这种操作hudi表的数据。OK,这是我们接下来讲的内容四个方面</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">那我们主要的一个学术目标呢？六个方面，第一我们要掌握我们这一次内容当中涉及到大数据基础框架的安装部署，其中主要的其实什mysql的安装，Hive的安装部署，zookeeper的安装和我们讲的kafka消息队列的安装，我们都是采用这种伪分布式的单机版安装。</span><br><span class="line"></span><br><span class="line">第二点我们要理解整个滴滴运营分析的业务需求以及实现思路，其实我们在这里就用hudi来帮我们管理数据啦，最终还是存在HDFS上去的。</span><br><span class="line"></span><br><span class="line">我们写Spark代码，把数据写到我们的hudi表中去，以及我们，哎，对这些运营指标，我们来做一些统计分析。啊，我们呢，写Spark程序运行，最后呢，我们把数据可以保存到我们的数据库当中去。</span><br><span class="line"></span><br><span class="line">紧接着我们来掌握一下hudi与hive的这种集成。啊，那这样的话呢，我们直接在hive当中创建表，关联到我们护体表，写sql就可以分析了。</span><br><span class="line"></span><br><span class="line">第5个方面，我们要掌握结构化流，怎么如何实时的把流式数据写到我们hudi表中去的，哎，这个流式的数据湖到底是怎么写入数据的，在Spark进程当中。OK这个代码到底怎么写？</span><br><span class="line"></span><br><span class="line">第6个方面我们要去了解一下hudi表支持spark sql这种语句的这种查询数据的这种管理，OK,这是我们的一个学习目标。</span><br></pre></td></tr></table></figure>

<h2 id="大数据环境准备"><a href="#大数据环境准备" class="headerlink" title="大数据环境准备"></a>大数据环境准备</h2><h3 id="离线tar安装MySQL-5-7"><a href="#离线tar安装MySQL-5-7" class="headerlink" title="离线tar安装MySQL 5.7"></a>离线tar安装MySQL 5.7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">接下来呢，我们首先来看一下我们第一部分的内容，我们在讲与spark框架集成的时候，我们要做一些大数据环境的准备。前面我们提到hudi这么一个数据库框架，仅仅来管理数据。好，它从诞生之初就与我们Spark分析引擎呢紧密的进行整合。那我们可以通过Spark这个计算引擎提供的这种data source接口，我们把数据保存到hudi表中去，哎，我们也可以呢，使用Spark从hudi表中呢加载数据进行分析。</span><br><span class="line"></span><br><span class="line">不仅支持我们spark中的批处理和流计算，它还可以与我们的hive进行整合分析，那接下来呢，我们需要安装一些框架，那这个框架呢，我们可以看到，首先我们需要安装一个mysql数据库。原因在于我们要使用hive与hudi进行整合，那hive的呢？框架的原数据呢？它是存储在我们的MYSQL数据库当中的，紧接着我们安装这个hive这么一个储藏框架。啊，安装完以后，我们要去安装一个zookeeper，它是一个大数据当中的协作式框架，因为我们要写结构化流程序，从kafka消费数据，那我们kafka这个框架呢，它在管理数据的时候，按照消息队列管理的，它本身依赖于我们的什么呢？zookeeper</span><br><span class="line"></span><br><span class="line">那在这里面我们本次讲解hudi的一个使用，间接使用，与Spark集成我们的所有的软件，就在这张图上面，那当然hudi的数据同样还是存在HDFS文件系统。我们主要呢，还是使用我们的Spark sql的这种外部数据源，从hudi表读数据，往hudi表写数据，以及我们结构化流其实也是spark sql，对吧？那我们hive与hudi的整合其实就是两个表的关联，那也就是说hive表数据关联到我们hudi表存数据的一个HDFS目录，直接读取就可以了。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">安装MySQL 5.7</span><br><span class="line">安装Hive 2.1</span><br><span class="line">安装Zookeeper 3.4.6</span><br><span class="line">安装Kafka 2.4</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，那接下来呢，我们首先来去安装这些软件，那安装软件当中呢，那先呢，我们来安装一下mysql这么一个数据库，那在mysql的安装有很多种方式，我们可以在线。通过RPM安装也可以离线安装，那在这里呢，我们通过一个简单的方式，通过tar解压方式来安装，OK,好了，这里面有完整的步骤，我们按照步骤操作就行了，OK,那首先我们来看一下啊，我们来切换一下在这边。好，那我们首先呢，我们采用tar的方式安装mysql数据库</span><br></pre></td></tr></table></figure>

<h4 id="检查系统是否安装过mysql"><a href="#检查系统是否安装过mysql" class="headerlink" title="检查系统是否安装过mysql"></a>检查系统是否安装过mysql</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令在这首先我们检查我们这个系统有没有装过mysql数据库来执行一下rpm -qa|grep mysql。如果装过的话呢，我们首先要把它给卸载掉，然后再进行安装好，同学们看到这里是没有的，紧接着我们继续往下走。</span><br></pre></td></tr></table></figure>

<h4 id="卸载-Centos7-系统自带mariadb"><a href="#卸载-Centos7-系统自带mariadb" class="headerlink" title="卸载 Centos7 系统自带mariadb"></a>卸载 Centos7 系统自带mariadb</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，然后呢，我们卸载掉我们CentoS7呢自带的mariadb啊，这是跟mysql数据库类似的，好，那我们把它给卸载掉啊，我们卸载掉OK。好，那我们就是rpm -qa|grep mariadb的把这个mariadb给它卸载掉。</span><br></pre></td></tr></table></figure>

<h4 id="删除etc目录下的my-cnf-，一定要删掉，等下再重新建"><a href="#删除etc目录下的my-cnf-，一定要删掉，等下再重新建" class="headerlink" title="删除etc目录下的my.cnf ，一定要删掉，等下再重新建"></a>删除etc目录下的my.cnf ，一定要删掉，等下再重新建</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，卸载掉完以后，我们最好呢，把mysql数据库相关的一些配置文件给它删掉，那有一个配置文件呢，我们知道它是在我们讲的这个系统的/etc目录下面啊，往往有一个my.cnf这个配置文件一定要删掉啊，不然的话就会报错我们后面安装。</span><br></pre></td></tr></table></figure>

<h4 id="创建-mysql用户组和用户"><a href="#创建-mysql用户组和用户" class="headerlink" title="创建 mysql用户组和用户"></a>创建 mysql用户组和用户</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，紧接着我们安装mysql数据库呢？我们需要去干嘛呢？创建一个mysql这么一个用户组和用户，OK,那接下来我们来执行命令。好，这个比较简单，我们group添加，在系统添加一个组，名称就叫mysql，groupadd mysql。然后呢，我们添加一个用户useradd -r -g mysql mysql，指定MYC，这个用户的用户组叫mysql，然后呢用户名称叫mysql,这样的话呢，我们就创建好了</span><br></pre></td></tr></table></figure>

<h4 id="解压安装-mysql"><a href="#解压安装-mysql" class="headerlink" title="解压安装 mysql"></a>解压安装 mysql</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">紧接着呢，我们需要去下载mysql包，wget url，我给大家已经已经提前下载好了，我们直接呢进行上传就可以了。然后我们进行解压安装啊，tar进行解压就可以了，这种方式是最简单的方式，同学们啊，OK,那我们在企业的生产环境中呢，我们往往也采用这种方式，tar包安装非常的简单啊。避免我们什么在线啊下载等等的东西。好，解压完以后呢，我们来看一下这个目录是比较长的，是不是我们直接给它改掉，我们不需要那么长的名称。好，然后同学们可以看到这个包啊，它的一个用户名和用户组啊，它不属于我们什么呢？不属于我们root是不是啊，我们可以进行修改，可改成root也可以不修改啊好，那我们修改一下吧，chown -R root:root mysql/。</span><br></pre></td></tr></table></figure>

<h4 id="编译安装并初始化-mysql-务必记住数据库管理员临时密码"><a href="#编译安装并初始化-mysql-务必记住数据库管理员临时密码" class="headerlink" title="编译安装并初始化 mysql,务必记住数据库管理员临时密码"></a>编译安装并初始化 mysql,务必记住数据库管理员临时密码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，呃，那紧接着我们继续往下操作。然后呢，我们进入到这个mysql目录下面有一个什么呢？有个bin目录，同学们啊，里面呢，有很多脚本，其中有个mysqld。好，那我们运行这个脚本呢，我们进行初始化的操作，mysqld --initialize --user=mysql --datadir=/usr/local/mysql/data --basedir=/usr/local/mysql，在这啊后面加上这么一串啊，初始化设置，我们的初始用户mysql，我们的数据存储目录叫data，我们的基础目录叫mysql.好，同学们，我们来回车执行一下。啊，如果有问题，咱们再去修改啊。好啦，呃，这样的话呢，我们整个呢，就给大家去做完了啊。</span><br></pre></td></tr></table></figure>

<h4 id="编写配置文件-my-cnf-，并添加配置"><a href="#编写配置文件-my-cnf-，并添加配置" class="headerlink" title="编写配置文件 my.cnf ，并添加配置"></a>编写配置文件 my.cnf ，并添加配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">那做完以后，紧接着我们要去编辑一下啊，叫在我们叫做/etc/下面有个my.cnf文件mysql的配置文件啊，然后呢，我们进行加上以下配置。直接copy一下就可以了</span><br><span class="line"></span><br><span class="line">vi /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">datadir=/usr/1ocal/mysq1/dataport = 3306</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line">symbolic-links=0</span><br><span class="line">max_connections=400</span><br><span class="line">innodb_file_per_table=1 --这个在mysql课程讲过</span><br><span class="line">lower_case_table_names=1</span><br></pre></td></tr></table></figure>



<h4 id="启动mysql服务器"><a href="#启动mysql服务器" class="headerlink" title="启动mysql服务器"></a>启动mysql服务器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">接下来我们就可以启动我们的数据库了，启动数据库。呃，启动数据库呢，也是比较简单的，/mysql/support-files/mysql.server start，咱们来启动。可以看到啊，这里面有个什么success，那这里面如果启动包异常的话呢，这里面有个日志，我们可以稍微的去看一下这个文件。好，同学们看这里面没有报错，只是告诉我们这个密码叫什么3306是不是啊。</span><br></pre></td></tr></table></figure>

<h4 id="添加软连接，并重启-mysql-服务"><a href="#添加软连接，并重启-mysql-服务" class="headerlink" title="添加软连接，并重启 mysql 服务"></a>添加软连接，并重启 mysql 服务</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">启动完以后啊，我们要添加软链接，然后呢，再重启我们的服务，以后我们启动就不用麻烦了。ln -s /mysql/support-files/mysql.server /etc/init.d/mysql ln -s /mysql/bin/mysql /usr/bin/mysql，service mysql restart大家看这里面已经说我们重启成功了</span><br></pre></td></tr></table></figure>

<h4 id="修改初始密码"><a href="#修改初始密码" class="headerlink" title="修改初始密码"></a>修改初始密码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">重启成功以后。我们来登录mysql，mysql -uroot -p输入我们初始化的一个密码。那初始化密码在哪里呢？。密码就是我们初始化生成的临时密码，在哪呢？，在我们启动的时候，应该会告诉我们有一个初始化的密码。我们在进行初始化的时候，其实这里有个密码，同学们要注意啊。进来以后我们要去设置一下我们的密码叫 set password for root@localhost = password(&#x27;123456&#x27;)。好，这样的话呢，我们就设置好了</span><br></pre></td></tr></table></figure>

<h4 id="开放远程连接"><a href="#开放远程连接" class="headerlink" title="开放远程连接"></a>开放远程连接</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设置好以后我们来use mysql这个数据库，然后呢，我们要进行更新update user set user.Host = &#x27;%&#x27; where user.User = &#x27;root&#x27;.好，执行完以后我们进行flash刷新一下啊。哎，我们来刷新一下这个权限flush priviledges。</span><br></pre></td></tr></table></figure>

<h4 id="开机自启"><a href="#开机自启" class="headerlink" title="开机自启"></a>开机自启</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">做完以后，紧接着同学们，我们基本上就设置完成了，我们可以退出了。退出以后，我们来设置一个我们数据库随机启动啊，，随着我们这个开机进行启动，好这里面我们得稍微设置一下啊在这。cp /mysql/support-files/mysql.server /etc/init.d/mysqld</span><br><span class="line">chmod +x /etc/init.d/mysqld  --chmod +x=chmod a+x</span><br><span class="line">chkconfig --add mysqld</span><br><span class="line">chkconfig --list</span><br><span class="line"></span><br><span class="line">我们重新再来启动一下我们的服务，systemctl restart mysqld,好，我们看一下netstat -tnlp|grep mysqld，大家看是不是启动了。</span><br></pre></td></tr></table></figure>

<h4 id="客户端远程链接数据库"><a href="#客户端远程链接数据库" class="headerlink" title="客户端远程链接数据库"></a>客户端远程链接数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">那紧接着呢，我们来通过客户端链接一下，好，我们就使用我们这个idea来链接一下，那在这里面idea这里面有一个database数据库，咱们创建一个mysql链接。。。。好，那我们看一下这个驱动包。哎，我们就用它就可以啦，然后我们测试一下啊测试一下。我们看能不能连接到我们的数据库，没有问题的，对不对，apply连接。在数据库中我们看到的这个user用户这张表，刚才其实我们更新了它的权限啊，我们看一下来看我们是不是更新了root。呃，它的主机任意的主机OK，那这样的话呢，我们整个mysql数据库呢，我们就安装完成了，OK.</span><br></pre></td></tr></table></figure>

<h3 id="安装部署Hive"><a href="#安装部署Hive" class="headerlink" title="安装部署Hive"></a>安装部署Hive</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里我按照大数据开发工程师hive篇来的，注意在配置hive-site.xml时，那个ip是使用vmnet8的ip,不是我主机的ip</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171139810.png" alt="image-20240317113956861"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">那我们把马赛克数据库安装好了，接下来呢，我们来安装hive。那hive呢，我们都知道是大数据当中的数仓的这么一个工具框架啊，帮我们去管理数据的，按照分层的架构去管理。以及呢，我们可以使用呢hive呢来写语句，它默认的把sql转换成mapreduce来处理HDFS数据，在企业中呢，基本上我们都会用hive。啊，哪怕我们用hive来管理原数据，我们用Spark分析或者用flink分析好，那hive的安装呢，也是比较简单的，我们直接解压hive框架的tar包，配置HDFS依赖和原数据mysql数据库信息，最后呢，我们启动它的原数据hvie metastore和hiveServer2服务就可以了。</span><br><span class="line"></span><br><span class="line">那这里有张图是我们hive框架的一个核心点，那我们可以看到have这里有个metastore,原数据存储在关系数据库当中，往往我们选择mysql数据库，此外hive呢，它其实最主要它就是一个驱动，就是一个引擎。当不管是我们命令行，还是我们的hive的web界面，以及我们讲的通过jdbc，odbc方式链接Switch server，我们发送sql语句语言以后。我们这个hive中的driver会把sql进行解析。哎，然后呢，生成我们的计划，然后优化，最终呢进行执行，那执行的话呢，我们可以看到把我们的sql转换成mapreduce，然后处理HDFS数据，所以说在这里面我们啊，我们用hive来管理原数据，我们呢不需要启动yarn，因为我们生成的mapduce呢，运行在本地模式就可以了。</span><br></pre></td></tr></table></figure>

<h4 id="首先、解压tar包和设置环境变量"><a href="#首先、解压tar包和设置环境变量" class="headerlink" title="首先、解压tar包和设置环境变量"></a>首先、解压tar包和设置环境变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">好，HDFS,我们已经配置好了，mysql已经做好了，接下来我们来装hive。安装也是比较简单的，就是解压上传配置环境变量就可以了。好在这里呢，这个软件呢，我给大家提供了在这啊，那接下来呢，我们来上传进行操作一下。然后呢，我们给他一个执行权限chmod u+x hive.tar。解压完以后，我们呢，要给它重命名。并且呢，我们创建一个软链接，我们整个hive呢，就安装好了</span><br><span class="line"></span><br><span class="line">紧接着呢，我们来根据步骤往下看，我们进入到hive的conf目录下面去。然后呢，我们修改hive-env.sh配置文件进行修改。我们去修改hive-env.sh.template，好，在这里面我们来命名一下hive-env.sh，在这里面呢，我们需要添加一些东西啊，我们看一下这里面有些东西呢，其实我们可以把它全部给删掉啊。首先我们要设置一个hadoop的安装目录。这里面有个hive的配置文件目录HIVE_CONF_DIR=/hive/conf，OK,这个呢，我们要进行设置一下</span><br><span class="line"></span><br><span class="line">好做完以后，紧接着我们再往下看，最后一行呢，其实就是我们hive什么呢，它的一个jar包所在的路径啊，那这个呢，我们可以直接设置我们hive下面的什么lib目录就可以了啊同学们HIVE_AUX_JARS_PATH=/hive/lib。好，这样的话呢，我们整个环境变量里面的配置呢，我们基本上就完成了</span><br></pre></td></tr></table></figure>

<h4 id="其次、创建HDFS目录和配置Hive属性"><a href="#其次、创建HDFS目录和配置Hive属性" class="headerlink" title="其次、创建HDFS目录和配置Hive属性"></a>其次、创建HDFS目录和配置Hive属性</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">配置完以后，我们要先干嘛呢？启动我们HDFS的这个服务，好启动HDFS服务啊。namenode然后呢，我们再启动一下nodenode。好，启动完以后，我们稍等片刻，稍等片刻啊OK。我们等到安全模式结束以后，我们再去。启动啊，再去创建目录。那我们可以呢，通过50070，我们进行查看这个界面啊查看。我们可以看一下这个界面啊，目前还是安全模式，我们稍等几秒钟。创建这个目录</span><br><span class="line">hdfs dfs -mkdir -p /tmp</span><br><span class="line">hdfs dfs -mkdir -p /usr/hive/warehouse/</span><br><span class="line">hdfs dfs -chmod g+w /tmp</span><br><span class="line">hdfs dfs -chmod g+w /usr/hive/warehouse/</span><br></pre></td></tr></table></figure>

<h5 id="配置hive-site-xml属性"><a href="#配置hive-site-xml属性" class="headerlink" title="配置hive-site.xml属性"></a>配置hive-site.xml属性</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171144230.png" alt="image-20240317114437111"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171146762.png" alt="image-20240317114559111"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在这里面我们可以看到，这就是一个我们说了我们的这个mysql数据库所在的地址，这下面还有一些其他的东西啊，mysql驱动，以及我们root，用户名，密码，以及我们讲的存储目录，包括我们metastore的地址，以及我们讲的其他一些属性配置。</span><br></pre></td></tr></table></figure>

<h5 id="再者、添加用户权限hadoop"><a href="#再者、添加用户权限hadoop" class="headerlink" title="再者、添加用户权限hadoop"></a>再者、添加用户权限hadoop</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171200470.png" alt="image-20240317120010179"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好配置完成以后，紧接着我们再做一件事情，我们要去看一下我们的这个hadoop中啊core-site.xml，添加这种哎，权限配置，我们看有没有配置。</span><br></pre></td></tr></table></figure>

<h5 id="初始化数据库和启动MetaStore服务"><a href="#初始化数据库和启动MetaStore服务" class="headerlink" title="初始化数据库和启动MetaStore服务"></a>初始化数据库和启动MetaStore服务</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">好，配好以后，紧接着我们要进行初始化我们的数据库，同学们。那这时候呢，我们首先要把我们在我们的hive的内部目录下面放入mysql的驱动包mysql-connector-java-xxx.jar，这驱动包呢，在这我们直接放到hive的内部目录下就可以了。</span><br><span class="line"></span><br><span class="line">注意一下，我们要出始化数据库，我们进入到hive的bin目录，下面有一个schematool,我们来出始化数据库啊，schematool这个工具。schematool -dbType mysql -initSchema,好，接下来呢，我们来回车执行一下啊执行一下。</span><br><span class="line"></span><br><span class="line">整个过程呢，一开始可能有点慢啊，咱们不要去急，按照步骤来操作。我们看有没有多了一个metastore</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171216633.png" alt="image-20240317121611826"></p>
<h5 id="启动HiveServer2服务和beeline命令行"><a href="#启动HiveServer2服务和beeline命令行" class="headerlink" title="启动HiveServer2服务和beeline命令行"></a>启动HiveServer2服务和beeline命令行</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">做完以后，紧接着第7步，我们来启动我们的什么呢？hivemetastore服务。那我们可以直接启启动这个命令bin/hive --service metastore &gt;/dev/null &amp;(大数据开发工程师哪里没有这个启动metastore服务啊，只有初始化)，我们也可以写脚本啊，包括我们在启动hiveserver服务是一样的/bin/hive --service hiveserver2 &gt;/dev/null &amp;</span><br><span class="line"></span><br><span class="line">好，那这里呢，我给大家写好了脚本，这是我们have相关的三个脚本start-beeline.sh start-hiveserver2.sh start-metastore.sh，那我们可以把脚 本呢，放到我们hive的这个bin下去，然后呢，我们给他一个执行权限chmod u+x stat-*。好给它执行权限以后呢，然后我们看这个脚本啊同学们</span><br><span class="line"></span><br><span class="line">那在这里面呢，我们来配置一个hive的环境变量啊，我们用就是可以直接启动了啊</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171218531.png" alt="image-20240317121853440"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">我们再去启动我们的服务啊，就是哎，start-metastore.sh</span><br><span class="line"></span><br><span class="line">然后呢，我们要再去启动我们的start-hiveserver2.sh</span><br></pre></td></tr></table></figure>

<h5 id="使用beeline客户端连接"><a href="#使用beeline客户端连接" class="headerlink" title="使用beeline客户端连接"></a>使用beeline客户端连接</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">啊，当启动完成以后，我们去启动什么呢？beeline，我们来进行一个链接，我们来试一下看能不能连接成功bin/beeline -u jdbc:hive2://bigdata04:10000 -n root -p 123456，同学们啊。好了，这是我们稍微等一下。因为这是比较慢的啊,大家看已经链接上去了，那这时候我们来看一下我们这个hive呢，hive中呢是没有表的啊，是没有表的，那我们show databases，它只有一个什么呢？default。这数据库里面呢，也没有表好</span><br><span class="line"></span><br><span class="line">那为了后面的方便呢，我们在这个idea当中呢，我们已经我们也配置一个我们的hive，好吧，Hive的配置也简单(他这里使用idea默认的hive驱动jar失败了，然后使用了一个自己下载的，注意下)</span><br></pre></td></tr></table></figure>

<h3 id="安装部署Zookeeper"><a href="#安装部署Zookeeper" class="headerlink" title="安装部署Zookeeper"></a>安装部署Zookeeper</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">接下来呢，我们来安装另外一个就是keep。那鲁keep这个框架呢，我们后面卡夫卡需要依赖，包括我们后面讲我们的护地与冯定的集成，我们进行实时的数据入库的时候都要用到卡夫卡，那卡夫卡呢，又依赖于我们组keep协作框架，组keep的安装呢非常简单。我们说keep是阿尔法奇顶级项目啊，它是为分布式的应用呢，提供高效高可用的分布式的这种协调服务，我们很多很多的框架都依赖于它，比如说HDFS的高可用，我们resource manage的高可用，H数据库卡不卡等等等等都依赖于它。那如K呢，要求我们的集群呢，是基数的，在整个集群决算当中呢，有need和follow need主要是用于对外进行什么呢？提供这种服务的，写数据的那。Follow呢，可以进行读数据的，我们所有的follow都跟need来进行同步，好了，接下来呢，我们来进行安装一下，我们是单机版的，安装也是很简单，我们首先进入到我们安装目录下面去，然后呢我们进行安装就可以了。好，然后呢，这里面呢，我先退出，同学们我们先退出。好，然后呢，我们先看到我们的export上下面去，然后呢，我们去上传我们这个软件包。软件包呢，这里面我们给大家已经放好了，放在这下面叫做keep。好，我们直接给他上传就可以了。上传完以后，我们直接呢进行挤压，同学们首先呢，给他一个执行权限啊。好，然后呢，我们解压一下吧，他包解压一下theper。解压完成以后，同学们，我们可以看到我们来创建软件机，这个用户有点不对，我们稍微变一下啊。OK,我们把它改成root好吧。好，然后呢，我们创建一个软件接啊，创建这么一个软件接。音节的话呢，N读keeper，我们就叫读keeper。好，并且我们删除这个软件包，把软件删掉没什么用，对吧？好，这样的话呢，我们整个就装好了，同学们我们可以看一下，此时我们已经把如keep给它解压完成了。解压完成以后，我们要进行简单的配置，进入到组keep的客服目录下面，我们进行配置，配置的数据的一个存储目录，OK.好，进入到目录下面去，同学们。接入以后，我们进入到看膜的下面，那这里面有个入杠Z。Sample这个配置文件改个名称，同学们啊，CFG改完以后我们来进行写一下，在这里面呢，我们把这个数据的存储目录呢，我们稍微改一下啊，不用这个目录，我们改成一个我们的目录。在这里面比较简单一点好，我们到export serve keep群，我们创建一个目录，我们叫做data目录，然后我们进拷贝一下这个目录export。S keepa data字目录，那我们数据放这里面，这样的话呢，我们整个就配置完成了。配置完成以后，同学们我们来再做一个事情，我们来配置环境变量，方便呢我们进行使用。好，在这里面我们看一下环境变量呢，在这OK，同学们啊，我们来看一下。那。回撤一下，我们在最后的话去添加，就是我们讲的look keepper home,对吧，还有我们X hot,哎，Z look z.Z go home对吧？配置一个这么一个home。好，紧接着呢，我们往下看。这是我们所讲的。好，那我们保存一下，同学们保存下来。保存完以后呢，这样的话呢，我们就配置好了，OK,我们就可以启动我们的服务了，在这里我们再做一个稍微的配置。啊，做个什么配置呢？同学们我们看一下exportva keep,在zoo keep这个B音目录下，同学们有一个脚本，我们稍微修改一下，这个脚本叫vim z k EV这个DSH脚本在这个脚本当中啊，我们去设置一个路径啊设置个什么路径呢？就是我们启动组keep的时候，它的日志的一个目录，这个目录如果你不设置的话，你在哪启动就在哪目录下面，这是不好的啊。好，我们把它设置一个值。设置什么值呢？同学们看一下就设置我们在做keep下面。啊，再组Q项你就可以了。好在组题下面，好在这里面呢，我们可以起创建一个目录啊，创建目录OK，在这我们退出make DR-P杠什么呢？Locks好P没底。好，同学们，这样的话呢，我们启动组keep在任何启动它的这个日志上都在log字母上去，好，那这样的话我们SRC，然后呢，我们来启动组keep就可以了啊，Profile使得生效。我们来启动，启动比较简单，哎，我们可以直接打，哎，就是z can什么start。好，启动完以后呢，我们再打一个四四同学们这是不是单的，那我们单机版配置的OK，那这样的话呢，我们整个组K版呢，就给它启动好了。</span><br></pre></td></tr></table></figure>



<h3 id="安装部署Kafka"><a href="#安装部署Kafka" class="headerlink" title="安装部署Kafka"></a>安装部署Kafka</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">哎，那5K版安装好以后呢，我们来安装我们的这个分布式消息对联卡夫卡，我们用的是2.4版本。那我们知道卡夫卡最初呢，由拟音公司开发的，它是一个分布式的，分区的，多副本的，多订阅的一个。消息系统。但是它依赖于一种keep，那最新的版本当中它是不依赖于的啊，那卡不卡呢？常常用于于用于我们网站的web和INS服务器日志的一个缓存存储。它早已是阿帕奇顶级项目了，我们只要做牛市的实时计算，基本上我们都会用到组K，卡不卡，卡卡呢依赖于我们讲的组keep集群，OK,它这里面的数据呢，是放在一个topic当中的，Topic划分成很多分区，每个分区呢有多个副本。好，接下来呢，我们来安装一下卡不卡也是比较简单的啊，那这里呢，我们的软件呢，也给大家呢准备好了，在我们这一个目录下面，大家可以看到这里面有一个叫做卡夫卡2.4的版本，基于盖2.12版本的。好，接下来呢，我们来安装一下同学们，那首先呢，我们进入到EXPORT4部下面去，然后呢，我们来上传同学们。上传完以后，我们来进行解压啊，进行解压。OK,那首先我们change mode啊change mode的话呢，我们给他一个权限。然后呢，我们踏包进行解压，踏包解压。好，解压完成以后，我们呢，看一下这个目录OK啊看垂线。好像是没有什么问题的，对不对，卡不卡，那在这里面呢，我们创建一个软件接啊卡不卡，那我们就要卡不卡对吧，删除我们这个卡夫卡的什么呢？卡包。淘啊淘宝好筛，然后呢，我们进入到卡夫卡的这个。目录配置目录叫con目录，同学们我们看一下con目录啊，那在con目录下面呢，我们可以看到它有些配置，我们来进行修改。好，同学们，我们来看一下配置在哪里呢？好，我们看一下。在这里面修改内容呢，比较简单。那首先其实就是一个监听地址，一个就是我们的卡夫卡的数据存储地址，一个依赖一种keep的地址，好，我们只修改这3个地方就可以了。好，我们修改一下VM不好，我们看多少行，同学们往下走，那这个第一个这是broke ID,我们不用改，这个我们稍微改一下，同学们啊，稍微改一下。然后呢，这里面我们写上这个地址就可以了啊，我们这是node e it cost.c好再往下走。下面这个呢，我们也不用改什么东西啊，不用改。好之后注意这个路径我们得改一下，同学们。这是我们存储的数据的一个路径啊。好，这是我们讲卡夫卡的一个消息队列，对不对，我们创建这目录，好，我们到卡夫卡中去，同学们啊，然后呢，我们麦D到T创建这么一个路径。嗯。同学们，我们写错了，我们不应该写，写个杠，把杠给去掉，好进入到卡夫卡的客服下面下去，我们。PWD查看我们的这个卡夫卡的最终消息存储的这个。磁盘的一个位置。好，这样配完以后我们继续往下走，一直走到最后，同学们。我们要做最后干嘛呢？我们要去做一些事情，就是我们依赖的keep的一个地址，Keep地址啊，以及我们在keep上node的位置，阿卡点C。好，那我们一对1就什么呢？就叫做卡卡。看不看啊，那这样的话呢，我们整个配置呢，就完成了，同学们。诶。A少了一个A对吧，少了一个L不能写错啊。好，我们保存下来。保存完以后，我们要设置一下环境变量，同学们。那卡va的环境变量呢，设置起来也是比较简单的，同学们啊，我们看一下m ETC profile.好，我们看一下profile。好，我们在下面来设置一下来，我们说卡不卡的一个home export卡不卡home等于。OK,我们的安装目录。好在这里面呢，我们copy一下，就是我们讲的卡不卡啊。好，配置完成以后，我们来进行source一下，使得我们配置生效投入发扬好，然后呢，我们接下来呢，我们就可以去启动我们这个服务了啊。那服务启动也是比较简单的，同学们我们看一下那卡不卡，然后呢，我们说server start,哎，我们放在后台启动，是不是后台启动，然后呢，我们就指定一下export star卡卡con下面的什么呢？Star practice.然后启动，然后我们打个勾，同学们看一下勾。那个S这里面我们可以看到卡夫卡这个节点，那在这里给大家介绍个工具，一个叫什么呢？卡夫卡two的工具。这个工具呢，很好用，去链接我们的卡夫卡啊。好，同学们，我们来看一下，在这里面我们可以给它创建一个，创建一个新的链接。好，这个名称呢，我们叫忽底杠卡夫卡对吧。而在这里面，我们卡卡的版本是2.4OK，是在我们NOE1这台机器上面的啊，这个地址其实是我们keep的地址，后面有个卡普卡对吧。来，我们添加测试一下。同学们，我们看一下啊。那这样的话呢，我们创建topic，查看topic数据呢，就比较方便了啊，我们直接在这个工具已经链接成功了，同学们我们双击一下。好，那目前呢，是没有topic的，对不对，什么都没有的，只有一台机器。OK,那这样的话呢，此时我们卡夫卡去安装完成呢，安装完成以后，我们就可以往卡夫卡消息对面写数据了，我们也从可以从卡夫卡怎么样呢消费数据进行处理了。OK,那此时呢，我们整个大数据的这个环境就给他准备好了，那后面呢，我们就要开展讲，以从应用的角度，实战的角度来讲，我们。Whodi与Spark整合的一个使用啊，我们批量的把数据加载到互Di表中去，批量从互利表中读数据，以及我们与have与互Di表集成来分析互理表数据，包括我们结构化流实时统卡卡消费数据，并且把数据写到互理表，以及我们进行一个查询分析。OK.</span><br></pre></td></tr></table></figure>



<h2 id="滴滴运营分析"><a href="#滴滴运营分析" class="headerlink" title="滴滴运营分析"></a>滴滴运营分析</h2><h3 id="集成Hive查询"><a href="#集成Hive查询" class="headerlink" title="集成Hive查询"></a>集成Hive查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">前面呢，我们讲到了，直接从hudi表里面呢加载数据，然后进行指标分析，接下来呢，我们稍微的变换一下，我们说了，当我们把数据存到hudi表以后，我们还可以与我们的hive进行集成来做分析。好，接下来我们看一下，我们就把我们前面刚才讲的这个滴滴的出行的这个数据在hudi表中的，对不对，分区存储，我们给它呢，映射到我们hive表中。哎，我们从hive表中呢来编写sql进行查询，哎，这也是可以的，好，接下来呢，我们来进行看一下怎么去完成，那这时候呢，我们就要涉及到hive与我们hudi表的集成，那这时候呢，我们需要使用到一个jar包，在我们前面编译完hudi的这个。安装目录下面其实有个hudi和hudi-hadoop-mr-bundle-xxx.jar的这么一个jar包，我们直接把这个jar包呢放到我们hive的lib目录下就可以了，那我们拷贝依赖包到hive的路径下面，为了我们hive能够正常的读取到这个数据。啊，那拷贝完以后，同学们不要急着去操作，我们要把我们的hive的服务给它重启一下。那这样的话呢，我们整个呃，集成就配置好了啊，就是一个架包对吧，没有其他东西。</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/ttyong/hexoBlog/master/%E5%B0%9A%E7%A1%85%E8%B0%B7%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%B9%96Hudi/202403171623657.png" alt="image-20240317162315168"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好配置完以后呢，紧接着呢，我们就需要呢，在have的命令行呢，我们要创建表了。把我们讲的滴滴出行的这个表呢，映射到have表中去啊，在这里面呢，我们创建have表呢，是属于一个外部表。它基本的语句是这样，大家看创建一个表是不是correct table,创建一个数据库叫DB，然后呢，我们使用数据库在这里面创建一个表，这是一个exterunnal，一个外部表，然后呢，这里面是字段，那在这里面我们要注意一下啊，我们在这里存储的时候呢，要加一个分区。好，我们呢，刚才在存储数据，我们分区其实只有一列，就日期分区，对不对，我们就写一个一个分区，那在这里面我们要指定一个什么东西呢？同学们看，就是我们数据的存储格式叫stored are the input format,注意它是who pack input format.我们时代存储在互利表中，并且是pack列式存储，最后呢，我们得指定location，其实就是我们数据的存储的一个路径就可以了，啊，这比较简单的好，那接下来呢，我们切过来。呃，这边呢，同学们，我们昨天呢，在讲这个idea的时候呢，其实我们已经配置了我们的这个have对吧，Have同学们看在这。好了，我们双击链接一下啊，让让他去呢，链接一下。知道吧，我们去链接一下OK。好，我们看一下吧。好，同学们，我们来选择所有的。OK,我们来链接一下啊，链接一下我们have。嗯。穿的面看链接完成以后呢，我们在这里编写我们的语句啊，编写我们的语句。好，比较慢，稍等片刻。这应该是可以链接的啊，我们看一下。GPS.好，应该是没有问题的。呃。我们看一下好了没有。因为我们have，昨天安装好以后呢，我们没有去写数据对不对。链接。好，成功以后呢，同学们，我们在这里面打开一个。终端打开一个终端啊，打开终端。好，打开终端以后呢，同学们我们来看一下，在这里面我们可以去写一下，我们在这里写写我们的数据。好，这个呢，我先把它。在这里面，那首先我们刚才讲的第一步，我们来创建一个数据库database，好同学们我们看一下啊，Create,我们说database对吧，If如果不存在的话，我们创建，而这数据库呢，我们叫做湖底可不可以啊。好，第二步呢，我们来使用这个数据库，对吧，使用啊，使用这个数据库，那叫什么use。右侧的话DB互利对吧。好，我把这个呢给大家执行一下来，我们看一下走。好，这边我们来看一下这个数据库。好，大家看是不是多了一个，然后呢，我们来使用这个数据库使用啊。好。使用咱们这个数据库。这个。使用对吧，使用结束了啊。那接下来第三步，同学们，我们都知道创建表是不是好，我们看一下啊，创建我们的表，创建我们的表，那我们说过了，Create创建的是一个什么表呢？外部表。Table是不是if not不存在，我们的创建是不是？好，这个表呢，我们叫table杠什么呢？忽底杠DD可不可以啊，那这里面是不是咱们字段名称啊。好，那这字段名称的同学们，我们呢直接呢给大家copy一下啊，这字段比较多啊，我们写的也比较慢。杭州自然名称，OK?好同学们，这个呢是非常简单的，就是我们这个表里面有多少字呢，我们就写多少字呢。给同学们贴上去，我给它贴过来，好，我们调整一下格式。调整格式啊。好，类型要对上同学们啊，对上，那第一个就是我们讲的订单ID，然后产品ID等等，那这是我们讲的分区路径，以及这这些字段，好紧接着呢，同学们注意，这里面我们需要加上一个什么呢？叫partition的BY。好，这里面我们说这个类型，我们得加上一下。那在这里面我们其实就是一个日期STR。它的类型我们叫什么呢？叫子串。对不对，周长好，那接下来呢，有几个大家注意一下，同学们，就是我们讲的这个文件的这种格式。啊，注意这是固定的，我直接贴过来啊，在这第一个我们的room format,我们的这种存储，其实我们说我们说这个是一个什么，是一个pack劣势存储对不对，那input me我们是存储在什么呢？忽底表当中的，对吧。那我们的输出格式也是pack好，这是我们的数据的存储路径，要注意就是存储路径我们是在大家看好了，在who d we are house下面，Table滴滴海口下面是不是好，这样的话整个表就创建好了，那咱们这是一个分区表，同学们注意。好，我们执行一下这一下啊，执行完以后呢，我们打开看看这个分区表创建好了。那既然是分区表的话，同学们都知道，我们看一下，我们可以是查看。啊，查看分区表的这个分区，分区表的这种分区。啊分区，那我们说这里面有一个命令叫修。帕选4是不是这种表的名称啊，好，那咱们这个表的名称呢，叫DBWHO底点。是不是我们的我们的table啊，OK,搞定。好了，我们看有没有分区啊，现在是没有分区的，对不对。好，同学们现在是没有的是吧，那但是同学们来看一下我们这个数据，我们看一下啊，我们是有的，有多少个20个分区。那咱们是不是要手动添加分区啊好，那紧接着呢，我们做一件事，就是我们讲的，哎，手动的我们要去添加这个什么呢？分区信息。添加分区信息，好，同学们，那添加分区呢，这个命令大家会去写啊，我们来写一下叫al。什么呢？Terrible是不是？好，我们说DB whodi.table who底是不是，然后and。啊，If not,如果不存在的话，我们添加分区。好同学们，这个呢，就是我们讲的叫，哎，我们讲的这个字段值，好这个字段值呢，我们要注意一下，那这里面的值值我们知道这是从5月份开始，对不对。5暂开始。好，那咱们就一直往下添加。啊，把它添加完成，并且在后面我们要去指定一个字段叫什么呢？Location是不是我们的数据的位置啊location。好，数据位置呢，我们指定一下同学们，这是我们讲完整的，那整个数据的位置我们看一下是在这个目录下面，同学们注意啊。设置中控下面叫什么呢？这个路径下面的数据对吧。整顿下面，诶在后面同学们啊。在这里面我们稍微看一下，你看点进去嘛，这是不是个路径啊，整个路径，整个路径啊。好，这样的话呢，我们需要去添加20个这么一个东西，好，那我们一个写。三四五六七八九十一二三四五六七八。钱不多。好，我们说从多少方呢？从二十三，二十二号，23242526，二七二八二九三十三十一。好，这是23。这是二十四，二十五，二十六，二十七，二十八。29。然后是不是30啊，30以及什么三十一没问题。好，那我们再看，那第二个呢，其实就是我们6月份的，6月份从从几号开始。从1号开始，一直到10号。注意同学们，这前面没有0啊，没有零啊，这个6对吧，2017年6月1号对吧，6月1号啊，6月1号。好，咱们写下一二号，3号4号，5号，6号，7号，8号，9号10号。好，我们写一下2号3号4号5号6号7号8号9号10号对吧。好，最后一个呢，重复掉了，在这里大家千万不要忘记了，我们后面这路径也得改是不是对吧，二十三二十四。25。26。对吧，二十七二十八二十九三十。好，有人说了，老师啊，这有没有工具呢？有工具啊，那在这里面我们就采用最简单的方式来做好吧，那这其实就是我们讲6。这样我一一嗦一说把它改掉啊。然后呢，这是我们讲什么呢。OK.嗯。1。这说明234567。8。举同学们啊。最后是咱们讲什么呢，10。那10的话呢，这是6月份6月10号，那这样的话呢，我们整个10个分区呢，我们给它手动添加上去。好，同学们，我们来执行一下10个分区。好，给他执行。OK.总共有20个分区，对不对。5月份10个，我们6月份10个。好，整个呢，执行完成以后呢，同学们我们再修一下，看一下多少个分区。大概分区是不是有了。好，有了以后，紧接着咱们别忙着进行分析，进行分析，咱们首先来进行查询一下数据。好，咱们测试。好，我们进行测试，我们来查询数据啊，测试我们查询我们的数据，好，同学们，我们来看一下select，然后呢，From DB护理，OK.好，这里面这个数据呢，我们不要查那么多，我们首先查一个订单的ID。订单ID啊，然后呢，我们查一下叫做我们说这有个叫产品的ID，是不是产品ID啊，OK,我们说有一个类型有一个。预支的一个费用，是不是还有一个我们叫做交通的类型是吧，还有一个我们叫做距离叫distance。Distance.啊，就是距离。好，那今天呢，我们来查询一下这个数据，我们不需要太多，我们查询啊，20条就可以了，同学们。好，那在这里呢，我们把这条语句选起来，我们来执行一下，看结果，同学们啊。好了，呃，同学们，我们可以看到啊，这里面讲到了一点啊，我说我们说我们当前的模式，什么模式啊，严格模式OK，好严格模式我们不加分区呢，它会出错的，好所以我们先设置一下吧。我给他报了一个错，就是严格模式。好，我们设置为什么呢呢。A strict就可以了。好，我先设置。好，然后呢，我们再去执行。好，再去执行的话，大家可以看到数据是不是查出来了，查出来了这是我们用这个工具非常好用，大家可以看到啊。这是我们完整的一个结果，同学们可以看到吧？好了，这是我们所讲的，那接下来呢，我们就可以在这上面我们写思考来进行什么啊，进行我们的这种指标的这种统计分析了。OK.好，这是我们讲的have与互利表的一个集成，首先就是创建表，创建表的时候要注意啊，因为我们是分区目录，指定分析字段，以及我们下面这几个属性，我们就是统一的，这样去配置就可以了，最后呢，我们手动的添加这个分区，OK,那刚才说过了，我们一定要去设置一些非严格模式，然后再去查数据，看一下结果。OK,那集成完成以后呢，那咱们呢，就可以继续来去写我们的代码了，来做我们的这种分析报告了，啊，做我们的分</span><br></pre></td></tr></table></figure>



<h2 id="结构化流写入Hudi"><a href="#结构化流写入Hudi" class="headerlink" title="结构化流写入Hudi"></a>结构化流写入Hudi</h2><h2 id="集成-SparkSQL–快速体验数据CRUD"><a href="#集成-SparkSQL–快速体验数据CRUD" class="headerlink" title="集成 SparkSQL–快速体验数据CRUD"></a>集成 SparkSQL–快速体验数据CRUD</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ppt 100页</span><br></pre></td></tr></table></figure>

<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">接下来呢，我们看另外一个知识点啊，也跟我们Spark相关，跟我们护底的这种集成，是在hudi的最新版本0.9版本当中呢，提供的与我们Spark sql集成，说白了就是我们可以在Spark提供的Spark sql交互式命令行呢，我们直接可以写这种sql语句来关联我们hudi表的数据，来对hudi表进行增删改查操作。</span><br><span class="line"></span><br><span class="line">在hudi与spark集成当中呢，我们可以创建表，创建表呢，我可以创建成管理表，外部表，分区表，可以通过子查询来创建表，我们可以写inset语句，直接插入语句，插入数据，我们可以写select语句，直接什么呢？查询数据，当然我们还可以进行更新数据和删除数据，更新数据当中我们可以用mergeinto和update两种方式来做。好，那接下来呢，我们来看一下这个怎么hudi与spark呢，来集成，我们讲的是sql命</span><br><span class="line"></span><br><span class="line">第一件事情我们来启动。我们相关服务启动我们spark sql命令行。好，启动的话呢，我们首先看一下，首先呢，老师常谈的问题，我们说互hudi的数据呢，我们是存在HDFS文件系统上面的，所以首先我们要去启动我们的datanode的和呢namenode的服务啊，这服务其实咱们已经启动过了。</span><br><span class="line"></span><br><span class="line">紧接着我们再往下看，我们要启动Spark-sql交互命令啊，我们要设置依赖架包和相关属性，在这里同学们要注意一下我们spark-sql运行在本地模式，然后呢，我们还是把3个依赖包给它放上去，以及我们讲的序列化。那在这里面我们要添加一个东西，同学们注意了注意了啊，添加个什么呢？Spark sql的扩展，写这么一个属性啊，hoodieSparksession，也就是说我们创建出命令行以后，我们创建Spark对象是个hudi集成的</span><br></pre></td></tr></table></figure>

<h3 id="设置参数"><a href="#设置参数" class="headerlink" title="设置参数"></a>设置参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这样的话呢，就启动我们一个Spark sql的这么一个交互式命令了。在这里面我们来进行一个操作啊。OK.好，稍等片刻啊，稍等。好，启动完以后呢，我们可以打个show databases，默认情况下，其实我们这个数据库啊，它只有一个default数据库，对不对，没有其他数据库。好，启动完以后。紧接着在这里面我们得设置几个属性，因为我们对互利操作的时候，在spark命令行你是插入数据，更新数据，删除数据的，默认它的这个并行度啊为1500，太大了，我们把这数据呢给它设置小一点，同学们设置为几呢？设置为1。好三个呢，设置完以后，一个是upsert，一个是insert,一个delete，设置完以后，紧接着呢，我们要设置一下同步不同步我们hudi表的原数据啊，是不同步的啊</span><br></pre></td></tr></table></figure>

<h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这4个属性设置完以后，我们就准备好了，接下来呢，我们就可以去使用了。好，接下来我们看一下怎么去用啊，这个也是比较简单的。好，那紧接着呢，我们往下走，那首先呢，我们来创建这么一张表啊，我们编写一个DDL语句。那我们创建一张表呢，关联到我们hudi表中去</span><br><span class="line"></span><br><span class="line">同学们我们来看一下。啊好，同学们这时候呢，这个表已经创建完成了。好，创建完表以后，我们接下来往表里面写数据，那写数据的话呢，创建完以后我们可以显示一下这个表show create table test_hudi_table。我大家看，这个表里面增加了我们讲的5个字段，是不是好，这个我们不管，紧接着我们往这个表里面怎么样呢？写数据，往表里面写数据我们使用什么语句呢？insert into test_hudi_table select,我们把数据呢写到hudi表中去，那这个就比较简单了。我们叫insert into</span><br></pre></td></tr></table></figure>

<h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">好，我们一次性多插几条数据进去。好，我们给他执行。大家稍等片刻。啊，这个比较慢，我们先不管它，其实我们这个表中有几条数据了，有4条数据。好，同学们紧接着往下看，接下来呢，我们来从这个表里查数据，我们select * from。这就是我们所讲的，这是用spark  sql来进行操作我们数据的。那此时我们可以看一下我们这个表的这个结构desc</span><br><span class="line"></span><br><span class="line">好，那这种方式呢，就非常非常的极大的简便了，让我们直接写写词，口语句。好，那我们也可以指定字段来进行查询，我们查询一些数据，同学们，我们来指定字段啊，我们查询一下。OK,我们直接copy一下就可以了，同学们来看一下。好在这叫select select看一下C。回撤，那这样的话，我们看到我们只查这么几个字段啊，只查这么几个字段。</span><br></pre></td></tr></table></figure>

<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当数据查询完以后呢？我们还可以干什么呢？我们还可以进行更新数据，同学们，更新数据，更新数据就是我们讲的标准的这种语句Update。比如说我们更新一个表，Update test_hudi_table set price = 100.0 where id=1,这就是更新语句啊</span><br></pre></td></tr></table></figure>

<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">好，当然我们这里面还可以怎么样呢。我们还可以删除数据，那就是delete from test_hudi_table where id=1，我们再去查一这条数据，我们看能不能查到，同学们看一下。有没有数据啊，没有数据已经查不到了，因为这条数据是不是被我们删除掉了，OK,被我们删掉了，好，这是我们讲的这个hudi跟我们支持spark sql写这种DDL要语句和我们讲的插入更新删除查询的语句，非常的方便。好，这个功能呢，我们要知道一下有这功能OK。</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">智汇君</div><div class="post-copyright__author_desc">路漫漫其修远兮，吾将上下而求索！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20spark%E9%9B%86%E6%88%90%201/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/01/17/2022黑马数据湖架构开发Hudi-应用进阶篇 spark集成 1/')">2022黑马数据湖架构开发Hudi-应用进阶篇 1</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E5%BE%AE%E4%BF%A1%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%B6%E6%AC%BE%E7%A0%81.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20spark%E9%9B%86%E6%88%90%201/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Tech智汇站</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>大数据<span class="tagsPageCount">26</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/01/17/git/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">git</div></div></a></div><div class="next-post pull-right"><a href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20flink%E9%9B%86%E6%88%90%201/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E7%AF%87%201/" title="2022黑马数据湖架构开发Hudi"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">2022黑马数据湖架构开发Hudi</div></div></a></div><div><a href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20flink%E9%9B%86%E6%88%90%201/" title="2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1</div></div></a></div><div><a href="/2025/01/17/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91%E4%B8%8E%E5%BA%94%E7%94%A8%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E3%80%81%E5%87%BD%E6%95%B0%E5%92%8C%E5%8C%85%2017/" title="oracle数据库开发与应用 存储过程、函数和包 17"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">oracle数据库开发与应用 存储过程、函数和包 17</div></div></a></div><div><a href="/2025/01/17/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91%E4%B8%8E%E5%BA%94%E7%94%A8%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%2016/" title="oracle数据库开发与应用 数据库编程 16"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">oracle数据库开发与应用 数据库编程 16</div></div></a></div><div><a href="/2025/01/17/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91%E4%B8%8E%E5%BA%94%E7%94%A8%20%E6%B8%B8%E6%A0%87%E5%92%8C%E5%BC%82%E5%B8%B8%2019/" title="oracle数据库开发与应用 游标和异常 19"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">oracle数据库开发与应用 游标和异常 19</div></div></a></div><div><a href="/2025/01/17/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91%E4%B8%8E%E5%BA%94%E7%94%A8%20%E8%A7%A6%E5%8F%91%E5%99%A8%2018/" title="oracle数据库开发与应用 触发器 18"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-17</div><div class="title">oracle数据库开发与应用 触发器 18</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">智汇君</h1><div class="author-info__desc">路漫漫其修远兮，吾将上下而求索！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="/contact/" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(/img/博客微信公众号图片.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87-1"><span class="toc-number">1.</span> <span class="toc-text">2022黑马数据湖架构开发Hudi-应用进阶篇 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%E4%B9%8B%E9%9B%86%E6%88%90Spark%E2%80%93%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%E5%A4%A7%E7%BA%B2%E5%92%8C%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="toc-number">1.1.</span> <span class="toc-text">Hudi 应用进阶篇之集成Spark–课程内容大纲和学习目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">1.2.</span> <span class="toc-text">大数据环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BFtar%E5%AE%89%E8%A3%85MySQL-5-7"><span class="toc-number">1.2.1.</span> <span class="toc-text">离线tar安装MySQL 5.7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%B3%BB%E7%BB%9F%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E8%BF%87mysql"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">检查系统是否安装过mysql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD-Centos7-%E7%B3%BB%E7%BB%9F%E8%87%AA%E5%B8%A6mariadb"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">卸载 Centos7 系统自带mariadb</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4etc%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84my-cnf-%EF%BC%8C%E4%B8%80%E5%AE%9A%E8%A6%81%E5%88%A0%E6%8E%89%EF%BC%8C%E7%AD%89%E4%B8%8B%E5%86%8D%E9%87%8D%E6%96%B0%E5%BB%BA"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">删除etc目录下的my.cnf ，一定要删掉，等下再重新建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-mysql%E7%94%A8%E6%88%B7%E7%BB%84%E5%92%8C%E7%94%A8%E6%88%B7"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">创建 mysql用户组和用户</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B%E5%AE%89%E8%A3%85-mysql"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">解压安装 mysql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96-mysql-%E5%8A%A1%E5%BF%85%E8%AE%B0%E4%BD%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98%E4%B8%B4%E6%97%B6%E5%AF%86%E7%A0%81"><span class="toc-number">1.2.1.6.</span> <span class="toc-text">编译安装并初始化 mysql,务必记住数据库管理员临时密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-my-cnf-%EF%BC%8C%E5%B9%B6%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.7.</span> <span class="toc-text">编写配置文件 my.cnf ，并添加配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8mysql%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.2.1.8.</span> <span class="toc-text">启动mysql服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%BD%AF%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%B9%B6%E9%87%8D%E5%90%AF-mysql-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.1.9.</span> <span class="toc-text">添加软连接，并重启 mysql 服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%88%9D%E5%A7%8B%E5%AF%86%E7%A0%81"><span class="toc-number">1.2.1.10.</span> <span class="toc-text">修改初始密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.1.11.</span> <span class="toc-text">开放远程连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="toc-number">1.2.1.12.</span> <span class="toc-text">开机自启</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E9%93%BE%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.2.1.13.</span> <span class="toc-text">客户端远程链接数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2Hive"><span class="toc-number">1.2.2.</span> <span class="toc-text">安装部署Hive</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E3%80%81%E8%A7%A3%E5%8E%8Btar%E5%8C%85%E5%92%8C%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">首先、解压tar包和设置环境变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E6%AC%A1%E3%80%81%E5%88%9B%E5%BB%BAHDFS%E7%9B%AE%E5%BD%95%E5%92%8C%E9%85%8D%E7%BD%AEHive%E5%B1%9E%E6%80%A7"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">其次、创建HDFS目录和配置Hive属性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEhive-site-xml%E5%B1%9E%E6%80%A7"><span class="toc-number">1.2.2.2.1.</span> <span class="toc-text">配置hive-site.xml属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%8D%E8%80%85%E3%80%81%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90hadoop"><span class="toc-number">1.2.2.2.2.</span> <span class="toc-text">再者、添加用户权限hadoop</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E5%90%AF%E5%8A%A8MetaStore%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.2.2.3.</span> <span class="toc-text">初始化数据库和启动MetaStore服务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8HiveServer2%E6%9C%8D%E5%8A%A1%E5%92%8Cbeeline%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">1.2.2.2.4.</span> <span class="toc-text">启动HiveServer2服务和beeline命令行</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8beeline%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.2.2.5.</span> <span class="toc-text">使用beeline客户端连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2Zookeeper"><span class="toc-number">1.2.3.</span> <span class="toc-text">安装部署Zookeeper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2Kafka"><span class="toc-number">1.2.4.</span> <span class="toc-text">安装部署Kafka</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%B4%E6%BB%B4%E8%BF%90%E8%90%A5%E5%88%86%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">滴滴运营分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E6%88%90Hive%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">集成Hive查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E6%B5%81%E5%86%99%E5%85%A5Hudi"><span class="toc-number">1.4.</span> <span class="toc-text">结构化流写入Hudi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E6%88%90-SparkSQL%E2%80%93%E5%BF%AB%E9%80%9F%E4%BD%93%E9%AA%8C%E6%95%B0%E6%8D%AECRUD"><span class="toc-number">1.5.</span> <span class="toc-text">集成 SparkSQL–快速体验数据CRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.1.</span> <span class="toc-text">启动服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.5.2.</span> <span class="toc-text">设置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">1.5.3.</span> <span class="toc-text">创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.4.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0"><span class="toc-number">1.5.5.</span> <span class="toc-text">更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">1.5.6.</span> <span class="toc-text">删除</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/14/%E5%BB%96%E9%9B%AA%E5%B3%B0PythonJava%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0/" title="无题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2025/05/14/%E5%BB%96%E9%9B%AA%E5%B3%B0PythonJava%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0/" title="无题">无题</a><time datetime="2025-05-14T04:06:50.987Z" title="发表于 2025-05-14 12:06:50">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/14/%E5%BB%96%E9%9B%AA%E5%B3%B0Python/" title="无题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2025/05/14/%E5%BB%96%E9%9B%AA%E5%B3%B0Python/" title="无题">无题</a><time datetime="2025-05-14T04:02:32.996Z" title="发表于 2025-05-14 12:02:32">2025-05-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/16/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/" title="无题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2025/04/16/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/" title="无题">无题</a><time datetime="2025-04-16T02:11:28.562Z" title="发表于 2025-04-16 10:11:28">2025-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E7%AF%87%201/" title="2022黑马数据湖架构开发Hudi"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022黑马数据湖架构开发Hudi"/></a><div class="content"><a class="title" href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E7%AF%87%201/" title="2022黑马数据湖架构开发Hudi">2022黑马数据湖架构开发Hudi</a><time datetime="2025-01-17T09:35:02.000Z" title="发表于 2025-01-17 17:35:02">2025-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20flink%E9%9B%86%E6%88%90%201/" title="2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/%E6%96%87%E7%AB%A0%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1"/></a><div class="content"><a class="title" href="/2025/01/17/2022%E9%BB%91%E9%A9%AC%E6%95%B0%E6%8D%AE%E6%B9%96%E6%9E%B6%E6%9E%84%E5%BC%80%E5%8F%91Hudi-%E5%BA%94%E7%94%A8%E8%BF%9B%E9%98%B6%E7%AF%87%20flink%E9%9B%86%E6%88%90%201/" title="2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1">2022黑马数据湖架构开发Hudi-应用进阶篇 flink集成 1</a><time datetime="2025-01-17T09:35:02.000Z" title="发表于 2025-01-17 17:35:02">2025-01-17</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="智汇君" target="_blank">智汇君</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">80</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">30</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://video-b2g.pages.dev/" title="视频解析"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/视频.png" alt="视频解析"/><span class="back-menu-item-text">视频解析</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://md5-uir.pages.dev/" title="md5值解密"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/MD5.png" alt="md5值解密"/><span class="back-menu-item-text">md5值解密</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://screencheck.pages.dev/#welcome" title="屏幕坏点检查"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/屏幕外观.png" alt="屏幕坏点检查"/><span class="back-menu-item-text">屏幕坏点检查</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://htmleditor-9lo.pages.dev/" title="在线html编辑器"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/html编辑器.png" alt="在线html编辑器"/><span class="back-menu-item-text">在线html编辑器</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">博客</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ttyong-github-io.pages.dev/" title="旧博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/博客.png" alt="旧博客"/><span class="back-menu-item-text">旧博客</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 0.88rem;">GitHub<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>1</sup></a><a href="/tags/NodeJs/" style="font-size: 0.88rem;">NodeJs<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>3</sup></a><a href="/tags/github/" style="font-size: 0.88rem;">github<sup>1</sup></a><a href="/tags/idea/" style="font-size: 0.88rem;">idea<sup>1</sup></a><a href="/tags/%E5%85%AC%E8%80%83%E6%9D%A8%E8%80%81%E5%B8%88/" style="font-size: 0.88rem;">公考杨老师<sup>10</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 0.88rem;">大数据<sup>26</sup></a><a href="/tags/%E5%AE%89%E7%9F%A5%E9%B1%BC%E4%B8%BB%E9%A2%98/" style="font-size: 0.88rem;">安知鱼主题<sup>1</sup></a><a href="/tags/%E5%BB%96%E9%9B%AA%E5%B3%B0/" style="font-size: 0.88rem;">廖雪峰<sup>9</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 0.88rem;">面试<sup>12</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("24/12/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 智汇君 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("24/12/2024 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="https://at.alicdn.com/t/c/font_4792307_02gxbpyxcpwp.js?spm=a313x.manage_type_myprojects.i1.10.56323a81KZGFDE&amp;file=font_4792307_02gxbpyxcpwp.js# 阿里图标symbol 引用链接，主题会进行加载 symbol 引用"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>